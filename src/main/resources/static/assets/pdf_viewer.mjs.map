{"version":3,"file":"pdf_viewer.mjs","mappings":"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","sources":["webpack://pdf.js/node_modules/canvas-size/dist/canvas-size.esm.js","webpack://pdf.js/node_modules/@fluent/bundle/esm/types.js","webpack://pdf.js/node_modules/@fluent/bundle/esm/resolver.js","webpack://pdf.js/node_modules/@fluent/bundle/esm/scope.js","webpack://pdf.js/node_modules/@fluent/bundle/esm/builtins.js","webpack://pdf.js/node_modules/@fluent/bundle/esm/memoizer.js","webpack://pdf.js/node_modules/@fluent/bundle/esm/bundle.js","webpack://pdf.js/node_modules/@fluent/bundle/esm/resource.js","webpack://pdf.js/node_modules/@fluent/bundle/esm/index.js","webpack://pdf.js/node_modules/@fluent/dom/esm/overlay.js","webpack://pdf.js/node_modules/cached-iterable/src/cached_iterable.mjs","webpack://pdf.js/node_modules/cached-iterable/src/cached_sync_iterable.mjs","webpack://pdf.js/node_modules/cached-iterable/src/cached_async_iterable.mjs","webpack://pdf.js/node_modules/cached-iterable/src/index.mjs","webpack://pdf.js/node_modules/@fluent/dom/esm/localization.js","webpack://pdf.js/node_modules/@fluent/dom/esm/dom_localization.js","webpack://pdf.js/node_modules/@fluent/dom/esm/index.js","webpack://pdf.js/src/shared/util.js","webpack://pdf.js/web/annotation_editor_layer_builder.js","webpack://pdf.js/web/annotation_layer_builder.js","webpack://pdf.js/web/app_options.js","webpack://pdf.js/web/download_manager.js","webpack://pdf.js/web/event_utils.js","webpack://pdf.js/web/generic_scripting.js","webpack://pdf.js/web/genericl10n.js","webpack://pdf.js/web/l10n.js","webpack://pdf.js/web/l10n_utils.js","webpack://pdf.js/web/page-flip.module.js","webpack://pdf.js/web/pdf_find_controller.js","webpack://pdf.js/web/pdf_find_utils.js","webpack://pdf.js/web/pdf_history.js","webpack://pdf.js/web/pdf_link_service.js","webpack://pdf.js/web/pdf_page_view.js","webpack://pdf.js/web/pdf_rendering_queue.js","webpack://pdf.js/web/pdf_scripting_manager.component.js","webpack://pdf.js/web/pdf_scripting_manager.js","webpack://pdf.js/web/pdf_single_page_viewer.js","webpack://pdf.js/web/pdf_viewer.component.js","webpack://pdf.js/web/pdf_viewer.js","webpack://pdf.js/web/pdfjs.js","webpack://pdf.js/web/struct_tree_layer_builder.js","webpack://pdf.js/web/text_accessibility.js","webpack://pdf.js/web/text_highlighter.js","webpack://pdf.js/web/text_layer_builder.js","webpack://pdf.js/web/ui_utils.js","webpack://pdf.js/web/xfa_layer_builder.js","webpack://pdf.js/webpack/bootstrap","webpack://pdf.js/webpack/runtime/async module","webpack://pdf.js/webpack/runtime/define property getters","webpack://pdf.js/webpack/runtime/hasOwnProperty shorthand","webpack://pdf.js/webpack/before-startup","webpack://pdf.js/webpack/startup","webpack://pdf.js/webpack/after-startup"],"sourcesContent":["/*!\n * canvas-size\n * v1.2.6\n * https://github.com/jhildenbiddle/canvas-size\n * (c) 2015-2023 John Hildenbiddle <http://hildenbiddle.com>\n * MIT license\n */\nfunction _iterableToArrayLimit(arr, i) {\n    var _i = null == arr ? null : \"undefined\" != typeof Symbol && arr[Symbol.iterator] || arr[\"@@iterator\"];\n    if (null != _i) {\n        var _s, _e, _x, _r, _arr = [], _n = !0, _d = !1;\n        try {\n            if (_x = (_i = _i.call(arr)).next, 0 === i) {\n                if (Object(_i) !== _i) return;\n                _n = !1;\n            } else for (;!(_n = (_s = _x.call(_i)).done) && (_arr.push(_s.value), _arr.length !== i); _n = !0) ;\n        } catch (err) {\n            _d = !0, _e = err;\n        } finally {\n            try {\n                if (!_n && null != _i.return && (_r = _i.return(), Object(_r) !== _r)) return;\n            } finally {\n                if (_d) throw _e;\n            }\n        }\n        return _arr;\n    }\n}\n\nfunction ownKeys(object, enumerableOnly) {\n    var keys = Object.keys(object);\n    if (Object.getOwnPropertySymbols) {\n        var symbols = Object.getOwnPropertySymbols(object);\n        enumerableOnly && (symbols = symbols.filter((function(sym) {\n            return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n        }))), keys.push.apply(keys, symbols);\n    }\n    return keys;\n}\n\nfunction _objectSpread2(target) {\n    for (var i = 1; i < arguments.length; i++) {\n        var source = null != arguments[i] ? arguments[i] : {};\n        i % 2 ? ownKeys(Object(source), !0).forEach((function(key) {\n            _defineProperty(target, key, source[key]);\n        })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach((function(key) {\n            Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n        }));\n    }\n    return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n    key = _toPropertyKey(key);\n    if (key in obj) {\n        Object.defineProperty(obj, key, {\n            value: value,\n            enumerable: true,\n            configurable: true,\n            writable: true\n        });\n    } else {\n        obj[key] = value;\n    }\n    return obj;\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n    if (source == null) return {};\n    var target = {};\n    var sourceKeys = Object.keys(source);\n    var key, i;\n    for (i = 0; i < sourceKeys.length; i++) {\n        key = sourceKeys[i];\n        if (excluded.indexOf(key) >= 0) continue;\n        target[key] = source[key];\n    }\n    return target;\n}\n\nfunction _objectWithoutProperties(source, excluded) {\n    if (source == null) return {};\n    var target = _objectWithoutPropertiesLoose(source, excluded);\n    var key, i;\n    if (Object.getOwnPropertySymbols) {\n        var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n        for (i = 0; i < sourceSymbolKeys.length; i++) {\n            key = sourceSymbolKeys[i];\n            if (excluded.indexOf(key) >= 0) continue;\n            if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n            target[key] = source[key];\n        }\n    }\n    return target;\n}\n\nfunction _slicedToArray(arr, i) {\n    return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\n\nfunction _toConsumableArray(arr) {\n    return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _arrayWithoutHoles(arr) {\n    if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _arrayWithHoles(arr) {\n    if (Array.isArray(arr)) return arr;\n}\n\nfunction _iterableToArray(iter) {\n    if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n    if (!o) return;\n    if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n    var n = Object.prototype.toString.call(o).slice(8, -1);\n    if (n === \"Object\" && o.constructor) n = o.constructor.name;\n    if (n === \"Map\" || n === \"Set\") return Array.from(o);\n    if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n    if (len == null || len > arr.length) len = arr.length;\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n    return arr2;\n}\n\nfunction _nonIterableSpread() {\n    throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _nonIterableRest() {\n    throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _toPrimitive(input, hint) {\n    if (typeof input !== \"object\" || input === null) return input;\n    var prim = input[Symbol.toPrimitive];\n    if (prim !== undefined) {\n        var res = prim.call(input, hint || \"default\");\n        if (typeof res !== \"object\") return res;\n        throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n    }\n    return (hint === \"string\" ? String : Number)(input);\n}\n\nfunction _toPropertyKey(arg) {\n    var key = _toPrimitive(arg, \"string\");\n    return typeof key === \"symbol\" ? key : String(key);\n}\n\nfunction canvasTest(settings) {\n    var size = settings.sizes.shift();\n    var width = Math.max(Math.ceil(size[0]), 1);\n    var height = Math.max(Math.ceil(size[1]), 1);\n    var fill = [ width - 1, height - 1, 1, 1 ];\n    var job = Date.now();\n    var isWorker = typeof WorkerGlobalScope !== \"undefined\" && self instanceof WorkerGlobalScope;\n    var cropCvs, testCvs;\n    if (isWorker) {\n        cropCvs = new OffscreenCanvas(1, 1);\n        testCvs = new OffscreenCanvas(width, height);\n    } else {\n        cropCvs = document.createElement(\"canvas\");\n        cropCvs.width = 1;\n        cropCvs.height = 1;\n        testCvs = document.createElement(\"canvas\");\n        testCvs.width = width;\n        testCvs.height = height;\n    }\n    var cropCtx = cropCvs.getContext(\"2d\");\n    var testCtx = testCvs.getContext(\"2d\");\n    if (testCtx) {\n        testCtx.fillRect.apply(testCtx, fill);\n        cropCtx.drawImage(testCvs, width - 1, height - 1, 1, 1, 0, 0, 1, 1);\n    }\n    var isTestPass = cropCtx && cropCtx.getImageData(0, 0, 1, 1).data[3] !== 0;\n    var benchmark = Date.now() - job;\n    [ cropCvs, testCvs ].forEach((function(cvs) {\n        cvs.height = 0;\n        cvs.width = 0;\n    }));\n    if (isWorker) {\n        postMessage({\n            width: width,\n            height: height,\n            benchmark: benchmark,\n            isTestPass: isTestPass\n        });\n        if (!isTestPass && settings.sizes.length) {\n            canvasTest(settings);\n        }\n    } else if (isTestPass) {\n        settings.onSuccess(width, height, benchmark);\n    } else {\n        settings.onError(width, height, benchmark);\n        if (settings.sizes.length) {\n            canvasTest(settings);\n        }\n    }\n    return isTestPass;\n}\n\nvar testSizes = {\n    area: [ 16384, 14188, 11402, 11180, 10836, 8192, 4096, 1 ],\n    height: [ 8388607, 65535, 32767, 16384, 8192, 4096, 1 ],\n    width: [ 4194303, 65535, 32767, 16384, 8192, 4096, 1 ]\n};\n\nvar _excluded = [ \"onError\", \"onSuccess\" ];\n\nvar defaults = {\n    max: null,\n    min: 1,\n    sizes: [],\n    step: 1024,\n    usePromise: false,\n    useWorker: false,\n    onError: Function.prototype,\n    onSuccess: Function.prototype\n};\n\nvar workerJobs = {};\n\nfunction createSizesArray(settings) {\n    var isArea = settings.width === settings.height;\n    var isWidth = settings.height === 1;\n    var isHeight = settings.width === 1;\n    var sizes = [];\n    if (!settings.width || !settings.height) {\n        settings.sizes.forEach((function(testSize) {\n            var width = isArea || isWidth ? testSize : 1;\n            var height = isArea || isHeight ? testSize : 1;\n            sizes.push([ width, height ]);\n        }));\n    } else {\n        var testMin = settings.min || defaults.min;\n        var testStep = settings.step || defaults.step;\n        var testSize = Math.max(settings.width, settings.height);\n        while (testSize >= testMin) {\n            var width = isArea || isWidth ? testSize : 1;\n            var height = isArea || isHeight ? testSize : 1;\n            sizes.push([ width, height ]);\n            testSize -= testStep;\n        }\n    }\n    return sizes;\n}\n\nfunction handleMethod(settings) {\n    var hasCanvasSupport = window && \"HTMLCanvasElement\" in window;\n    var hasOffscreenCanvasSupport = window && \"OffscreenCanvas\" in window;\n    var jobID = Date.now();\n    var _onError = settings.onError, _onSuccess = settings.onSuccess, settingsWithoutCallbacks = _objectWithoutProperties(settings, _excluded);\n    var worker = null;\n    if (!hasCanvasSupport) {\n        return false;\n    }\n    if (settings.useWorker && hasOffscreenCanvasSupport) {\n        var js = \"\\n            var canvasTest = \".concat(canvasTest.toString(), \";\\n            onmessage = function(e) {\\n                canvasTest(e.data);\\n            };\\n        \");\n        var blob = new Blob([ js ], {\n            type: \"application/javascript\"\n        });\n        var blobURL = URL.createObjectURL(blob);\n        worker = new Worker(blobURL);\n        URL.revokeObjectURL(blobURL);\n        worker.onmessage = function(e) {\n            var _e$data = e.data, width = _e$data.width, height = _e$data.height, benchmark = _e$data.benchmark, isTestPass = _e$data.isTestPass;\n            if (isTestPass) {\n                workerJobs[jobID].onSuccess(width, height, benchmark);\n                delete workerJobs[jobID];\n            } else {\n                workerJobs[jobID].onError(width, height, benchmark);\n            }\n        };\n    }\n    if (settings.usePromise) {\n        return new Promise((function(resolve, reject) {\n            var promiseSettings = _objectSpread2(_objectSpread2({}, settings), {}, {\n                onError: function onError(width, height, benchmark) {\n                    var isLastTest;\n                    if (settings.sizes.length === 0) {\n                        isLastTest = true;\n                    } else {\n                        var _settings$sizes$slice = settings.sizes.slice(-1), _settings$sizes$slice2 = _slicedToArray(_settings$sizes$slice, 1), _settings$sizes$slice3 = _slicedToArray(_settings$sizes$slice2[0], 2), lastWidth = _settings$sizes$slice3[0], lastHeight = _settings$sizes$slice3[1];\n                        isLastTest = width === lastWidth && height === lastHeight;\n                    }\n                    _onError(width, height, benchmark);\n                    if (isLastTest) {\n                        reject({\n                            width: width,\n                            height: height,\n                            benchmark: benchmark\n                        });\n                    }\n                },\n                onSuccess: function onSuccess(width, height, benchmark) {\n                    _onSuccess(width, height, benchmark);\n                    resolve({\n                        width: width,\n                        height: height,\n                        benchmark: benchmark\n                    });\n                }\n            });\n            if (worker) {\n                var onError = promiseSettings.onError, onSuccess = promiseSettings.onSuccess;\n                workerJobs[jobID] = {\n                    onError: onError,\n                    onSuccess: onSuccess\n                };\n                worker.postMessage(settingsWithoutCallbacks);\n            } else {\n                canvasTest(promiseSettings);\n            }\n        }));\n    } else {\n        if (worker) {\n            workerJobs[jobID] = {\n                onError: _onError,\n                onSuccess: _onSuccess\n            };\n            worker.postMessage(settingsWithoutCallbacks);\n        } else {\n            return canvasTest(settings);\n        }\n    }\n}\n\nvar canvasSize = {\n    maxArea: function maxArea() {\n        var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n        var sizes = createSizesArray({\n            width: options.max,\n            height: options.max,\n            min: options.min,\n            step: options.step,\n            sizes: _toConsumableArray(testSizes.area)\n        });\n        var settings = _objectSpread2(_objectSpread2(_objectSpread2({}, defaults), options), {}, {\n            sizes: sizes\n        });\n        return handleMethod(settings);\n    },\n    maxHeight: function maxHeight() {\n        var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n        var sizes = createSizesArray({\n            width: 1,\n            height: options.max,\n            min: options.min,\n            step: options.step,\n            sizes: _toConsumableArray(testSizes.height)\n        });\n        var settings = _objectSpread2(_objectSpread2(_objectSpread2({}, defaults), options), {}, {\n            sizes: sizes\n        });\n        return handleMethod(settings);\n    },\n    maxWidth: function maxWidth() {\n        var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n        var sizes = createSizesArray({\n            width: options.max,\n            height: 1,\n            min: options.min,\n            step: options.step,\n            sizes: _toConsumableArray(testSizes.width)\n        });\n        var settings = _objectSpread2(_objectSpread2(_objectSpread2({}, defaults), options), {}, {\n            sizes: sizes\n        });\n        return handleMethod(settings);\n    },\n    test: function test() {\n        var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n        var settings = _objectSpread2(_objectSpread2({}, defaults), options);\n        settings.sizes = _toConsumableArray(settings.sizes);\n        if (settings.width && settings.height) {\n            settings.sizes = [ [ settings.width, settings.height ] ];\n        }\n        return handleMethod(settings);\n    }\n};\n\nexport { canvasSize as default };\n//# sourceMappingURL=canvas-size.esm.js.map\n","/**\n * The `FluentType` class is the base of Fluent's type system.\n *\n * Fluent types wrap JavaScript values and store additional configuration for\n * them, which can then be used in the `toString` method together with a proper\n * `Intl` formatter.\n */\nexport class FluentType {\n    /**\n     * Create a `FluentType` instance.\n     *\n     * @param value The JavaScript value to wrap.\n     */\n    constructor(value) {\n        this.value = value;\n    }\n    /**\n     * Unwrap the raw value stored by this `FluentType`.\n     */\n    valueOf() {\n        return this.value;\n    }\n}\n/**\n * A `FluentType` representing no correct value.\n */\nexport class FluentNone extends FluentType {\n    /**\n     * Create an instance of `FluentNone` with an optional fallback value.\n     * @param value The fallback value of this `FluentNone`.\n     */\n    constructor(value = \"???\") {\n        super(value);\n    }\n    /**\n     * Format this `FluentNone` to the fallback string.\n     */\n    toString(scope) {\n        return `{${this.value}}`;\n    }\n}\n/**\n * A `FluentType` representing a number.\n *\n * A `FluentNumber` instance stores the number value of the number it\n * represents. It may also store an option bag of options which will be passed\n * to `Intl.NumerFormat` when the `FluentNumber` is formatted to a string.\n */\nexport class FluentNumber extends FluentType {\n    /**\n     * Create an instance of `FluentNumber` with options to the\n     * `Intl.NumberFormat` constructor.\n     *\n     * @param value The number value of this `FluentNumber`.\n     * @param opts Options which will be passed to `Intl.NumberFormat`.\n     */\n    constructor(value, opts = {}) {\n        super(value);\n        this.opts = opts;\n    }\n    /**\n     * Format this `FluentNumber` to a string.\n     */\n    toString(scope) {\n        try {\n            const nf = scope.memoizeIntlObject(Intl.NumberFormat, this.opts);\n            return nf.format(this.value);\n        }\n        catch (err) {\n            scope.reportError(err);\n            return this.value.toString(10);\n        }\n    }\n}\n/**\n * A `FluentType` representing a date and time.\n *\n * A `FluentDateTime` instance stores the number value of the date it\n * represents, as a numerical timestamp in milliseconds. It may also store an\n * option bag of options which will be passed to `Intl.DateTimeFormat` when the\n * `FluentDateTime` is formatted to a string.\n */\nexport class FluentDateTime extends FluentType {\n    /**\n     * Create an instance of `FluentDateTime` with options to the\n     * `Intl.DateTimeFormat` constructor.\n     *\n     * @param value The number value of this `FluentDateTime`, in milliseconds.\n     * @param opts Options which will be passed to `Intl.DateTimeFormat`.\n     */\n    constructor(value, opts = {}) {\n        super(value);\n        this.opts = opts;\n    }\n    /**\n     * Format this `FluentDateTime` to a string.\n     */\n    toString(scope) {\n        try {\n            const dtf = scope.memoizeIntlObject(Intl.DateTimeFormat, this.opts);\n            return dtf.format(this.value);\n        }\n        catch (err) {\n            scope.reportError(err);\n            return new Date(this.value).toISOString();\n        }\n    }\n}\n","/* global Intl */\n/**\n * @overview\n *\n * The role of the Fluent resolver is to format a `Pattern` to an instance of\n * `FluentValue`. For performance reasons, primitive strings are considered\n * such instances, too.\n *\n * Translations can contain references to other messages or variables,\n * conditional logic in form of select expressions, traits which describe their\n * grammatical features, and can use Fluent builtins which make use of the\n * `Intl` formatters to format numbers and dates into the bundle's languages.\n * See the documentation of the Fluent syntax for more information.\n *\n * In case of errors the resolver will try to salvage as much of the\n * translation as possible. In rare situations where the resolver didn't know\n * how to recover from an error it will return an instance of `FluentNone`.\n *\n * All expressions resolve to an instance of `FluentValue`. The caller should\n * use the `toString` method to convert the instance to a native value.\n *\n * Functions in this file pass around an instance of the `Scope` class, which\n * stores the data required for successful resolution and error recovery.\n */\nimport { FluentType, FluentNone, FluentNumber, FluentDateTime, } from \"./types.js\";\n/**\n * The maximum number of placeables which can be expanded in a single call to\n * `formatPattern`. The limit protects against the Billion Laughs and Quadratic\n * Blowup attacks. See https://msdn.microsoft.com/en-us/magazine/ee335713.aspx.\n */\nconst MAX_PLACEABLES = 100;\n/** Unicode bidi isolation characters. */\nconst FSI = \"\\u2068\";\nconst PDI = \"\\u2069\";\n/** Helper: match a variant key to the given selector. */\nfunction match(scope, selector, key) {\n    if (key === selector) {\n        // Both are strings.\n        return true;\n    }\n    // XXX Consider comparing options too, e.g. minimumFractionDigits.\n    if (key instanceof FluentNumber &&\n        selector instanceof FluentNumber &&\n        key.value === selector.value) {\n        return true;\n    }\n    if (selector instanceof FluentNumber && typeof key === \"string\") {\n        let category = scope\n            .memoizeIntlObject(Intl.PluralRules, selector.opts)\n            .select(selector.value);\n        if (key === category) {\n            return true;\n        }\n    }\n    return false;\n}\n/** Helper: resolve the default variant from a list of variants. */\nfunction getDefault(scope, variants, star) {\n    if (variants[star]) {\n        return resolvePattern(scope, variants[star].value);\n    }\n    scope.reportError(new RangeError(\"No default\"));\n    return new FluentNone();\n}\n/** Helper: resolve arguments to a call expression. */\nfunction getArguments(scope, args) {\n    const positional = [];\n    const named = Object.create(null);\n    for (const arg of args) {\n        if (arg.type === \"narg\") {\n            named[arg.name] = resolveExpression(scope, arg.value);\n        }\n        else {\n            positional.push(resolveExpression(scope, arg));\n        }\n    }\n    return { positional, named };\n}\n/** Resolve an expression to a Fluent type. */\nfunction resolveExpression(scope, expr) {\n    switch (expr.type) {\n        case \"str\":\n            return expr.value;\n        case \"num\":\n            return new FluentNumber(expr.value, {\n                minimumFractionDigits: expr.precision,\n            });\n        case \"var\":\n            return resolveVariableReference(scope, expr);\n        case \"mesg\":\n            return resolveMessageReference(scope, expr);\n        case \"term\":\n            return resolveTermReference(scope, expr);\n        case \"func\":\n            return resolveFunctionReference(scope, expr);\n        case \"select\":\n            return resolveSelectExpression(scope, expr);\n        default:\n            return new FluentNone();\n    }\n}\n/** Resolve a reference to a variable. */\nfunction resolveVariableReference(scope, { name }) {\n    let arg;\n    if (scope.params) {\n        // We're inside a TermReference. It's OK to reference undefined parameters.\n        if (Object.prototype.hasOwnProperty.call(scope.params, name)) {\n            arg = scope.params[name];\n        }\n        else {\n            return new FluentNone(`$${name}`);\n        }\n    }\n    else if (scope.args &&\n        Object.prototype.hasOwnProperty.call(scope.args, name)) {\n        // We're in the top-level Pattern or inside a MessageReference. Missing\n        // variables references produce ReferenceErrors.\n        arg = scope.args[name];\n    }\n    else {\n        scope.reportError(new ReferenceError(`Unknown variable: $${name}`));\n        return new FluentNone(`$${name}`);\n    }\n    // Return early if the argument already is an instance of FluentType.\n    if (arg instanceof FluentType) {\n        return arg;\n    }\n    // Convert the argument to a Fluent type.\n    switch (typeof arg) {\n        case \"string\":\n            return arg;\n        case \"number\":\n            return new FluentNumber(arg);\n        case \"object\":\n            if (arg instanceof Date) {\n                return new FluentDateTime(arg.getTime());\n            }\n        // eslint-disable-next-line no-fallthrough\n        default:\n            scope.reportError(new TypeError(`Variable type not supported: $${name}, ${typeof arg}`));\n            return new FluentNone(`$${name}`);\n    }\n}\n/** Resolve a reference to another message. */\nfunction resolveMessageReference(scope, { name, attr }) {\n    const message = scope.bundle._messages.get(name);\n    if (!message) {\n        scope.reportError(new ReferenceError(`Unknown message: ${name}`));\n        return new FluentNone(name);\n    }\n    if (attr) {\n        const attribute = message.attributes[attr];\n        if (attribute) {\n            return resolvePattern(scope, attribute);\n        }\n        scope.reportError(new ReferenceError(`Unknown attribute: ${attr}`));\n        return new FluentNone(`${name}.${attr}`);\n    }\n    if (message.value) {\n        return resolvePattern(scope, message.value);\n    }\n    scope.reportError(new ReferenceError(`No value: ${name}`));\n    return new FluentNone(name);\n}\n/** Resolve a call to a Term with key-value arguments. */\nfunction resolveTermReference(scope, { name, attr, args }) {\n    const id = `-${name}`;\n    const term = scope.bundle._terms.get(id);\n    if (!term) {\n        scope.reportError(new ReferenceError(`Unknown term: ${id}`));\n        return new FluentNone(id);\n    }\n    if (attr) {\n        const attribute = term.attributes[attr];\n        if (attribute) {\n            // Every TermReference has its own variables.\n            scope.params = getArguments(scope, args).named;\n            const resolved = resolvePattern(scope, attribute);\n            scope.params = null;\n            return resolved;\n        }\n        scope.reportError(new ReferenceError(`Unknown attribute: ${attr}`));\n        return new FluentNone(`${id}.${attr}`);\n    }\n    scope.params = getArguments(scope, args).named;\n    const resolved = resolvePattern(scope, term.value);\n    scope.params = null;\n    return resolved;\n}\n/** Resolve a call to a Function with positional and key-value arguments. */\nfunction resolveFunctionReference(scope, { name, args }) {\n    // Some functions are built-in. Others may be provided by the runtime via\n    // the `FluentBundle` constructor.\n    let func = scope.bundle._functions[name];\n    if (!func) {\n        scope.reportError(new ReferenceError(`Unknown function: ${name}()`));\n        return new FluentNone(`${name}()`);\n    }\n    if (typeof func !== \"function\") {\n        scope.reportError(new TypeError(`Function ${name}() is not callable`));\n        return new FluentNone(`${name}()`);\n    }\n    try {\n        let resolved = getArguments(scope, args);\n        return func(resolved.positional, resolved.named);\n    }\n    catch (err) {\n        scope.reportError(err);\n        return new FluentNone(`${name}()`);\n    }\n}\n/** Resolve a select expression to the member object. */\nfunction resolveSelectExpression(scope, { selector, variants, star }) {\n    let sel = resolveExpression(scope, selector);\n    if (sel instanceof FluentNone) {\n        return getDefault(scope, variants, star);\n    }\n    // Match the selector against keys of each variant, in order.\n    for (const variant of variants) {\n        const key = resolveExpression(scope, variant.key);\n        if (match(scope, sel, key)) {\n            return resolvePattern(scope, variant.value);\n        }\n    }\n    return getDefault(scope, variants, star);\n}\n/** Resolve a pattern (a complex string with placeables). */\nexport function resolveComplexPattern(scope, ptn) {\n    if (scope.dirty.has(ptn)) {\n        scope.reportError(new RangeError(\"Cyclic reference\"));\n        return new FluentNone();\n    }\n    // Tag the pattern as dirty for the purpose of the current resolution.\n    scope.dirty.add(ptn);\n    const result = [];\n    // Wrap interpolations with Directional Isolate Formatting characters\n    // only when the pattern has more than one element.\n    const useIsolating = scope.bundle._useIsolating && ptn.length > 1;\n    for (const elem of ptn) {\n        if (typeof elem === \"string\") {\n            result.push(scope.bundle._transform(elem));\n            continue;\n        }\n        scope.placeables++;\n        if (scope.placeables > MAX_PLACEABLES) {\n            scope.dirty.delete(ptn);\n            // This is a fatal error which causes the resolver to instantly bail out\n            // on this pattern. The length check protects against excessive memory\n            // usage, and throwing protects against eating up the CPU when long\n            // placeables are deeply nested.\n            throw new RangeError(`Too many placeables expanded: ${scope.placeables}, ` +\n                `max allowed is ${MAX_PLACEABLES}`);\n        }\n        if (useIsolating) {\n            result.push(FSI);\n        }\n        result.push(resolveExpression(scope, elem).toString(scope));\n        if (useIsolating) {\n            result.push(PDI);\n        }\n    }\n    scope.dirty.delete(ptn);\n    return result.join(\"\");\n}\n/**\n * Resolve a simple or a complex Pattern to a FluentString\n * (which is really the string primitive).\n */\nfunction resolvePattern(scope, value) {\n    // Resolve a simple pattern.\n    if (typeof value === \"string\") {\n        return scope.bundle._transform(value);\n    }\n    return resolveComplexPattern(scope, value);\n}\n","export class Scope {\n    constructor(bundle, errors, args) {\n        /**\n         * The Set of patterns already encountered during this resolution.\n         * Used to detect and prevent cyclic resolutions.\n         * @ignore\n         */\n        this.dirty = new WeakSet();\n        /** A dict of parameters passed to a TermReference. */\n        this.params = null;\n        /**\n         * The running count of placeables resolved so far.\n         * Used to detect the Billion Laughs and Quadratic Blowup attacks.\n         * @ignore\n         */\n        this.placeables = 0;\n        this.bundle = bundle;\n        this.errors = errors;\n        this.args = args;\n    }\n    reportError(error) {\n        if (!this.errors || !(error instanceof Error)) {\n            throw error;\n        }\n        this.errors.push(error);\n    }\n    memoizeIntlObject(ctor, opts) {\n        let cache = this.bundle._intls.get(ctor);\n        if (!cache) {\n            cache = {};\n            this.bundle._intls.set(ctor, cache);\n        }\n        let id = JSON.stringify(opts);\n        if (!cache[id]) {\n            cache[id] = new ctor(this.bundle.locales, opts);\n        }\n        return cache[id];\n    }\n}\n","/**\n * @overview\n *\n * The FTL resolver ships with a number of functions built-in.\n *\n * Each function take two arguments:\n *   - args - an array of positional args\n *   - opts - an object of key-value args\n *\n * Arguments to functions are guaranteed to already be instances of\n * `FluentValue`.  Functions must return `FluentValues` as well.\n */\nimport { FluentNone, FluentNumber, FluentDateTime, } from \"./types.js\";\nfunction values(opts, allowed) {\n    const unwrapped = Object.create(null);\n    for (const [name, opt] of Object.entries(opts)) {\n        if (allowed.includes(name)) {\n            unwrapped[name] = opt.valueOf();\n        }\n    }\n    return unwrapped;\n}\nconst NUMBER_ALLOWED = [\n    \"unitDisplay\",\n    \"currencyDisplay\",\n    \"useGrouping\",\n    \"minimumIntegerDigits\",\n    \"minimumFractionDigits\",\n    \"maximumFractionDigits\",\n    \"minimumSignificantDigits\",\n    \"maximumSignificantDigits\",\n];\n/**\n * The implementation of the `NUMBER()` builtin available to translations.\n *\n * Translations may call the `NUMBER()` builtin in order to specify formatting\n * options of a number. For example:\n *\n *     pi = The value of  is {NUMBER($pi, maximumFractionDigits: 2)}.\n *\n * The implementation expects an array of `FluentValues` representing the\n * positional arguments, and an object of named `FluentValues` representing the\n * named parameters.\n *\n * The following options are recognized:\n *\n *     unitDisplay\n *     currencyDisplay\n *     useGrouping\n *     minimumIntegerDigits\n *     minimumFractionDigits\n *     maximumFractionDigits\n *     minimumSignificantDigits\n *     maximumSignificantDigits\n *\n * Other options are ignored.\n *\n * @param args The positional arguments passed to this `NUMBER()`.\n * @param opts The named argments passed to this `NUMBER()`.\n */\nexport function NUMBER(args, opts) {\n    let arg = args[0];\n    if (arg instanceof FluentNone) {\n        return new FluentNone(`NUMBER(${arg.valueOf()})`);\n    }\n    if (arg instanceof FluentNumber) {\n        return new FluentNumber(arg.valueOf(), {\n            ...arg.opts,\n            ...values(opts, NUMBER_ALLOWED),\n        });\n    }\n    if (arg instanceof FluentDateTime) {\n        return new FluentNumber(arg.valueOf(), {\n            ...values(opts, NUMBER_ALLOWED),\n        });\n    }\n    throw new TypeError(\"Invalid argument to NUMBER\");\n}\nconst DATETIME_ALLOWED = [\n    \"dateStyle\",\n    \"timeStyle\",\n    \"fractionalSecondDigits\",\n    \"dayPeriod\",\n    \"hour12\",\n    \"weekday\",\n    \"era\",\n    \"year\",\n    \"month\",\n    \"day\",\n    \"hour\",\n    \"minute\",\n    \"second\",\n    \"timeZoneName\",\n];\n/**\n * The implementation of the `DATETIME()` builtin available to translations.\n *\n * Translations may call the `DATETIME()` builtin in order to specify\n * formatting options of a number. For example:\n *\n *     now = It's {DATETIME($today, month: \"long\")}.\n *\n * The implementation expects an array of `FluentValues` representing the\n * positional arguments, and an object of named `FluentValues` representing the\n * named parameters.\n *\n * The following options are recognized:\n *\n *     dateStyle\n *     timeStyle\n *     fractionalSecondDigits\n *     dayPeriod\n *     hour12\n *     weekday\n *     era\n *     year\n *     month\n *     day\n *     hour\n *     minute\n *     second\n *     timeZoneName\n *\n * Other options are ignored.\n *\n * @param args The positional arguments passed to this `DATETIME()`.\n * @param opts The named argments passed to this `DATETIME()`.\n */\nexport function DATETIME(args, opts) {\n    let arg = args[0];\n    if (arg instanceof FluentNone) {\n        return new FluentNone(`DATETIME(${arg.valueOf()})`);\n    }\n    if (arg instanceof FluentDateTime) {\n        return new FluentDateTime(arg.valueOf(), {\n            ...arg.opts,\n            ...values(opts, DATETIME_ALLOWED),\n        });\n    }\n    if (arg instanceof FluentNumber) {\n        return new FluentDateTime(arg.valueOf(), {\n            ...values(opts, DATETIME_ALLOWED),\n        });\n    }\n    throw new TypeError(\"Invalid argument to DATETIME\");\n}\n","const cache = new Map();\nexport function getMemoizerForLocale(locales) {\n    const stringLocale = Array.isArray(locales) ? locales.join(\" \") : locales;\n    let memoizer = cache.get(stringLocale);\n    if (memoizer === undefined) {\n        memoizer = new Map();\n        cache.set(stringLocale, memoizer);\n    }\n    return memoizer;\n}\n","import { resolveComplexPattern } from \"./resolver.js\";\nimport { Scope } from \"./scope.js\";\nimport { FluentNone } from \"./types.js\";\nimport { NUMBER, DATETIME } from \"./builtins.js\";\nimport { getMemoizerForLocale } from \"./memoizer.js\";\n/**\n * Message bundles are single-language stores of translation resources. They are\n * responsible for formatting message values and attributes to strings.\n */\nexport class FluentBundle {\n    /**\n     * Create an instance of `FluentBundle`.\n     *\n     * @example\n     * ```js\n     * let bundle = new FluentBundle([\"en-US\", \"en\"]);\n     *\n     * let bundle = new FluentBundle(locales, {useIsolating: false});\n     *\n     * let bundle = new FluentBundle(locales, {\n     *   useIsolating: true,\n     *   functions: {\n     *     NODE_ENV: () => process.env.NODE_ENV\n     *   }\n     * });\n     * ```\n     *\n     * @param locales - Used to instantiate `Intl` formatters used by translations.\n     * @param options - Optional configuration for the bundle.\n     */\n    constructor(locales, { functions, useIsolating = true, transform = (v) => v, } = {}) {\n        /** @ignore */\n        this._terms = new Map();\n        /** @ignore */\n        this._messages = new Map();\n        this.locales = Array.isArray(locales) ? locales : [locales];\n        this._functions = {\n            NUMBER,\n            DATETIME,\n            ...functions,\n        };\n        this._useIsolating = useIsolating;\n        this._transform = transform;\n        this._intls = getMemoizerForLocale(locales);\n    }\n    /**\n     * Check if a message is present in the bundle.\n     *\n     * @param id - The identifier of the message to check.\n     */\n    hasMessage(id) {\n        return this._messages.has(id);\n    }\n    /**\n     * Return a raw unformatted message object from the bundle.\n     *\n     * Raw messages are `{value, attributes}` shapes containing translation units\n     * called `Patterns`. `Patterns` are implementation-specific; they should be\n     * treated as black boxes and formatted with `FluentBundle.formatPattern`.\n     *\n     * @param id - The identifier of the message to check.\n     */\n    getMessage(id) {\n        return this._messages.get(id);\n    }\n    /**\n     * Add a translation resource to the bundle.\n     *\n     * @example\n     * ```js\n     * let res = new FluentResource(\"foo = Foo\");\n     * bundle.addResource(res);\n     * bundle.getMessage(\"foo\");\n     * //  {value: .., attributes: {..}}\n     * ```\n     *\n     * @param res\n     * @param options\n     */\n    addResource(res, { allowOverrides = false, } = {}) {\n        const errors = [];\n        for (let i = 0; i < res.body.length; i++) {\n            let entry = res.body[i];\n            if (entry.id.startsWith(\"-\")) {\n                // Identifiers starting with a dash (-) define terms. Terms are private\n                // and cannot be retrieved from FluentBundle.\n                if (allowOverrides === false && this._terms.has(entry.id)) {\n                    errors.push(new Error(`Attempt to override an existing term: \"${entry.id}\"`));\n                    continue;\n                }\n                this._terms.set(entry.id, entry);\n            }\n            else {\n                if (allowOverrides === false && this._messages.has(entry.id)) {\n                    errors.push(new Error(`Attempt to override an existing message: \"${entry.id}\"`));\n                    continue;\n                }\n                this._messages.set(entry.id, entry);\n            }\n        }\n        return errors;\n    }\n    /**\n     * Format a `Pattern` to a string.\n     *\n     * Format a raw `Pattern` into a string. `args` will be used to resolve\n     * references to variables passed as arguments to the translation.\n     *\n     * In case of errors `formatPattern` will try to salvage as much of the\n     * translation as possible and will still return a string. For performance\n     * reasons, the encountered errors are not returned but instead are appended\n     * to the `errors` array passed as the third argument.\n     *\n     * If `errors` is omitted, the first encountered error will be thrown.\n     *\n     * @example\n     * ```js\n     * let errors = [];\n     * bundle.addResource(\n     *     new FluentResource(\"hello = Hello, {$name}!\"));\n     *\n     * let hello = bundle.getMessage(\"hello\");\n     * if (hello.value) {\n     *     bundle.formatPattern(hello.value, {name: \"Jane\"}, errors);\n     *     // Returns \"Hello, Jane!\" and `errors` is empty.\n     *\n     *     bundle.formatPattern(hello.value, undefined, errors);\n     *     // Returns \"Hello, {$name}!\" and `errors` is now:\n     *     // [<ReferenceError: Unknown variable: name>]\n     * }\n     * ```\n     */\n    formatPattern(pattern, args = null, errors = null) {\n        // Resolve a simple pattern without creating a scope. No error handling is\n        // required; by definition simple patterns don't have placeables.\n        if (typeof pattern === \"string\") {\n            return this._transform(pattern);\n        }\n        // Resolve a complex pattern.\n        let scope = new Scope(this, errors, args);\n        try {\n            let value = resolveComplexPattern(scope, pattern);\n            return value.toString(scope);\n        }\n        catch (err) {\n            if (scope.errors && err instanceof Error) {\n                scope.errors.push(err);\n                return new FluentNone().toString(scope);\n            }\n            throw err;\n        }\n    }\n}\n","// This regex is used to iterate through the beginnings of messages and terms.\n// With the /m flag, the ^ matches at the beginning of every line.\nconst RE_MESSAGE_START = /^(-?[a-zA-Z][\\w-]*) *= */gm;\n// Both Attributes and Variants are parsed in while loops. These regexes are\n// used to break out of them.\nconst RE_ATTRIBUTE_START = /\\.([a-zA-Z][\\w-]*) *= */y;\nconst RE_VARIANT_START = /\\*?\\[/y;\nconst RE_NUMBER_LITERAL = /(-?[0-9]+(?:\\.([0-9]+))?)/y;\nconst RE_IDENTIFIER = /([a-zA-Z][\\w-]*)/y;\nconst RE_REFERENCE = /([$-])?([a-zA-Z][\\w-]*)(?:\\.([a-zA-Z][\\w-]*))?/y;\nconst RE_FUNCTION_NAME = /^[A-Z][A-Z0-9_-]*$/;\n// A \"run\" is a sequence of text or string literal characters which don't\n// require any special handling. For TextElements such special characters are: {\n// (starts a placeable), and line breaks which require additional logic to check\n// if the next line is indented. For StringLiterals they are: \\ (starts an\n// escape sequence), \" (ends the literal), and line breaks which are not allowed\n// in StringLiterals. Note that string runs may be empty; text runs may not.\nconst RE_TEXT_RUN = /([^{}\\n\\r]+)/y;\nconst RE_STRING_RUN = /([^\\\\\"\\n\\r]*)/y;\n// Escape sequences.\nconst RE_STRING_ESCAPE = /\\\\([\\\\\"])/y;\nconst RE_UNICODE_ESCAPE = /\\\\u([a-fA-F0-9]{4})|\\\\U([a-fA-F0-9]{6})/y;\n// Used for trimming TextElements and indents.\nconst RE_LEADING_NEWLINES = /^\\n+/;\nconst RE_TRAILING_SPACES = / +$/;\n// Used in makeIndent to strip spaces from blank lines and normalize CRLF to LF.\nconst RE_BLANK_LINES = / *\\r?\\n/g;\n// Used in makeIndent to measure the indentation.\nconst RE_INDENT = /( *)$/;\n// Common tokens.\nconst TOKEN_BRACE_OPEN = /{\\s*/y;\nconst TOKEN_BRACE_CLOSE = /\\s*}/y;\nconst TOKEN_BRACKET_OPEN = /\\[\\s*/y;\nconst TOKEN_BRACKET_CLOSE = /\\s*] */y;\nconst TOKEN_PAREN_OPEN = /\\s*\\(\\s*/y;\nconst TOKEN_ARROW = /\\s*->\\s*/y;\nconst TOKEN_COLON = /\\s*:\\s*/y;\n// Note the optional comma. As a deviation from the Fluent EBNF, the parser\n// doesn't enforce commas between call arguments.\nconst TOKEN_COMMA = /\\s*,?\\s*/y;\nconst TOKEN_BLANK = /\\s+/y;\n/**\n * Fluent Resource is a structure storing parsed localization entries.\n */\nexport class FluentResource {\n    constructor(source) {\n        this.body = [];\n        RE_MESSAGE_START.lastIndex = 0;\n        let cursor = 0;\n        // Iterate over the beginnings of messages and terms to efficiently skip\n        // comments and recover from errors.\n        while (true) {\n            let next = RE_MESSAGE_START.exec(source);\n            if (next === null) {\n                break;\n            }\n            cursor = RE_MESSAGE_START.lastIndex;\n            try {\n                this.body.push(parseMessage(next[1]));\n            }\n            catch (err) {\n                if (err instanceof SyntaxError) {\n                    // Don't report any Fluent syntax errors. Skip directly to the\n                    // beginning of the next message or term.\n                    continue;\n                }\n                throw err;\n            }\n        }\n        // The parser implementation is inlined below for performance reasons,\n        // as well as for convenience of accessing `source` and `cursor`.\n        // The parser focuses on minimizing the number of false negatives at the\n        // expense of increasing the risk of false positives. In other words, it\n        // aims at parsing valid Fluent messages with a success rate of 100%, but it\n        // may also parse a few invalid messages which the reference parser would\n        // reject. The parser doesn't perform any validation and may produce entries\n        // which wouldn't make sense in the real world. For best results users are\n        // advised to validate translations with the fluent-syntax parser\n        // pre-runtime.\n        // The parser makes an extensive use of sticky regexes which can be anchored\n        // to any offset of the source string without slicing it. Errors are thrown\n        // to bail out of parsing of ill-formed messages.\n        function test(re) {\n            re.lastIndex = cursor;\n            return re.test(source);\n        }\n        // Advance the cursor by the char if it matches. May be used as a predicate\n        // (was the match found?) or, if errorClass is passed, as an assertion.\n        function consumeChar(char, errorClass) {\n            if (source[cursor] === char) {\n                cursor++;\n                return true;\n            }\n            if (errorClass) {\n                throw new errorClass(`Expected ${char}`);\n            }\n            return false;\n        }\n        // Advance the cursor by the token if it matches. May be used as a predicate\n        // (was the match found?) or, if errorClass is passed, as an assertion.\n        function consumeToken(re, errorClass) {\n            if (test(re)) {\n                cursor = re.lastIndex;\n                return true;\n            }\n            if (errorClass) {\n                throw new errorClass(`Expected ${re.toString()}`);\n            }\n            return false;\n        }\n        // Execute a regex, advance the cursor, and return all capture groups.\n        function match(re) {\n            re.lastIndex = cursor;\n            let result = re.exec(source);\n            if (result === null) {\n                throw new SyntaxError(`Expected ${re.toString()}`);\n            }\n            cursor = re.lastIndex;\n            return result;\n        }\n        // Execute a regex, advance the cursor, and return the capture group.\n        function match1(re) {\n            return match(re)[1];\n        }\n        function parseMessage(id) {\n            let value = parsePattern();\n            let attributes = parseAttributes();\n            if (value === null && Object.keys(attributes).length === 0) {\n                throw new SyntaxError(\"Expected message value or attributes\");\n            }\n            return { id, value, attributes };\n        }\n        function parseAttributes() {\n            let attrs = Object.create(null);\n            while (test(RE_ATTRIBUTE_START)) {\n                let name = match1(RE_ATTRIBUTE_START);\n                let value = parsePattern();\n                if (value === null) {\n                    throw new SyntaxError(\"Expected attribute value\");\n                }\n                attrs[name] = value;\n            }\n            return attrs;\n        }\n        function parsePattern() {\n            let first;\n            // First try to parse any simple text on the same line as the id.\n            if (test(RE_TEXT_RUN)) {\n                first = match1(RE_TEXT_RUN);\n            }\n            // If there's a placeable on the first line, parse a complex pattern.\n            if (source[cursor] === \"{\" || source[cursor] === \"}\") {\n                // Re-use the text parsed above, if possible.\n                return parsePatternElements(first ? [first] : [], Infinity);\n            }\n            // RE_TEXT_VALUE stops at newlines. Only continue parsing the pattern if\n            // what comes after the newline is indented.\n            let indent = parseIndent();\n            if (indent) {\n                if (first) {\n                    // If there's text on the first line, the blank block is part of the\n                    // translation content in its entirety.\n                    return parsePatternElements([first, indent], indent.length);\n                }\n                // Otherwise, we're dealing with a block pattern, i.e. a pattern which\n                // starts on a new line. Discrad the leading newlines but keep the\n                // inline indent; it will be used by the dedentation logic.\n                indent.value = trim(indent.value, RE_LEADING_NEWLINES);\n                return parsePatternElements([indent], indent.length);\n            }\n            if (first) {\n                // It was just a simple inline text after all.\n                return trim(first, RE_TRAILING_SPACES);\n            }\n            return null;\n        }\n        // Parse a complex pattern as an array of elements.\n        function parsePatternElements(elements = [], commonIndent) {\n            while (true) {\n                if (test(RE_TEXT_RUN)) {\n                    elements.push(match1(RE_TEXT_RUN));\n                    continue;\n                }\n                if (source[cursor] === \"{\") {\n                    elements.push(parsePlaceable());\n                    continue;\n                }\n                if (source[cursor] === \"}\") {\n                    throw new SyntaxError(\"Unbalanced closing brace\");\n                }\n                let indent = parseIndent();\n                if (indent) {\n                    elements.push(indent);\n                    commonIndent = Math.min(commonIndent, indent.length);\n                    continue;\n                }\n                break;\n            }\n            let lastIndex = elements.length - 1;\n            let lastElement = elements[lastIndex];\n            // Trim the trailing spaces in the last element if it's a TextElement.\n            if (typeof lastElement === \"string\") {\n                elements[lastIndex] = trim(lastElement, RE_TRAILING_SPACES);\n            }\n            let baked = [];\n            for (let element of elements) {\n                if (element instanceof Indent) {\n                    // Dedent indented lines by the maximum common indent.\n                    element = element.value.slice(0, element.value.length - commonIndent);\n                }\n                if (element) {\n                    baked.push(element);\n                }\n            }\n            return baked;\n        }\n        function parsePlaceable() {\n            consumeToken(TOKEN_BRACE_OPEN, SyntaxError);\n            let selector = parseInlineExpression();\n            if (consumeToken(TOKEN_BRACE_CLOSE)) {\n                return selector;\n            }\n            if (consumeToken(TOKEN_ARROW)) {\n                let variants = parseVariants();\n                consumeToken(TOKEN_BRACE_CLOSE, SyntaxError);\n                return {\n                    type: \"select\",\n                    selector,\n                    ...variants,\n                };\n            }\n            throw new SyntaxError(\"Unclosed placeable\");\n        }\n        function parseInlineExpression() {\n            if (source[cursor] === \"{\") {\n                // It's a nested placeable.\n                return parsePlaceable();\n            }\n            if (test(RE_REFERENCE)) {\n                let [, sigil, name, attr = null] = match(RE_REFERENCE);\n                if (sigil === \"$\") {\n                    return { type: \"var\", name };\n                }\n                if (consumeToken(TOKEN_PAREN_OPEN)) {\n                    let args = parseArguments();\n                    if (sigil === \"-\") {\n                        // A parameterized term: -term(...).\n                        return { type: \"term\", name, attr, args };\n                    }\n                    if (RE_FUNCTION_NAME.test(name)) {\n                        return { type: \"func\", name, args };\n                    }\n                    throw new SyntaxError(\"Function names must be all upper-case\");\n                }\n                if (sigil === \"-\") {\n                    // A non-parameterized term: -term.\n                    return {\n                        type: \"term\",\n                        name,\n                        attr,\n                        args: [],\n                    };\n                }\n                return { type: \"mesg\", name, attr };\n            }\n            return parseLiteral();\n        }\n        function parseArguments() {\n            let args = [];\n            while (true) {\n                switch (source[cursor]) {\n                    case \")\": // End of the argument list.\n                        cursor++;\n                        return args;\n                    case undefined: // EOF\n                        throw new SyntaxError(\"Unclosed argument list\");\n                }\n                args.push(parseArgument());\n                // Commas between arguments are treated as whitespace.\n                consumeToken(TOKEN_COMMA);\n            }\n        }\n        function parseArgument() {\n            let expr = parseInlineExpression();\n            if (expr.type !== \"mesg\") {\n                return expr;\n            }\n            if (consumeToken(TOKEN_COLON)) {\n                // The reference is the beginning of a named argument.\n                return {\n                    type: \"narg\",\n                    name: expr.name,\n                    value: parseLiteral(),\n                };\n            }\n            // It's a regular message reference.\n            return expr;\n        }\n        function parseVariants() {\n            let variants = [];\n            let count = 0;\n            let star;\n            while (test(RE_VARIANT_START)) {\n                if (consumeChar(\"*\")) {\n                    star = count;\n                }\n                let key = parseVariantKey();\n                let value = parsePattern();\n                if (value === null) {\n                    throw new SyntaxError(\"Expected variant value\");\n                }\n                variants[count++] = { key, value };\n            }\n            if (count === 0) {\n                return null;\n            }\n            if (star === undefined) {\n                throw new SyntaxError(\"Expected default variant\");\n            }\n            return { variants, star };\n        }\n        function parseVariantKey() {\n            consumeToken(TOKEN_BRACKET_OPEN, SyntaxError);\n            let key;\n            if (test(RE_NUMBER_LITERAL)) {\n                key = parseNumberLiteral();\n            }\n            else {\n                key = {\n                    type: \"str\",\n                    value: match1(RE_IDENTIFIER),\n                };\n            }\n            consumeToken(TOKEN_BRACKET_CLOSE, SyntaxError);\n            return key;\n        }\n        function parseLiteral() {\n            if (test(RE_NUMBER_LITERAL)) {\n                return parseNumberLiteral();\n            }\n            if (source[cursor] === '\"') {\n                return parseStringLiteral();\n            }\n            throw new SyntaxError(\"Invalid expression\");\n        }\n        function parseNumberLiteral() {\n            let [, value, fraction = \"\"] = match(RE_NUMBER_LITERAL);\n            let precision = fraction.length;\n            return {\n                type: \"num\",\n                value: parseFloat(value),\n                precision,\n            };\n        }\n        function parseStringLiteral() {\n            consumeChar('\"', SyntaxError);\n            let value = \"\";\n            while (true) {\n                value += match1(RE_STRING_RUN);\n                if (source[cursor] === \"\\\\\") {\n                    value += parseEscapeSequence();\n                    continue;\n                }\n                if (consumeChar('\"')) {\n                    return { type: \"str\", value };\n                }\n                // We've reached an EOL of EOF.\n                throw new SyntaxError(\"Unclosed string literal\");\n            }\n        }\n        // Unescape known escape sequences.\n        function parseEscapeSequence() {\n            if (test(RE_STRING_ESCAPE)) {\n                return match1(RE_STRING_ESCAPE);\n            }\n            if (test(RE_UNICODE_ESCAPE)) {\n                let [, codepoint4, codepoint6] = match(RE_UNICODE_ESCAPE);\n                let codepoint = parseInt(codepoint4 || codepoint6, 16);\n                return codepoint <= 0xd7ff || 0xe000 <= codepoint\n                    ? // It's a Unicode scalar value.\n                        String.fromCodePoint(codepoint)\n                    : // Lonely surrogates can cause trouble when the parsing result is\n                        // saved using UTF-8. Use U+FFFD REPLACEMENT CHARACTER instead.\n                        \"\";\n            }\n            throw new SyntaxError(\"Unknown escape sequence\");\n        }\n        // Parse blank space. Return it if it looks like indent before a pattern\n        // line. Skip it othwerwise.\n        function parseIndent() {\n            let start = cursor;\n            consumeToken(TOKEN_BLANK);\n            // Check the first non-blank character after the indent.\n            switch (source[cursor]) {\n                case \".\":\n                case \"[\":\n                case \"*\":\n                case \"}\":\n                case undefined: // EOF\n                    // A special character. End the Pattern.\n                    return false;\n                case \"{\":\n                    // Placeables don't require indentation (in EBNF: block-placeable).\n                    // Continue the Pattern.\n                    return makeIndent(source.slice(start, cursor));\n            }\n            // If the first character on the line is not one of the special characters\n            // listed above, it's a regular text character. Check if there's at least\n            // one space of indent before it.\n            if (source[cursor - 1] === \" \") {\n                // It's an indented text character (in EBNF: indented-char). Continue\n                // the Pattern.\n                return makeIndent(source.slice(start, cursor));\n            }\n            // A not-indented text character is likely the identifier of the next\n            // message. End the Pattern.\n            return false;\n        }\n        // Trim blanks in text according to the given regex.\n        function trim(text, re) {\n            return text.replace(re, \"\");\n        }\n        // Normalize a blank block and extract the indent details.\n        function makeIndent(blank) {\n            let value = blank.replace(RE_BLANK_LINES, \"\\n\");\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            let length = RE_INDENT.exec(blank)[1].length;\n            return new Indent(value, length);\n        }\n    }\n}\nclass Indent {\n    constructor(value, length) {\n        this.value = value;\n        this.length = length;\n    }\n}\n","/**\n * @module fluent\n * @overview\n *\n * `fluent` is a JavaScript implementation of Project Fluent, a localization\n * framework designed to unleash the expressive power of the natural language.\n *\n */\nexport { FluentBundle } from \"./bundle.js\";\nexport { FluentResource } from \"./resource.js\";\nexport { FluentType, FluentNone, FluentNumber, FluentDateTime, } from \"./types.js\";\n","/* eslint no-console: [\"error\", {allow: [\"warn\"]}] */\n/* global console */\n// Match the opening angle bracket (<) in HTML tags, and HTML entities like\n// &amp;, &#0038;, &#x0026;.\nconst reOverlay = /<|&#?\\w+;/;\n/**\n * Elements allowed in translations even if they are not present in the source\n * HTML. They are text-level elements as defined by the HTML5 spec:\n * https://www.w3.org/TR/html5/text-level-semantics.html with the exception of:\n *\n *   - a - because we don't allow href on it anyways,\n *   - ruby, rt, rp - because we don't allow nested elements to be inserted.\n */\nconst TEXT_LEVEL_ELEMENTS = {\n    \"http://www.w3.org/1999/xhtml\": [\n        \"em\",\n        \"strong\",\n        \"small\",\n        \"s\",\n        \"cite\",\n        \"q\",\n        \"dfn\",\n        \"abbr\",\n        \"data\",\n        \"time\",\n        \"code\",\n        \"var\",\n        \"samp\",\n        \"kbd\",\n        \"sub\",\n        \"sup\",\n        \"i\",\n        \"b\",\n        \"u\",\n        \"mark\",\n        \"bdi\",\n        \"bdo\",\n        \"span\",\n        \"br\",\n        \"wbr\",\n    ],\n};\nconst LOCALIZABLE_ATTRIBUTES = {\n    \"http://www.w3.org/1999/xhtml\": {\n        global: [\"title\", \"aria-label\", \"aria-valuetext\"],\n        a: [\"download\"],\n        area: [\"download\", \"alt\"],\n        // value is special-cased in isAttrNameLocalizable\n        input: [\"alt\", \"placeholder\"],\n        menuitem: [\"label\"],\n        menu: [\"label\"],\n        optgroup: [\"label\"],\n        option: [\"label\"],\n        track: [\"label\"],\n        img: [\"alt\"],\n        textarea: [\"placeholder\"],\n        th: [\"abbr\"],\n    },\n    \"http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul\": {\n        global: [\n            \"accesskey\",\n            \"aria-label\",\n            \"aria-valuetext\",\n            \"label\",\n            \"title\",\n            \"tooltiptext\",\n        ],\n        description: [\"value\"],\n        key: [\"key\", \"keycode\"],\n        label: [\"value\"],\n        textbox: [\"placeholder\", \"value\"],\n    },\n};\n/**\n * Translate an element.\n *\n * Translate the element's text content and attributes. Some HTML markup is\n * allowed in the translation. The element's children with the data-l10n-name\n * attribute will be treated as arguments to the translation. If the\n * translation defines the same children, their attributes and text contents\n * will be used for translating the matching source child.\n *\n * @param   {Element} element\n * @param   {Object} translation\n * @private\n */\nexport default function translateElement(element, translation) {\n    const { value } = translation;\n    if (typeof value === \"string\") {\n        if (element.localName === \"title\" &&\n            element.namespaceURI === \"http://www.w3.org/1999/xhtml\") {\n            // A special case for the HTML title element whose content must be text.\n            element.textContent = value;\n        }\n        else if (!reOverlay.test(value)) {\n            // If the translation doesn't contain any markup skip the overlay logic.\n            element.textContent = value;\n        }\n        else {\n            // Else parse the translation's HTML using an inert template element,\n            // sanitize it and replace the element's content.\n            const templateElement = element.ownerDocument.createElementNS(\"http://www.w3.org/1999/xhtml\", \"template\");\n            templateElement.innerHTML = value;\n            overlayChildNodes(templateElement.content, element);\n        }\n    }\n    // Even if the translation doesn't define any localizable attributes, run\n    // overlayAttributes to remove any localizable attributes set by previous\n    // translations.\n    overlayAttributes(translation, element);\n}\n/**\n * Replace child nodes of an element with child nodes of another element.\n *\n * The contents of the target element will be cleared and fully replaced with\n * sanitized contents of the source element.\n *\n * @param {DocumentFragment} fromFragment - The source of children to overlay.\n * @param {Element} toElement - The target of the overlay.\n * @private\n */\nfunction overlayChildNodes(fromFragment, toElement) {\n    for (const childNode of fromFragment.childNodes) {\n        if (childNode.nodeType === childNode.TEXT_NODE) {\n            // Keep the translated text node.\n            continue;\n        }\n        if (childNode.hasAttribute(\"data-l10n-name\")) {\n            const sanitized = getNodeForNamedElement(toElement, childNode);\n            fromFragment.replaceChild(sanitized, childNode);\n            continue;\n        }\n        if (isElementAllowed(childNode)) {\n            const sanitized = createSanitizedElement(childNode);\n            fromFragment.replaceChild(sanitized, childNode);\n            continue;\n        }\n        console.warn(`An element of forbidden type \"${childNode.localName}\" was found in ` +\n            \"the translation. Only safe text-level elements and elements with \" +\n            \"data-l10n-name are allowed.\");\n        // If all else fails, replace the element with its text content.\n        fromFragment.replaceChild(createTextNodeFromTextContent(childNode), childNode);\n    }\n    toElement.textContent = \"\";\n    toElement.appendChild(fromFragment);\n}\nfunction hasAttribute(attributes, name) {\n    if (!attributes) {\n        return false;\n    }\n    for (let attr of attributes) {\n        if (attr.name === name) {\n            return true;\n        }\n    }\n    return false;\n}\n/**\n * Transplant localizable attributes of an element to another element.\n *\n * Any localizable attributes already set on the target element will be\n * cleared.\n *\n * @param   {Element|Object} fromElement - The source of child nodes to overlay.\n * @param   {Element} toElement - The target of the overlay.\n * @private\n */\nfunction overlayAttributes(fromElement, toElement) {\n    const explicitlyAllowed = toElement.hasAttribute(\"data-l10n-attrs\")\n        ? toElement\n            .getAttribute(\"data-l10n-attrs\")\n            .split(\",\")\n            .map(i => i.trim())\n        : null;\n    // Remove existing localizable attributes if they\n    // will not be used in the new translation.\n    for (const attr of Array.from(toElement.attributes)) {\n        if (isAttrNameLocalizable(attr.name, toElement, explicitlyAllowed) &&\n            !hasAttribute(fromElement.attributes, attr.name)) {\n            toElement.removeAttribute(attr.name);\n        }\n    }\n    // fromElement might be a {value, attributes} object as returned by\n    // Localization.messageFromBundle. In which case attributes may be null to\n    // save GC cycles.\n    if (!fromElement.attributes) {\n        return;\n    }\n    // Set localizable attributes.\n    for (const attr of Array.from(fromElement.attributes)) {\n        if (isAttrNameLocalizable(attr.name, toElement, explicitlyAllowed) &&\n            toElement.getAttribute(attr.name) !== attr.value) {\n            toElement.setAttribute(attr.name, attr.value);\n        }\n    }\n}\n/**\n * Sanitize a child element created by the translation.\n *\n * Try to find a corresponding child in sourceElement and use it as the base\n * for the sanitization. This will preserve functional attribtues defined on\n * the child element in the source HTML.\n *\n * @param   {Element} sourceElement - The source for data-l10n-name lookups.\n * @param   {Element} translatedChild - The translated child to be sanitized.\n * @returns {Element}\n * @private\n */\nfunction getNodeForNamedElement(sourceElement, translatedChild) {\n    const childName = translatedChild.getAttribute(\"data-l10n-name\");\n    const sourceChild = sourceElement.querySelector(`[data-l10n-name=\"${childName}\"]`);\n    if (!sourceChild) {\n        console.warn(`An element named \"${childName}\" wasn't found in the source.`);\n        return createTextNodeFromTextContent(translatedChild);\n    }\n    if (sourceChild.localName !== translatedChild.localName) {\n        console.warn(`An element named \"${childName}\" was found in the translation ` +\n            `but its type ${translatedChild.localName} didn't match the ` +\n            `element found in the source (${sourceChild.localName}).`);\n        return createTextNodeFromTextContent(translatedChild);\n    }\n    // Remove it from sourceElement so that the translation cannot use\n    // the same reference name again.\n    sourceElement.removeChild(sourceChild);\n    // We can't currently guarantee that a translation won't remove\n    // sourceChild from the element completely, which could break the app if\n    // it relies on an event handler attached to the sourceChild. Let's make\n    // this limitation explicit for now by breaking the identitiy of the\n    // sourceChild by cloning it. This will destroy all event handlers\n    // attached to sourceChild via addEventListener and via on<name>\n    // properties.\n    const clone = sourceChild.cloneNode(false);\n    return shallowPopulateUsing(translatedChild, clone);\n}\n/**\n * Sanitize an allowed element.\n *\n * Text-level elements allowed in translations may only use safe attributes\n * and will have any nested markup stripped to text content.\n *\n * @param   {Element} element - The element to be sanitized.\n * @returns {Element}\n * @private\n */\nfunction createSanitizedElement(element) {\n    // Start with an empty element of the same type to remove nested children\n    // and non-localizable attributes defined by the translation.\n    const clone = element.ownerDocument.createElement(element.localName);\n    return shallowPopulateUsing(element, clone);\n}\n/**\n * Convert an element to a text node.\n *\n * @param   {Element} element - The element to be sanitized.\n * @returns {Node}\n * @private\n */\nfunction createTextNodeFromTextContent(element) {\n    return element.ownerDocument.createTextNode(element.textContent);\n}\n/**\n * Check if element is allowed in the translation.\n *\n * This method is used by the sanitizer when the translation markup contains\n * an element which is not present in the source code.\n *\n * @param   {Element} element\n * @returns {boolean}\n * @private\n */\nfunction isElementAllowed(element) {\n    const allowed = TEXT_LEVEL_ELEMENTS[element.namespaceURI];\n    return allowed && allowed.includes(element.localName);\n}\n/**\n * Check if attribute is allowed for the given element.\n *\n * This method is used by the sanitizer when the translation markup contains\n * DOM attributes, or when the translation has traits which map to DOM\n * attributes.\n *\n * `explicitlyAllowed` can be passed as a list of attributes explicitly\n * allowed on this element.\n *\n * @param   {string}         name\n * @param   {Element}        element\n * @param   {Array}          explicitlyAllowed\n * @returns {boolean}\n * @private\n */\nfunction isAttrNameLocalizable(name, element, explicitlyAllowed = null) {\n    if (explicitlyAllowed && explicitlyAllowed.includes(name)) {\n        return true;\n    }\n    const allowed = LOCALIZABLE_ATTRIBUTES[element.namespaceURI];\n    if (!allowed) {\n        return false;\n    }\n    const attrName = name.toLowerCase();\n    const elemName = element.localName;\n    // Is it a globally safe attribute?\n    if (allowed.global.includes(attrName)) {\n        return true;\n    }\n    // Are there no allowed attributes for this element?\n    if (!allowed[elemName]) {\n        return false;\n    }\n    // Is it allowed on this element?\n    if (allowed[elemName].includes(attrName)) {\n        return true;\n    }\n    // Special case for value on HTML inputs with type button, reset, submit\n    if (element.namespaceURI === \"http://www.w3.org/1999/xhtml\" &&\n        elemName === \"input\" &&\n        attrName === \"value\") {\n        const type = element.type.toLowerCase();\n        if (type === \"submit\" || type === \"button\" || type === \"reset\") {\n            return true;\n        }\n    }\n    return false;\n}\n/**\n * Helper to set textContent and localizable attributes on an element.\n *\n * @param   {Element} fromElement\n * @param   {Element} toElement\n * @returns {Element}\n * @private\n */\nfunction shallowPopulateUsing(fromElement, toElement) {\n    toElement.textContent = fromElement.textContent;\n    overlayAttributes(fromElement, toElement);\n    return toElement;\n}\n","/*\n * Base CachedIterable class.\n */\nexport default class CachedIterable extends Array {\n    /**\n     * Create a `CachedIterable` instance from an iterable or, if another\n     * instance of `CachedIterable` is passed, return it without any\n     * modifications.\n     *\n     * @param {Iterable} iterable\n     * @returns {CachedIterable}\n     */\n    static from(iterable) {\n        if (iterable instanceof this) {\n            return iterable;\n        }\n\n        return new this(iterable);\n    }\n}\n","import CachedIterable from \"./cached_iterable.mjs\";\n\n/*\n * CachedSyncIterable caches the elements yielded by an iterable.\n *\n * It can be used to iterate over an iterable many times without depleting the\n * iterable.\n */\nexport default class CachedSyncIterable extends CachedIterable {\n    /**\n     * Create an `CachedSyncIterable` instance.\n     *\n     * @param {Iterable} iterable\n     * @returns {CachedSyncIterable}\n     */\n    constructor(iterable) {\n        super();\n\n        if (Symbol.iterator in Object(iterable)) {\n            this.iterator = iterable[Symbol.iterator]();\n        } else {\n            throw new TypeError(\"Argument must implement the iteration protocol.\");\n        }\n    }\n\n    [Symbol.iterator]() {\n        const cached = this;\n        let cur = 0;\n\n        return {\n            next() {\n                if (cached.length <= cur) {\n                    cached.push(cached.iterator.next());\n                }\n                return cached[cur++];\n            }\n        };\n    }\n\n    /**\n     * This method allows user to consume the next element from the iterator\n     * into the cache.\n     *\n     * @param {number} count - number of elements to consume\n     */\n    touchNext(count = 1) {\n        let idx = 0;\n        while (idx++ < count) {\n            const last = this[this.length - 1];\n            if (last && last.done) {\n                break;\n            }\n            this.push(this.iterator.next());\n        }\n        // Return the last cached {value, done} object to allow the calling\n        // code to decide if it needs to call touchNext again.\n        return this[this.length - 1];\n    }\n}\n","import CachedIterable from \"./cached_iterable.mjs\";\n\n/*\n * CachedAsyncIterable caches the elements yielded by an async iterable.\n *\n * It can be used to iterate over an iterable many times without depleting the\n * iterable.\n */\nexport default class CachedAsyncIterable extends CachedIterable {\n    /**\n     * Create an `CachedAsyncIterable` instance.\n     *\n     * @param {Iterable} iterable\n     * @returns {CachedAsyncIterable}\n     */\n    constructor(iterable) {\n        super();\n\n        if (Symbol.asyncIterator in Object(iterable)) {\n            this.iterator = iterable[Symbol.asyncIterator]();\n        } else if (Symbol.iterator in Object(iterable)) {\n            this.iterator = iterable[Symbol.iterator]();\n        } else {\n            throw new TypeError(\"Argument must implement the iteration protocol.\");\n        }\n    }\n\n    /**\n     * Asynchronous iterator caching the yielded elements.\n     *\n     * Elements yielded by the original iterable will be cached and available\n     * synchronously. Returns an async generator object implementing the\n     * iterator protocol over the elements of the original (async or sync)\n     * iterable.\n     */\n    [Symbol.asyncIterator]() {\n        const cached = this;\n        let cur = 0;\n\n        return {\n            async next() {\n                if (cached.length <= cur) {\n                    cached.push(cached.iterator.next());\n                }\n                return cached[cur++];\n            }\n        };\n    }\n\n    /**\n     * This method allows user to consume the next element from the iterator\n     * into the cache.\n     *\n     * @param {number} count - number of elements to consume\n     */\n    async touchNext(count = 1) {\n        let idx = 0;\n        while (idx++ < count) {\n            const last = this[this.length - 1];\n            if (last && (await last).done) {\n                break;\n            }\n            this.push(this.iterator.next());\n        }\n        // Return the last cached {value, done} object to allow the calling\n        // code to decide if it needs to call touchNext again.\n        return this[this.length - 1];\n    }\n}\n","export {default as CachedSyncIterable} from \"./cached_sync_iterable.mjs\";\nexport {default as CachedAsyncIterable} from \"./cached_async_iterable.mjs\";\n","/* eslint no-console: [\"error\", { allow: [\"warn\", \"error\"] }] */\n/* global console */\nimport { CachedAsyncIterable } from \"cached-iterable\";\n/**\n * The `Localization` class is a central high-level API for vanilla\n * JavaScript use of Fluent.\n * It combines language negotiation, FluentBundle and I/O to\n * provide a scriptable API to format translations.\n */\nexport default class Localization {\n    /**\n     * @param {Array<String>} resourceIds     - List of resource IDs\n     * @param {Function}      generateBundles - Function that returns a\n     *                                          generator over FluentBundles\n     *\n     * @returns {Localization}\n     */\n    constructor(resourceIds = [], generateBundles) {\n        this.resourceIds = resourceIds;\n        this.generateBundles = generateBundles;\n        this.onChange(true);\n    }\n    addResourceIds(resourceIds, eager = false) {\n        this.resourceIds.push(...resourceIds);\n        this.onChange(eager);\n        return this.resourceIds.length;\n    }\n    removeResourceIds(resourceIds) {\n        this.resourceIds = this.resourceIds.filter(r => !resourceIds.includes(r));\n        this.onChange();\n        return this.resourceIds.length;\n    }\n    /**\n     * Format translations and handle fallback if needed.\n     *\n     * Format translations for `keys` from `FluentBundle` instances on this\n     * DOMLocalization. In case of errors, fetch the next context in the\n     * fallback chain.\n     *\n     * @param   {Array<Object>}         keys    - Translation keys to format.\n     * @param   {Function}              method  - Formatting function.\n     * @returns {Promise<Array<string|Object>>}\n     * @private\n     */\n    async formatWithFallback(keys, method) {\n        const translations = [];\n        let hasAtLeastOneBundle = false;\n        for await (const bundle of this.bundles) {\n            hasAtLeastOneBundle = true;\n            const missingIds = keysFromBundle(method, bundle, keys, translations);\n            if (missingIds.size === 0) {\n                break;\n            }\n            if (typeof console !== \"undefined\") {\n                const locale = bundle.locales[0];\n                const ids = Array.from(missingIds).join(\", \");\n                console.warn(`[fluent] Missing translations in ${locale}: ${ids}`);\n            }\n        }\n        if (!hasAtLeastOneBundle && typeof console !== \"undefined\") {\n            // eslint-disable-next-line max-len\n            console.warn(`[fluent] Request for keys failed because no resource bundles got generated.\n  keys: ${JSON.stringify(keys)}.\n  resourceIds: ${JSON.stringify(this.resourceIds)}.`);\n        }\n        return translations;\n    }\n    /**\n     * Format translations into `{value, attributes}` objects.\n     *\n     * The fallback logic is the same as in `formatValues`\n     * but it returns `{value, attributes}` objects\n     * which are suitable for the translation of DOM elements.\n     *\n     * Returns a Promise resolving to an array of the translation strings.\n     *\n     * @example\n     * ```js\n     * docL10n.formatMessages([\n     *   {id: 'hello', args: { who: 'Mary' }},\n     *   {id: 'welcome'}\n     * ]).then(console.log);\n     *\n     * // [\n     * //   { value: 'Hello, Mary!', attributes: null },\n     * //   {\n     * //     value: 'Welcome!',\n     * //     attributes: [ { name: \"title\", value: 'Hello' } ]\n     * //   }\n     * // ]\n     * ```\n     *\n     * @param   {Array<Object>} keys\n     * @returns {Promise<Array<{value: string, attributes: Object}>>}\n     * @private\n     */\n    formatMessages(keys) {\n        return this.formatWithFallback(keys, messageFromBundle);\n    }\n    /**\n     * Retrieve translations corresponding to the passed keys.\n     *\n     * A generalized version of `DOMLocalization.formatValue`. Keys must\n     * be `{id, args}` objects.\n     *\n     * Returns a Promise resolving to an array of the translation strings.\n     *\n     * @example\n     * ```js\n     * docL10n.formatValues([\n     *   {id: 'hello', args: { who: 'Mary' }},\n     *   {id: 'hello', args: { who: 'John' }},\n     *   {id: 'welcome'}\n     * ]).then(console.log);\n     *\n     * // ['Hello, Mary!', 'Hello, John!', 'Welcome!']\n     * ```\n     *\n     * @param   {Array<Object>} keys\n     * @returns {Promise<Array<string>>}\n     */\n    formatValues(keys) {\n        return this.formatWithFallback(keys, valueFromBundle);\n    }\n    /**\n     * Retrieve the translation corresponding to the `id` identifier.\n     *\n     * If passed, `args` is a simple hash object with a list of variables that\n     * will be interpolated in the value of the translation.\n     *\n     * Returns a Promise resolving to the translation string.\n     *\n     * Use this sparingly for one-off messages which don't need to be\n     * retranslated when the user changes their language preferences, e.g. in\n     * notifications.\n     *\n     * @example\n     * ```js\n     * docL10n.formatValue(\n     *   'hello', { who: 'world' }\n     * ).then(console.log);\n     *\n     * // 'Hello, world!'\n     * ```\n     *\n     * @param   {string}  id     - Identifier of the translation to format\n     * @param   {Object}  [args] - Optional external arguments\n     * @returns {Promise<string>}\n     */\n    async formatValue(id, args) {\n        const [val] = await this.formatValues([{ id, args }]);\n        return val;\n    }\n    handleEvent() {\n        this.onChange();\n    }\n    /**\n     * This method should be called when there's a reason to believe\n     * that language negotiation or available resources changed.\n     */\n    onChange(eager = false) {\n        this.bundles = CachedAsyncIterable.from(this.generateBundles(this.resourceIds));\n        if (eager) {\n            this.bundles.touchNext(2);\n        }\n    }\n}\n/**\n * Format the value of a message into a string or `null`.\n *\n * This function is passed as a method to `keysFromBundle` and resolve\n * a value of a single L10n Entity using provided `FluentBundle`.\n *\n * If the message doesn't have a value, return `null`.\n *\n * @param   {FluentBundle} bundle\n * @param   {Array<Error>} errors\n * @param   {Object} message\n * @param   {Object} args\n * @returns {string|null}\n * @private\n */\nfunction valueFromBundle(bundle, errors, message, args) {\n    if (message.value) {\n        return bundle.formatPattern(message.value, args, errors);\n    }\n    return null;\n}\n/**\n * Format all public values of a message into a {value, attributes} object.\n *\n * This function is passed as a method to `keysFromBundle` and resolve\n * a single L10n Entity using provided `FluentBundle`.\n *\n * The function will return an object with a value and attributes of the\n * entity.\n *\n * @param   {FluentBundle} bundle\n * @param   {Array<Error>} errors\n * @param   {Object} message\n * @param   {Object} args\n * @returns {Object}\n * @private\n */\nfunction messageFromBundle(bundle, errors, message, args) {\n    const formatted = {\n        value: null,\n        attributes: null,\n    };\n    if (message.value) {\n        formatted.value = bundle.formatPattern(message.value, args, errors);\n    }\n    let attrNames = Object.keys(message.attributes);\n    if (attrNames.length > 0) {\n        formatted.attributes = new Array(attrNames.length);\n        for (let [i, name] of attrNames.entries()) {\n            let value = bundle.formatPattern(message.attributes[name], args, errors);\n            formatted.attributes[i] = { name, value };\n        }\n    }\n    return formatted;\n}\n/**\n * This function is an inner function for `Localization.formatWithFallback`.\n *\n * It takes a `FluentBundle`, list of l10n-ids and a method to be used for\n * key resolution (either `valueFromBundle` or `messageFromBundle`) and\n * optionally a value returned from `keysFromBundle` executed against\n * another `FluentBundle`.\n *\n * The idea here is that if the previous `FluentBundle` did not resolve\n * all keys, we're calling this function with the next context to resolve\n * the remaining ones.\n *\n * In the function, we loop over `keys` and check if we have the `prev`\n * passed and if it has an error entry for the position we're in.\n *\n * If it doesn't, it means that we have a good translation for this key and\n * we return it. If it does, we'll try to resolve the key using the passed\n * `FluentBundle`.\n *\n * In the end, we fill the translations array, and return the Set with\n * missing ids.\n *\n * See `Localization.formatWithFallback` for more info on how this is used.\n *\n * @param {Function}       method\n * @param {FluentBundle} bundle\n * @param {Array<string>}  keys\n * @param {{Array<{value: string, attributes: Object}>}} translations\n *\n * @returns {Set<string>}\n * @private\n */\nfunction keysFromBundle(method, bundle, keys, translations) {\n    const messageErrors = [];\n    const missingIds = new Set();\n    keys.forEach(({ id, args }, i) => {\n        if (translations[i] !== undefined) {\n            return;\n        }\n        let message = bundle.getMessage(id);\n        if (message) {\n            messageErrors.length = 0;\n            translations[i] = method(bundle, messageErrors, message, args);\n            if (messageErrors.length > 0 && typeof console !== \"undefined\") {\n                const locale = bundle.locales[0];\n                const errors = messageErrors.join(\", \");\n                // eslint-disable-next-line max-len\n                console.warn(`[fluent][resolver] errors in ${locale}/${id}: ${errors}.`);\n            }\n        }\n        else {\n            missingIds.add(id);\n        }\n    });\n    return missingIds;\n}\n","import translateElement from \"./overlay.js\";\nimport Localization from \"./localization.js\";\nconst L10NID_ATTR_NAME = \"data-l10n-id\";\nconst L10NARGS_ATTR_NAME = \"data-l10n-args\";\nconst L10N_ELEMENT_QUERY = `[${L10NID_ATTR_NAME}]`;\n/**\n * The `DOMLocalization` class is responsible for fetching resources and\n * formatting translations.\n *\n * It implements the fallback strategy in case of errors encountered during the\n * formatting of translations and methods for observing DOM\n * trees with a `MutationObserver`.\n */\nexport default class DOMLocalization extends Localization {\n    /**\n     * @param {Array<String>}    resourceIds     - List of resource IDs\n     * @param {Function}         generateBundles - Function that returns a\n     *                                             generator over FluentBundles\n     * @returns {DOMLocalization}\n     */\n    constructor(resourceIds, generateBundles) {\n        super(resourceIds, generateBundles);\n        // A Set of DOM trees observed by the `MutationObserver`.\n        this.roots = new Set();\n        // requestAnimationFrame handler.\n        this.pendingrAF = null;\n        // list of elements pending for translation.\n        this.pendingElements = new Set();\n        this.windowElement = null;\n        this.mutationObserver = null;\n        this.observerConfig = {\n            attributes: true,\n            characterData: false,\n            childList: true,\n            subtree: true,\n            attributeFilter: [L10NID_ATTR_NAME, L10NARGS_ATTR_NAME],\n        };\n    }\n    onChange(eager = false) {\n        super.onChange(eager);\n        if (this.roots) {\n            this.translateRoots();\n        }\n    }\n    /**\n     * Set the `data-l10n-id` and `data-l10n-args` attributes on DOM elements.\n     * FluentDOM makes use of mutation observers to detect changes\n     * to `data-l10n-*` attributes and translate elements asynchronously.\n     * `setAttributes` is a convenience method which allows to translate\n     * DOM elements declaratively.\n     *\n     * You should always prefer to use `data-l10n-id` on elements (statically in\n     * HTML or dynamically via `setAttributes`) over manually retrieving\n     * translations with `format`.  The use of attributes ensures that the\n     * elements can be retranslated when the user changes their language\n     * preferences.\n     *\n     * ```javascript\n     * localization.setAttributes(\n     *   document.querySelector('#welcome'), 'hello', { who: 'world' }\n     * );\n     * ```\n     *\n     * This will set the following attributes on the `#welcome` element.\n     * The MutationObserver will pick up this change and will localize the element\n     * asynchronously.\n     *\n     * ```html\n     * <p id='welcome'\n     *   data-l10n-id='hello'\n     *   data-l10n-args='{\"who\": \"world\"}'>\n     * </p>\n     * ```\n     *\n     * @param {Element}                element - Element to set attributes on\n     * @param {string}                 id      - l10n-id string\n     * @param {Object<string, string>} args    - KVP list of l10n arguments\n     * @returns {Element}\n     */\n    setAttributes(element, id, args) {\n        element.setAttribute(L10NID_ATTR_NAME, id);\n        if (args) {\n            element.setAttribute(L10NARGS_ATTR_NAME, JSON.stringify(args));\n        }\n        else {\n            element.removeAttribute(L10NARGS_ATTR_NAME);\n        }\n        return element;\n    }\n    /**\n     * Get the `data-l10n-*` attributes from DOM elements.\n     *\n     * ```javascript\n     * localization.getAttributes(\n     *   document.querySelector('#welcome')\n     * );\n     * // -> { id: 'hello', args: { who: 'world' } }\n     * ```\n     *\n     * @param   {Element}  element - HTML element\n     * @returns {{id: string, args: Object}}\n     */\n    getAttributes(element) {\n        return {\n            id: element.getAttribute(L10NID_ATTR_NAME),\n            args: JSON.parse(element.getAttribute(L10NARGS_ATTR_NAME) || null),\n        };\n    }\n    /**\n     * Add `newRoot` to the list of roots managed by this `DOMLocalization`.\n     *\n     * Additionally, if this `DOMLocalization` has an observer, start observing\n     * `newRoot` in order to translate mutations in it.\n     *\n     * @param {Element}      newRoot - Root to observe.\n     */\n    connectRoot(newRoot) {\n        for (const root of this.roots) {\n            if (root === newRoot ||\n                root.contains(newRoot) ||\n                newRoot.contains(root)) {\n                throw new Error(\"Cannot add a root that overlaps with existing root.\");\n            }\n        }\n        if (this.windowElement) {\n            if (this.windowElement !== newRoot.ownerDocument.defaultView) {\n                throw new Error(`Cannot connect a root:\n          DOMLocalization already has a root from a different window.`);\n            }\n        }\n        else {\n            this.windowElement = newRoot.ownerDocument.defaultView;\n            this.mutationObserver = new this.windowElement.MutationObserver(mutations => this.translateMutations(mutations));\n        }\n        this.roots.add(newRoot);\n        this.mutationObserver.observe(newRoot, this.observerConfig);\n    }\n    /**\n     * Remove `root` from the list of roots managed by this `DOMLocalization`.\n     *\n     * Additionally, if this `DOMLocalization` has an observer, stop observing\n     * `root`.\n     *\n     * Returns `true` if the root was the last one managed by this\n     * `DOMLocalization`.\n     *\n     * @param   {Element} root - Root to disconnect.\n     * @returns {boolean}\n     */\n    disconnectRoot(root) {\n        this.roots.delete(root);\n        // Pause the mutation observer to stop observing `root`.\n        this.pauseObserving();\n        if (this.roots.size === 0) {\n            this.mutationObserver = null;\n            this.windowElement = null;\n            this.pendingrAF = null;\n            this.pendingElements.clear();\n            return true;\n        }\n        // Resume observing all other roots.\n        this.resumeObserving();\n        return false;\n    }\n    /**\n     * Translate all roots associated with this `DOMLocalization`.\n     *\n     * @returns {Promise}\n     */\n    translateRoots() {\n        const roots = Array.from(this.roots);\n        return Promise.all(roots.map(root => this.translateFragment(root)));\n    }\n    /**\n     * Pauses the `MutationObserver`.\n     *\n     * @private\n     */\n    pauseObserving() {\n        if (!this.mutationObserver) {\n            return;\n        }\n        this.translateMutations(this.mutationObserver.takeRecords());\n        this.mutationObserver.disconnect();\n    }\n    /**\n     * Resumes the `MutationObserver`.\n     *\n     * @private\n     */\n    resumeObserving() {\n        if (!this.mutationObserver) {\n            return;\n        }\n        for (const root of this.roots) {\n            this.mutationObserver.observe(root, this.observerConfig);\n        }\n    }\n    /**\n     * Translate mutations detected by the `MutationObserver`.\n     *\n     * @private\n     */\n    translateMutations(mutations) {\n        for (const mutation of mutations) {\n            switch (mutation.type) {\n                case \"attributes\":\n                    if (mutation.target.hasAttribute(\"data-l10n-id\")) {\n                        this.pendingElements.add(mutation.target);\n                    }\n                    break;\n                case \"childList\":\n                    for (const addedNode of mutation.addedNodes) {\n                        if (addedNode.nodeType === addedNode.ELEMENT_NODE) {\n                            if (addedNode.childElementCount) {\n                                for (const element of this.getTranslatables(addedNode)) {\n                                    this.pendingElements.add(element);\n                                }\n                            }\n                            else if (addedNode.hasAttribute(L10NID_ATTR_NAME)) {\n                                this.pendingElements.add(addedNode);\n                            }\n                        }\n                    }\n                    break;\n            }\n        }\n        // This fragment allows us to coalesce all pending translations\n        // into a single requestAnimationFrame.\n        if (this.pendingElements.size > 0) {\n            if (this.pendingrAF === null) {\n                this.pendingrAF = this.windowElement.requestAnimationFrame(() => {\n                    this.translateElements(Array.from(this.pendingElements));\n                    this.pendingElements.clear();\n                    this.pendingrAF = null;\n                });\n            }\n        }\n    }\n    /**\n     * Translate a DOM element or fragment asynchronously using this\n     * `DOMLocalization` object.\n     *\n     * Manually trigger the translation (or re-translation) of a DOM fragment.\n     * Use the `data-l10n-id` and `data-l10n-args` attributes to mark up the DOM\n     * with information about which translations to use.\n     *\n     * Returns a `Promise` that gets resolved once the translation is complete.\n     *\n     * @param   {DOMFragment} frag - Element or DocumentFragment to be translated\n     * @returns {Promise}\n     */\n    translateFragment(frag) {\n        return this.translateElements(this.getTranslatables(frag));\n    }\n    /**\n     * Translate a list of DOM elements asynchronously using this\n     * `DOMLocalization` object.\n     *\n     * Manually trigger the translation (or re-translation) of a list of elements.\n     * Use the `data-l10n-id` and `data-l10n-args` attributes to mark up the DOM\n     * with information about which translations to use.\n     *\n     * Returns a `Promise` that gets resolved once the translation is complete.\n     *\n     * @param   {Array<Element>} elements - List of elements to be translated\n     * @returns {Promise}\n     */\n    async translateElements(elements) {\n        if (!elements.length) {\n            return undefined;\n        }\n        const keys = elements.map(this.getKeysForElement);\n        const translations = await this.formatMessages(keys);\n        return this.applyTranslations(elements, translations);\n    }\n    /**\n     * Applies translations onto elements.\n     *\n     * @param {Array<Element>} elements\n     * @param {Array<Object>}  translations\n     * @private\n     */\n    applyTranslations(elements, translations) {\n        this.pauseObserving();\n        for (let i = 0; i < elements.length; i++) {\n            if (translations[i] !== undefined) {\n                translateElement(elements[i], translations[i]);\n            }\n        }\n        this.resumeObserving();\n    }\n    /**\n     * Collects all translatable child elements of the element.\n     *\n     * @param {Element} element\n     * @returns {Array<Element>}\n     * @private\n     */\n    getTranslatables(element) {\n        const nodes = Array.from(element.querySelectorAll(L10N_ELEMENT_QUERY));\n        if (typeof element.hasAttribute === \"function\" &&\n            element.hasAttribute(L10NID_ATTR_NAME)) {\n            nodes.push(element);\n        }\n        return nodes;\n    }\n    /**\n     * Get the `data-l10n-*` attributes from DOM elements as a two-element\n     * array.\n     *\n     * @param {Element} element\n     * @returns {Object}\n     * @private\n     */\n    getKeysForElement(element) {\n        return {\n            id: element.getAttribute(L10NID_ATTR_NAME),\n            args: JSON.parse(element.getAttribute(L10NARGS_ATTR_NAME) || null),\n        };\n    }\n}\n","export { default as DOMLocalization } from \"./dom_localization.js\";\nexport { default as Localization } from \"./localization.js\";\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/* globals process */\n\n// NW.js / Electron is a browser context, but copies some Node.js objects; see\n// http://docs.nwjs.io/en/latest/For%20Users/Advanced/JavaScript%20Contexts%20in%20NW.js/#access-nodejs-and-nwjs-api-in-browser-context\n// https://www.electronjs.org/docs/api/process#processversionselectron-readonly\n// https://www.electronjs.org/docs/api/process#processtype-readonly\nconst isNodeJS =\n  (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"GENERIC\")) &&\n  typeof process === \"object\" &&\n  process + \"\" === \"[object process]\" &&\n  !process.versions.nw &&\n  !(process.versions.electron && process.type && process.type !== \"browser\");\n\nconst IDENTITY_MATRIX = [1, 0, 0, 1, 0, 0];\nconst FONT_IDENTITY_MATRIX = [0.001, 0, 0, 0.001, 0, 0];\n\nconst MAX_IMAGE_SIZE_TO_CACHE = 10e6; // Ten megabytes.\n\n// Represent the percentage of the height of a single-line field over\n// the font size. Acrobat seems to use this value.\nconst LINE_FACTOR = 1.35;\nconst LINE_DESCENT_FACTOR = 0.35;\nconst BASELINE_FACTOR = LINE_DESCENT_FACTOR / LINE_FACTOR;\n\n/**\n * Refer to the `WorkerTransport.getRenderingIntent`-method in the API, to see\n * how these flags are being used:\n *  - ANY, DISPLAY, and PRINT are the normal rendering intents, note the\n *    `PDFPageProxy.{render, getOperatorList, getAnnotations}`-methods.\n *  - ANNOTATIONS_FORMS, ANNOTATIONS_STORAGE, ANNOTATIONS_DISABLE control which\n *    annotations are rendered onto the canvas (i.e. by being included in the\n *    operatorList), note the `PDFPageProxy.{render, getOperatorList}`-methods\n *    and their `annotationMode`-option.\n *  - OPLIST is used with the `PDFPageProxy.getOperatorList`-method, note the\n *    `OperatorList`-constructor (on the worker-thread).\n */\nconst RenderingIntentFlag = {\n  ANY: 0x01,\n  DISPLAY: 0x02,\n  PRINT: 0x04,\n  SAVE: 0x08,\n  ANNOTATIONS_FORMS: 0x10,\n  ANNOTATIONS_STORAGE: 0x20,\n  ANNOTATIONS_DISABLE: 0x40,\n  OPLIST: 0x100,\n};\n\nconst AnnotationMode = {\n  DISABLE: 0,\n  ENABLE: 1,\n  ENABLE_FORMS: 2,\n  ENABLE_STORAGE: 3,\n};\n\nconst AnnotationEditorPrefix = \"pdfjs_internal_editor_\";\n\nconst AnnotationEditorType = {\n  DISABLE: -1,\n  NONE: 0,\n  FREETEXT: 3,\n  HIGHLIGHT: 9,\n  STAMP: 13,\n  INK: 15,\n};\n\nconst AnnotationEditorParamsType = {\n  RESIZE: 1,\n  CREATE: 2,\n  FREETEXT_SIZE: 11,\n  FREETEXT_COLOR: 12,\n  FREETEXT_OPACITY: 13,\n  INK_COLOR: 21,\n  INK_THICKNESS: 22,\n  INK_OPACITY: 23,\n};\n\n// Permission flags from Table 22, Section 7.6.3.2 of the PDF specification.\nconst PermissionFlag = {\n  PRINT: 0x04,\n  MODIFY_CONTENTS: 0x08,\n  COPY: 0x10,\n  MODIFY_ANNOTATIONS: 0x20,\n  FILL_INTERACTIVE_FORMS: 0x100,\n  COPY_FOR_ACCESSIBILITY: 0x200,\n  ASSEMBLE: 0x400,\n  PRINT_HIGH_QUALITY: 0x800,\n};\n\nconst TextRenderingMode = {\n  FILL: 0,\n  STROKE: 1,\n  FILL_STROKE: 2,\n  INVISIBLE: 3,\n  FILL_ADD_TO_PATH: 4,\n  STROKE_ADD_TO_PATH: 5,\n  FILL_STROKE_ADD_TO_PATH: 6,\n  ADD_TO_PATH: 7,\n  FILL_STROKE_MASK: 3,\n  ADD_TO_PATH_FLAG: 4,\n};\n\nconst ImageKind = {\n  GRAYSCALE_1BPP: 1,\n  RGB_24BPP: 2,\n  RGBA_32BPP: 3,\n};\n\nconst AnnotationType = {\n  TEXT: 1,\n  LINK: 2,\n  FREETEXT: 3,\n  LINE: 4,\n  SQUARE: 5,\n  CIRCLE: 6,\n  POLYGON: 7,\n  POLYLINE: 8,\n  HIGHLIGHT: 9,\n  UNDERLINE: 10,\n  SQUIGGLY: 11,\n  STRIKEOUT: 12,\n  STAMP: 13,\n  CARET: 14,\n  INK: 15,\n  POPUP: 16,\n  FILEATTACHMENT: 17,\n  SOUND: 18,\n  MOVIE: 19,\n  WIDGET: 20,\n  SCREEN: 21,\n  PRINTERMARK: 22,\n  TRAPNET: 23,\n  WATERMARK: 24,\n  THREED: 25,\n  REDACT: 26,\n};\n\nconst AnnotationReplyType = {\n  GROUP: \"Group\",\n  REPLY: \"R\",\n};\n\nconst AnnotationFlag = {\n  INVISIBLE: 0x01,\n  HIDDEN: 0x02,\n  PRINT: 0x04,\n  NOZOOM: 0x08,\n  NOROTATE: 0x10,\n  NOVIEW: 0x20,\n  READONLY: 0x40,\n  LOCKED: 0x80,\n  TOGGLENOVIEW: 0x100,\n  LOCKEDCONTENTS: 0x200,\n};\n\nconst AnnotationFieldFlag = {\n  READONLY: 0x0000001,\n  REQUIRED: 0x0000002,\n  NOEXPORT: 0x0000004,\n  MULTILINE: 0x0001000,\n  PASSWORD: 0x0002000,\n  NOTOGGLETOOFF: 0x0004000,\n  RADIO: 0x0008000,\n  PUSHBUTTON: 0x0010000,\n  COMBO: 0x0020000,\n  EDIT: 0x0040000,\n  SORT: 0x0080000,\n  FILESELECT: 0x0100000,\n  MULTISELECT: 0x0200000,\n  DONOTSPELLCHECK: 0x0400000,\n  DONOTSCROLL: 0x0800000,\n  COMB: 0x1000000,\n  RICHTEXT: 0x2000000,\n  RADIOSINUNISON: 0x2000000,\n  COMMITONSELCHANGE: 0x4000000,\n};\n\nconst AnnotationBorderStyleType = {\n  SOLID: 1,\n  DASHED: 2,\n  BEVELED: 3,\n  INSET: 4,\n  UNDERLINE: 5,\n};\n\nconst AnnotationActionEventType = {\n  E: \"Mouse Enter\",\n  X: \"Mouse Exit\",\n  D: \"Mouse Down\",\n  U: \"Mouse Up\",\n  Fo: \"Focus\",\n  Bl: \"Blur\",\n  PO: \"PageOpen\",\n  PC: \"PageClose\",\n  PV: \"PageVisible\",\n  PI: \"PageInvisible\",\n  K: \"Keystroke\",\n  F: \"Format\",\n  V: \"Validate\",\n  C: \"Calculate\",\n};\n\nconst DocumentActionEventType = {\n  WC: \"WillClose\",\n  WS: \"WillSave\",\n  DS: \"DidSave\",\n  WP: \"WillPrint\",\n  DP: \"DidPrint\",\n};\n\nconst PageActionEventType = {\n  O: \"PageOpen\",\n  C: \"PageClose\",\n};\n\nconst VerbosityLevel = {\n  ERRORS: 0,\n  WARNINGS: 1,\n  INFOS: 5,\n};\n\nconst CMapCompressionType = {\n  NONE: 0,\n  BINARY: 1,\n};\n\n// All the possible operations for an operator list.\nconst OPS = {\n  // Intentionally start from 1 so it is easy to spot bad operators that will be\n  // 0's.\n  // PLEASE NOTE: We purposely keep any removed operators commented out, since\n  //              re-numbering the list would risk breaking third-party users.\n  dependency: 1,\n  setLineWidth: 2,\n  setLineCap: 3,\n  setLineJoin: 4,\n  setMiterLimit: 5,\n  setDash: 6,\n  setRenderingIntent: 7,\n  setFlatness: 8,\n  setGState: 9,\n  save: 10,\n  restore: 11,\n  transform: 12,\n  moveTo: 13,\n  lineTo: 14,\n  curveTo: 15,\n  curveTo2: 16,\n  curveTo3: 17,\n  closePath: 18,\n  rectangle: 19,\n  stroke: 20,\n  closeStroke: 21,\n  fill: 22,\n  eoFill: 23,\n  fillStroke: 24,\n  eoFillStroke: 25,\n  closeFillStroke: 26,\n  closeEOFillStroke: 27,\n  endPath: 28,\n  clip: 29,\n  eoClip: 30,\n  beginText: 31,\n  endText: 32,\n  setCharSpacing: 33,\n  setWordSpacing: 34,\n  setHScale: 35,\n  setLeading: 36,\n  setFont: 37,\n  setTextRenderingMode: 38,\n  setTextRise: 39,\n  moveText: 40,\n  setLeadingMoveText: 41,\n  setTextMatrix: 42,\n  nextLine: 43,\n  showText: 44,\n  showSpacedText: 45,\n  nextLineShowText: 46,\n  nextLineSetSpacingShowText: 47,\n  setCharWidth: 48,\n  setCharWidthAndBounds: 49,\n  setStrokeColorSpace: 50,\n  setFillColorSpace: 51,\n  setStrokeColor: 52,\n  setStrokeColorN: 53,\n  setFillColor: 54,\n  setFillColorN: 55,\n  setStrokeGray: 56,\n  setFillGray: 57,\n  setStrokeRGBColor: 58,\n  setFillRGBColor: 59,\n  setStrokeCMYKColor: 60,\n  setFillCMYKColor: 61,\n  shadingFill: 62,\n  beginInlineImage: 63,\n  beginImageData: 64,\n  endInlineImage: 65,\n  paintXObject: 66,\n  markPoint: 67,\n  markPointProps: 68,\n  beginMarkedContent: 69,\n  beginMarkedContentProps: 70,\n  endMarkedContent: 71,\n  beginCompat: 72,\n  endCompat: 73,\n  paintFormXObjectBegin: 74,\n  paintFormXObjectEnd: 75,\n  beginGroup: 76,\n  endGroup: 77,\n  // beginAnnotations: 78,\n  // endAnnotations: 79,\n  beginAnnotation: 80,\n  endAnnotation: 81,\n  // paintJpegXObject: 82,\n  paintImageMaskXObject: 83,\n  paintImageMaskXObjectGroup: 84,\n  paintImageXObject: 85,\n  paintInlineImageXObject: 86,\n  paintInlineImageXObjectGroup: 87,\n  paintImageXObjectRepeat: 88,\n  paintImageMaskXObjectRepeat: 89,\n  paintSolidColorImageMask: 90,\n  constructPath: 91,\n};\n\nconst PasswordResponses = {\n  NEED_PASSWORD: 1,\n  INCORRECT_PASSWORD: 2,\n};\n\nlet verbosity = VerbosityLevel.WARNINGS;\n\nfunction setVerbosityLevel(level) {\n  if (Number.isInteger(level)) {\n    verbosity = level;\n  }\n}\n\nfunction getVerbosityLevel() {\n  return verbosity;\n}\n\n// A notice for devs. These are good for things that are helpful to devs, such\n// as warning that Workers were disabled, which is important to devs but not\n// end users.\nfunction info(msg) {\n  if (verbosity >= VerbosityLevel.INFOS) {\n    if (typeof WorkerGlobalScope !== \"undefined\" && self instanceof WorkerGlobalScope) { // #804 ngx-extended-pdf-viewer\n      console.log(`Info: ${msg}`);\n    } else if (Window && globalThis.ngxConsole) { // #804 ngx-extended-pdf-viewer\n      globalThis.ngxConsole.log(`Info: ${msg}`); // #804 ngx-extended-pdf-viewer\n    } else {\n      console.log(`Info: ${msg}`);\n    }\n  }\n}\n\n// Non-fatal warnings.\nfunction warn(msg) {\n  if (verbosity >= VerbosityLevel.WARNINGS) {\n    if (typeof WorkerGlobalScope !== \"undefined\" && self instanceof WorkerGlobalScope) { // #804 ngx-extended-pdf-viewer\n      console.log(`Warning: ${msg}`);\n    } else if (Window && globalThis.ngxConsole) { // #804 ngx-extended-pdf-viewer\n      globalThis.ngxConsole.log(`Warning: ${msg}`); // #804 ngx-extended-pdf-viewer\n    } else {\n      console.log(`Warning: ${msg}`);\n    }\n  }\n}\n\nfunction unreachable(msg) {\n  throw new Error(msg);\n}\n\nfunction assert(cond, msg) {\n  if (!cond) {\n    unreachable(msg);\n  }\n}\n\n// Checks if URLs use one of the allowed protocols, e.g. to avoid XSS.\nfunction _isValidProtocol(url) {\n  switch (url?.protocol) {\n    case \"http:\":\n    case \"https:\":\n    case \"ftp:\":\n    case \"mailto:\":\n    case \"tel:\":\n    case \"capacitor\": // modified by ngx-extended-pdf-viewer #864\n      return true;\n    default:\n      return false;\n  }\n}\n\n/**\n * Attempts to create a valid absolute URL.\n *\n * @param {URL|string} url - An absolute, or relative, URL.\n * @param {URL|string} [baseUrl] - An absolute URL.\n * @param {Object} [options]\n * @returns Either a valid {URL}, or `null` otherwise.\n */\nfunction createValidAbsoluteUrl(url, baseUrl = null, options = null) {\n  if (!url) {\n    return null;\n  }\n  try {\n    if (options && typeof url === \"string\") {\n      // Let URLs beginning with \"www.\" default to using the \"http://\" protocol.\n      if (options.addDefaultProtocol && url.startsWith(\"www.\")) {\n        const dots = url.match(/\\./g);\n        // Avoid accidentally matching a *relative* URL pointing to a file named\n        // e.g. \"www.pdf\" or similar.\n        if (dots?.length >= 2) {\n          url = `http://${url}`;\n        }\n      }\n\n      // According to ISO 32000-1:2008, section 12.6.4.7, URIs should be encoded\n      // in 7-bit ASCII. Some bad PDFs use UTF-8 encoding; see bug 1122280.\n      if (options.tryConvertEncoding) {\n        try {\n          url = stringToUTF8String(url);\n        } catch {}\n      }\n    }\n\n    const absoluteUrl = baseUrl ? new URL(url, baseUrl) : new URL(url);\n    if (_isValidProtocol(absoluteUrl)) {\n      return absoluteUrl;\n    }\n  } catch {\n    /* `new URL()` will throw on incorrect data. */\n  }\n  return null;\n}\n\nfunction shadow(obj, prop, value, nonSerializable = false) {\n  if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"TESTING\")) {\n    assert(\n      prop in obj,\n      `shadow: Property \"${prop && prop.toString()}\" not found in object.`\n    );\n  }\n  Object.defineProperty(obj, prop, {\n    value,\n    enumerable: !nonSerializable,\n    configurable: true,\n    writable: false,\n  });\n  return value;\n}\n\n/**\n * @type {any}\n */\nconst BaseException = (function BaseExceptionClosure() {\n  // eslint-disable-next-line no-shadow\n  function BaseException(message, name) {\n    if (this.constructor === BaseException) {\n      unreachable(\"Cannot initialize BaseException.\");\n    }\n    this.message = message;\n    this.name = name;\n  }\n  BaseException.prototype = new Error();\n  BaseException.constructor = BaseException;\n\n  return BaseException;\n})();\n\nclass PasswordException extends BaseException {\n  constructor(msg, code) {\n    super(msg, \"PasswordException\");\n    this.code = code;\n  }\n}\n\nclass UnknownErrorException extends BaseException {\n  constructor(msg, details) {\n    super(msg, \"UnknownErrorException\");\n    this.details = details;\n  }\n}\n\nclass InvalidPDFException extends BaseException {\n  constructor(msg) {\n    super(msg, \"InvalidPDFException\");\n  }\n}\n\nclass MissingPDFException extends BaseException {\n  constructor(msg) {\n    super(msg, \"MissingPDFException\");\n  }\n}\n\nclass UnexpectedResponseException extends BaseException {\n  constructor(msg, status) {\n    super(msg, \"UnexpectedResponseException\");\n    this.status = status;\n  }\n}\n\n/**\n * Error caused during parsing PDF data.\n */\nclass FormatError extends BaseException {\n  constructor(msg) {\n    super(msg, \"FormatError\");\n  }\n}\n\n/**\n * Error used to indicate task cancellation.\n */\nclass AbortException extends BaseException {\n  constructor(msg) {\n    super(msg, \"AbortException\");\n  }\n}\n\nfunction bytesToString(bytes) {\n  if (typeof bytes !== \"object\" || bytes?.length === undefined) {\n    unreachable(\"Invalid argument for bytesToString\");\n  }\n  const length = bytes.length;\n  const MAX_ARGUMENT_COUNT = 8192;\n  if (length < MAX_ARGUMENT_COUNT) {\n    return String.fromCharCode.apply(null, bytes);\n  }\n  const strBuf = [];\n  for (let i = 0; i < length; i += MAX_ARGUMENT_COUNT) {\n    const chunkEnd = Math.min(i + MAX_ARGUMENT_COUNT, length);\n    const chunk = bytes.subarray(i, chunkEnd);\n    strBuf.push(String.fromCharCode.apply(null, chunk));\n  }\n  return strBuf.join(\"\");\n}\n\nfunction stringToBytes(str) {\n  if (typeof str !== \"string\") {\n    unreachable(\"Invalid argument for stringToBytes\");\n  }\n  const length = str.length;\n  const bytes = new Uint8Array(length);\n  for (let i = 0; i < length; ++i) {\n    bytes[i] = str.charCodeAt(i) & 0xff;\n  }\n  return bytes;\n}\n\nfunction string32(value) {\n  if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"TESTING\")) {\n    assert(\n      typeof value === \"number\" && Math.abs(value) < 2 ** 32,\n      `string32: Unexpected input \"${value}\".`\n    );\n  }\n  return String.fromCharCode(\n    (value >> 24) & 0xff,\n    (value >> 16) & 0xff,\n    (value >> 8) & 0xff,\n    value & 0xff\n  );\n}\n\nfunction objectSize(obj) {\n  return Object.keys(obj).length;\n}\n\n// Ensure that the returned Object has a `null` prototype; hence why\n// `Object.fromEntries(...)` is not used.\nfunction objectFromMap(map) {\n  const obj = Object.create(null);\n  for (const [key, value] of map) {\n    obj[key] = value;\n  }\n  return obj;\n}\n\n// Checks the endianness of the platform.\nfunction isLittleEndian() {\n  const buffer8 = new Uint8Array(4);\n  buffer8[0] = 1;\n  const view32 = new Uint32Array(buffer8.buffer, 0, 1);\n  return view32[0] === 1;\n}\n\n// Checks if it's possible to eval JS expressions.\nfunction isEvalSupported() {\n  try {\n    new Function(\"\"); // eslint-disable-line no-new, no-new-func\n    return true;\n  } catch {\n    return false;\n  }\n}\n\nclass FeatureTest {\n  static get isLittleEndian() {\n    return shadow(this, \"isLittleEndian\", isLittleEndian());\n  }\n\n  static get isEvalSupported() {\n    return shadow(this, \"isEvalSupported\", isEvalSupported());\n  }\n\n  static get isOffscreenCanvasSupported() {\n    return shadow(\n      this,\n      \"isOffscreenCanvasSupported\",\n      typeof OffscreenCanvas !== \"undefined\"\n    );\n  }\n\n  static get platform() {\n    if (\n      (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) ||\n      (typeof navigator !== \"undefined\" &&\n        typeof navigator?.platform === \"string\")\n    ) {\n      return shadow(this, \"platform\", {\n        isMac: navigator.platform.includes(\"Mac\"),\n      });\n    }\n    return shadow(this, \"platform\", { isMac: false });\n  }\n\n  static get isCSSRoundSupported() {\n    return shadow(\n      this,\n      \"isCSSRoundSupported\",\n      globalThis.CSS?.supports?.(\"width: round(1.5px, 1px)\")\n    );\n  }\n}\n\nconst hexNumbers = [...Array(256).keys()].map(n =>\n  n.toString(16).padStart(2, \"0\")\n);\n\nclass Util {\n  static makeHexColor(r, g, b) {\n    return `#${hexNumbers[r]}${hexNumbers[g]}${hexNumbers[b]}`;\n  }\n\n  // Apply a scaling matrix to some min/max values.\n  // If a scaling factor is negative then min and max must be\n  // swaped.\n  static scaleMinMax(transform, minMax) {\n    let temp;\n    if (transform[0]) {\n      if (transform[0] < 0) {\n        temp = minMax[0];\n        minMax[0] = minMax[1];\n        minMax[1] = temp;\n      }\n      minMax[0] *= transform[0];\n      minMax[1] *= transform[0];\n\n      if (transform[3] < 0) {\n        temp = minMax[2];\n        minMax[2] = minMax[3];\n        minMax[3] = temp;\n      }\n      minMax[2] *= transform[3];\n      minMax[3] *= transform[3];\n    } else {\n      temp = minMax[0];\n      minMax[0] = minMax[2];\n      minMax[2] = temp;\n      temp = minMax[1];\n      minMax[1] = minMax[3];\n      minMax[3] = temp;\n\n      if (transform[1] < 0) {\n        temp = minMax[2];\n        minMax[2] = minMax[3];\n        minMax[3] = temp;\n      }\n      minMax[2] *= transform[1];\n      minMax[3] *= transform[1];\n\n      if (transform[2] < 0) {\n        temp = minMax[0];\n        minMax[0] = minMax[1];\n        minMax[1] = temp;\n      }\n      minMax[0] *= transform[2];\n      minMax[1] *= transform[2];\n    }\n    minMax[0] += transform[4];\n    minMax[1] += transform[4];\n    minMax[2] += transform[5];\n    minMax[3] += transform[5];\n  }\n\n  // Concatenates two transformation matrices together and returns the result.\n  static transform(m1, m2) {\n    return [\n      m1[0] * m2[0] + m1[2] * m2[1],\n      m1[1] * m2[0] + m1[3] * m2[1],\n      m1[0] * m2[2] + m1[2] * m2[3],\n      m1[1] * m2[2] + m1[3] * m2[3],\n      m1[0] * m2[4] + m1[2] * m2[5] + m1[4],\n      m1[1] * m2[4] + m1[3] * m2[5] + m1[5],\n    ];\n  }\n\n  // For 2d affine transforms\n  static applyTransform(p, m) {\n    const xt = p[0] * m[0] + p[1] * m[2] + m[4];\n    const yt = p[0] * m[1] + p[1] * m[3] + m[5];\n    return [xt, yt];\n  }\n\n  static applyInverseTransform(p, m) {\n    const d = m[0] * m[3] - m[1] * m[2];\n    const xt = (p[0] * m[3] - p[1] * m[2] + m[2] * m[5] - m[4] * m[3]) / d;\n    const yt = (-p[0] * m[1] + p[1] * m[0] + m[4] * m[1] - m[5] * m[0]) / d;\n    return [xt, yt];\n  }\n\n  // Applies the transform to the rectangle and finds the minimum axially\n  // aligned bounding box.\n  static getAxialAlignedBoundingBox(r, m) {\n    const p1 = this.applyTransform(r, m);\n    const p2 = this.applyTransform(r.slice(2, 4), m);\n    const p3 = this.applyTransform([r[0], r[3]], m);\n    const p4 = this.applyTransform([r[2], r[1]], m);\n    return [\n      Math.min(p1[0], p2[0], p3[0], p4[0]),\n      Math.min(p1[1], p2[1], p3[1], p4[1]),\n      Math.max(p1[0], p2[0], p3[0], p4[0]),\n      Math.max(p1[1], p2[1], p3[1], p4[1]),\n    ];\n  }\n\n  static inverseTransform(m) {\n    const d = m[0] * m[3] - m[1] * m[2];\n    return [\n      m[3] / d,\n      -m[1] / d,\n      -m[2] / d,\n      m[0] / d,\n      (m[2] * m[5] - m[4] * m[3]) / d,\n      (m[4] * m[1] - m[5] * m[0]) / d,\n    ];\n  }\n\n  // This calculation uses Singular Value Decomposition.\n  // The SVD can be represented with formula A = USV. We are interested in the\n  // matrix S here because it represents the scale values.\n  static singularValueDecompose2dScale(m) {\n    const transpose = [m[0], m[2], m[1], m[3]];\n\n    // Multiply matrix m with its transpose.\n    const a = m[0] * transpose[0] + m[1] * transpose[2];\n    const b = m[0] * transpose[1] + m[1] * transpose[3];\n    const c = m[2] * transpose[0] + m[3] * transpose[2];\n    const d = m[2] * transpose[1] + m[3] * transpose[3];\n\n    // Solve the second degree polynomial to get roots.\n    const first = (a + d) / 2;\n    const second = Math.sqrt((a + d) ** 2 - 4 * (a * d - c * b)) / 2;\n    const sx = first + second || 1;\n    const sy = first - second || 1;\n\n    // Scale values are the square roots of the eigenvalues.\n    return [Math.sqrt(sx), Math.sqrt(sy)];\n  }\n\n  // Normalize rectangle rect=[x1, y1, x2, y2] so that (x1,y1) < (x2,y2)\n  // For coordinate systems whose origin lies in the bottom-left, this\n  // means normalization to (BL,TR) ordering. For systems with origin in the\n  // top-left, this means (TL,BR) ordering.\n  static normalizeRect(rect) {\n    const r = rect.slice(0); // clone rect\n    if (rect[0] > rect[2]) {\n      r[0] = rect[2];\n      r[2] = rect[0];\n    }\n    if (rect[1] > rect[3]) {\n      r[1] = rect[3];\n      r[3] = rect[1];\n    }\n    return r;\n  }\n\n  // Returns a rectangle [x1, y1, x2, y2] corresponding to the\n  // intersection of rect1 and rect2. If no intersection, returns 'null'\n  // The rectangle coordinates of rect1, rect2 should be [x1, y1, x2, y2]\n  static intersect(rect1, rect2) {\n    const xLow = Math.max(\n      Math.min(rect1[0], rect1[2]),\n      Math.min(rect2[0], rect2[2])\n    );\n    const xHigh = Math.min(\n      Math.max(rect1[0], rect1[2]),\n      Math.max(rect2[0], rect2[2])\n    );\n    if (xLow > xHigh) {\n      return null;\n    }\n    const yLow = Math.max(\n      Math.min(rect1[1], rect1[3]),\n      Math.min(rect2[1], rect2[3])\n    );\n    const yHigh = Math.min(\n      Math.max(rect1[1], rect1[3]),\n      Math.max(rect2[1], rect2[3])\n    );\n    if (yLow > yHigh) {\n      return null;\n    }\n\n    return [xLow, yLow, xHigh, yHigh];\n  }\n\n  // From https://github.com/adobe-webplatform/Snap.svg/blob/b365287722a72526000ac4bfcf0ce4cac2faa015/src/path.js#L852\n  static bezierBoundingBox(x0, y0, x1, y1, x2, y2, x3, y3) {\n    const tvalues = [],\n      bounds = [[], []];\n    let a, b, c, t, t1, t2, b2ac, sqrtb2ac;\n    for (let i = 0; i < 2; ++i) {\n      if (i === 0) {\n        b = 6 * x0 - 12 * x1 + 6 * x2;\n        a = -3 * x0 + 9 * x1 - 9 * x2 + 3 * x3;\n        c = 3 * x1 - 3 * x0;\n      } else {\n        b = 6 * y0 - 12 * y1 + 6 * y2;\n        a = -3 * y0 + 9 * y1 - 9 * y2 + 3 * y3;\n        c = 3 * y1 - 3 * y0;\n      }\n      if (Math.abs(a) < 1e-12) {\n        if (Math.abs(b) < 1e-12) {\n          continue;\n        }\n        t = -c / b;\n        if (0 < t && t < 1) {\n          tvalues.push(t);\n        }\n        continue;\n      }\n      b2ac = b * b - 4 * c * a;\n      sqrtb2ac = Math.sqrt(b2ac);\n      if (b2ac < 0) {\n        continue;\n      }\n      t1 = (-b + sqrtb2ac) / (2 * a);\n      if (0 < t1 && t1 < 1) {\n        tvalues.push(t1);\n      }\n      t2 = (-b - sqrtb2ac) / (2 * a);\n      if (0 < t2 && t2 < 1) {\n        tvalues.push(t2);\n      }\n    }\n\n    let j = tvalues.length,\n      mt;\n    const jlen = j;\n    while (j--) {\n      t = tvalues[j];\n      mt = 1 - t;\n      bounds[0][j] =\n        mt * mt * mt * x0 +\n        3 * mt * mt * t * x1 +\n        3 * mt * t * t * x2 +\n        t * t * t * x3;\n      bounds[1][j] =\n        mt * mt * mt * y0 +\n        3 * mt * mt * t * y1 +\n        3 * mt * t * t * y2 +\n        t * t * t * y3;\n    }\n\n    bounds[0][jlen] = x0;\n    bounds[1][jlen] = y0;\n    bounds[0][jlen + 1] = x3;\n    bounds[1][jlen + 1] = y3;\n    bounds[0].length = bounds[1].length = jlen + 2;\n\n    return [\n      Math.min(...bounds[0]),\n      Math.min(...bounds[1]),\n      Math.max(...bounds[0]),\n      Math.max(...bounds[1]),\n    ];\n  }\n}\n\nconst PDFStringTranslateTable = [\n  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0x2d8,\n  0x2c7, 0x2c6, 0x2d9, 0x2dd, 0x2db, 0x2da, 0x2dc, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n  0, 0, 0, 0, 0, 0, 0, 0, 0x2022, 0x2020, 0x2021, 0x2026, 0x2014, 0x2013, 0x192,\n  0x2044, 0x2039, 0x203a, 0x2212, 0x2030, 0x201e, 0x201c, 0x201d, 0x2018,\n  0x2019, 0x201a, 0x2122, 0xfb01, 0xfb02, 0x141, 0x152, 0x160, 0x178, 0x17d,\n  0x131, 0x142, 0x153, 0x161, 0x17e, 0, 0x20ac,\n];\n\nfunction stringToPDFString(str) {\n  // See section 7.9.2.2 Text String Type.\n  // The string can contain some language codes bracketed with 0x0b,\n  // so we must remove them.\n  if (str[0] >= \"\\xEF\") {\n    let encoding;\n    if (str[0] === \"\\xFE\" && str[1] === \"\\xFF\") {\n      encoding = \"utf-16be\";\n      if (str.length % 2 === 1) {\n        str = str.slice(0, -1);\n      }\n    } else if (str[0] === \"\\xFF\" && str[1] === \"\\xFE\") {\n      encoding = \"utf-16le\";\n      if (str.length % 2 === 1) {\n        str = str.slice(0, -1);\n      }\n    } else if (str[0] === \"\\xEF\" && str[1] === \"\\xBB\" && str[2] === \"\\xBF\") {\n      encoding = \"utf-8\";\n    }\n\n    if (encoding) {\n      try {\n        const decoder = new TextDecoder(encoding, { fatal: true });\n        const buffer = stringToBytes(str);\n        const decoded = decoder.decode(buffer);\n        if (!decoded.includes(\"\\x1b\")) {\n          return decoded;\n        }\n        return decoded.replaceAll(/\\x1b[^\\x1b]*(?:\\x1b|$)/g, \"\");\n      } catch (ex) {\n        warn(`stringToPDFString: \"${ex}\".`);\n      }\n    }\n  }\n  // ISO Latin 1\n  const strBuf = [];\n  for (let i = 0, ii = str.length; i < ii; i++) {\n    const charCode = str.charCodeAt(i);\n    if (charCode === 0x1b) {\n      // eslint-disable-next-line no-empty\n      while (++i < ii && str.charCodeAt(i) !== 0x1b) {}\n      continue;\n    }\n    const code = PDFStringTranslateTable[charCode];\n    strBuf.push(code ? String.fromCharCode(code) : str.charAt(i));\n  }\n  return strBuf.join(\"\");\n}\n\nfunction stringToUTF8String(str) {\n  return decodeURIComponent(escape(str));\n}\n\nfunction utf8StringToString(str) {\n  return unescape(encodeURIComponent(str));\n}\n\nfunction isArrayBuffer(v) {\n  return typeof v === \"object\" && v?.byteLength !== undefined;\n}\n\nfunction isArrayEqual(arr1, arr2) {\n  if (arr1.length !== arr2.length) {\n    return false;\n  }\n  for (let i = 0, ii = arr1.length; i < ii; i++) {\n    if (arr1[i] !== arr2[i]) {\n      return false;\n    }\n  }\n  return true;\n}\n\nfunction getModificationDate(date = new Date()) {\n  const buffer = [\n    date.getUTCFullYear().toString(),\n    (date.getUTCMonth() + 1).toString().padStart(2, \"0\"),\n    date.getUTCDate().toString().padStart(2, \"0\"),\n    date.getUTCHours().toString().padStart(2, \"0\"),\n    date.getUTCMinutes().toString().padStart(2, \"0\"),\n    date.getUTCSeconds().toString().padStart(2, \"0\"),\n  ];\n\n  return buffer.join(\"\");\n}\n\nclass PromiseCapability {\n  #settled = false;\n\n  constructor() {\n    /**\n     * @type {Promise<any>} The Promise object.\n     */\n    this.promise = new Promise((resolve, reject) => {\n      /**\n       * @type {function} Fulfills the Promise.\n       */\n      this.resolve = data => {\n        this.#settled = true;\n        resolve(data);\n      };\n\n      /**\n       * @type {function} Rejects the Promise.\n       */\n      this.reject = reason => {\n        if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"TESTING\")) {\n          assert(reason instanceof Error, 'Expected valid \"reason\" argument.');\n        }\n        this.#settled = true;\n        reject(reason);\n      };\n    });\n  }\n\n  /**\n   * @type {boolean} If the Promise has been fulfilled/rejected.\n   */\n  get settled() {\n    return this.#settled;\n  }\n}\n\nlet NormalizeRegex = null;\nlet NormalizationMap = null;\nfunction normalizeUnicode(str) {\n  if (!NormalizeRegex) {\n    // In order to generate the following regex:\n    //  - create a PDF containing all the chars in the range 0000-FFFF with\n    //    a NFKC which is different of the char.\n    //  - copy and paste all those chars and get the ones where NFKC is\n    //    required.\n    // It appears that most the chars here contain some ligatures.\n    NormalizeRegex =\n      /([\\u00a0\\u00b5\\u037e\\u0eb3\\u2000-\\u200a\\u202f\\u2126\\ufb00-\\ufb04\\ufb06\\ufb20-\\ufb36\\ufb38-\\ufb3c\\ufb3e\\ufb40-\\ufb41\\ufb43-\\ufb44\\ufb46-\\ufba1\\ufba4-\\ufba9\\ufbae-\\ufbb1\\ufbd3-\\ufbdc\\ufbde-\\ufbe7\\ufbea-\\ufbf8\\ufbfc-\\ufbfd\\ufc00-\\ufc5d\\ufc64-\\ufcf1\\ufcf5-\\ufd3d\\ufd88\\ufdf4\\ufdfa-\\ufdfb\\ufe71\\ufe77\\ufe79\\ufe7b\\ufe7d]+)|(\\ufb05+)/gu;\n    NormalizationMap = new Map([[\"\", \"t\"]]);\n  }\n  return str.replaceAll(NormalizeRegex, (_, p1, p2) => {\n    return p1 ? p1.normalize(\"NFKC\") : NormalizationMap.get(p2);\n  });\n}\n\nfunction getUuid() {\n  if (\n    (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) ||\n    (typeof crypto !== \"undefined\" && typeof crypto?.randomUUID === \"function\")\n  ) {\n    return crypto.randomUUID();\n  }\n  const buf = new Uint8Array(32);\n  if (\n    typeof crypto !== \"undefined\" &&\n    typeof crypto?.getRandomValues === \"function\"\n  ) {\n    crypto.getRandomValues(buf);\n  } else {\n    for (let i = 0; i < 32; i++) {\n      buf[i] = Math.floor(Math.random() * 255);\n    }\n  }\n  return bytesToString(buf);\n}\n\nconst AnnotationPrefix = \"pdfjs_internal_id_\";\n\nexport {\n  AbortException,\n  AnnotationActionEventType,\n  AnnotationBorderStyleType,\n  AnnotationEditorParamsType,\n  AnnotationEditorPrefix,\n  AnnotationEditorType,\n  AnnotationFieldFlag,\n  AnnotationFlag,\n  AnnotationMode,\n  AnnotationPrefix,\n  AnnotationReplyType,\n  AnnotationType,\n  assert,\n  BaseException,\n  BASELINE_FACTOR,\n  bytesToString,\n  CMapCompressionType,\n  createValidAbsoluteUrl,\n  DocumentActionEventType,\n  FeatureTest,\n  FONT_IDENTITY_MATRIX,\n  FormatError,\n  getModificationDate,\n  getUuid,\n  getVerbosityLevel,\n  IDENTITY_MATRIX,\n  ImageKind,\n  info,\n  InvalidPDFException,\n  isArrayBuffer,\n  isArrayEqual,\n  isNodeJS,\n  LINE_DESCENT_FACTOR,\n  LINE_FACTOR,\n  MAX_IMAGE_SIZE_TO_CACHE,\n  MissingPDFException,\n  normalizeUnicode,\n  objectFromMap,\n  objectSize,\n  OPS,\n  PageActionEventType,\n  PasswordException,\n  PasswordResponses,\n  PermissionFlag,\n  PromiseCapability,\n  RenderingIntentFlag,\n  setVerbosityLevel,\n  shadow,\n  string32,\n  stringToBytes,\n  stringToPDFString,\n  stringToUTF8String,\n  TextRenderingMode,\n  UnexpectedResponseException,\n  UnknownErrorException,\n  unreachable,\n  utf8StringToString,\n  Util,\n  VerbosityLevel,\n  warn,\n};\n","/* Copyright 2022 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** @typedef {import(\"../src/display/api\").PDFPageProxy} PDFPageProxy */\n// eslint-disable-next-line max-len\n/** @typedef {import(\"../src/display/display_utils\").PageViewport} PageViewport */\n// eslint-disable-next-line max-len\n/** @typedef {import(\"../src/display/editor/tools.js\").AnnotationEditorUIManager} AnnotationEditorUIManager */\n// eslint-disable-next-line max-len\n/** @typedef {import(\"./text_accessibility.js\").TextAccessibilityManager} TextAccessibilityManager */\n/** @typedef {import(\"./interfaces\").IL10n} IL10n */\n// eslint-disable-next-line max-len\n/** @typedef {import(\"../src/display/annotation_layer.js\").AnnotationLayer} AnnotationLayer */\n\nimport { AnnotationEditorLayer } from \"pdfjs-lib\";\nimport { NullL10n } from \"web-l10n_utils\";\n\n/**\n * @typedef {Object} AnnotationEditorLayerBuilderOptions\n * @property {AnnotationEditorUIManager} [uiManager]\n * @property {HTMLDivElement} pageDiv\n * @property {PDFPageProxy} pdfPage\n * @property {IL10n} [l10n]\n * @property {TextAccessibilityManager} [accessibilityManager]\n * @property {AnnotationLayer} [annotationLayer]\n */\n\nclass AnnotationEditorLayerBuilder {\n  #annotationLayer = null;\n\n  #uiManager;\n\n  /**\n   * @param {AnnotationEditorLayerBuilderOptions} options\n   */\n  constructor(options) {\n    this.pageDiv = options.pageDiv;\n    this.pdfPage = options.pdfPage;\n    this.accessibilityManager = options.accessibilityManager;\n    this.l10n = options.l10n || NullL10n;\n    this.annotationEditorLayer = null;\n    this.div = null;\n    this._cancelled = false;\n    this.#uiManager = options.uiManager;\n    this.#annotationLayer = options.annotationLayer || null;\n  }\n\n  /**\n   * @param {PageViewport} viewport\n   * @param {string} intent (default value is 'display')\n   */\n  async render(viewport, intent = \"display\") {\n    if (intent !== \"display\") {\n      return;\n    }\n\n    if (this._cancelled) {\n      return;\n    }\n\n    const clonedViewport = viewport.clone({ dontFlip: true });\n    if (this.div) {\n      this.annotationEditorLayer.update({ viewport: clonedViewport });\n      this.show();\n      return;\n    }\n\n    // Create an AnnotationEditor layer div\n    const div = (this.div = document.createElement(\"div\"));\n    div.className = \"annotationEditorLayer\";\n    div.tabIndex = 0;\n    div.hidden = true;\n    div.dir = this.#uiManager.direction;\n    this.pageDiv.append(div);\n\n    this.annotationEditorLayer = new AnnotationEditorLayer({\n      uiManager: this.#uiManager,\n      div,\n      accessibilityManager: this.accessibilityManager,\n      pageIndex: this.pdfPage.pageNumber - 1,\n      l10n: this.l10n,\n      viewport: clonedViewport,\n      annotationLayer: this.#annotationLayer,\n    });\n\n    const parameters = {\n      viewport: clonedViewport,\n      div,\n      annotations: null,\n      intent,\n    };\n\n    this.annotationEditorLayer.render(parameters);\n    this.show();\n  }\n\n  cancel() {\n    this._cancelled = true;\n\n    if (!this.div) {\n      return;\n    }\n    this.pageDiv = null;\n    this.annotationEditorLayer.destroy();\n    this.div.remove();\n  }\n\n  hide() {\n    if (!this.div) {\n      return;\n    }\n    this.div.hidden = true;\n  }\n\n  show() {\n    if (!this.div || this.annotationEditorLayer.isEmpty) {\n      return;\n    }\n    this.div.hidden = false;\n  }\n}\n\nexport { AnnotationEditorLayerBuilder };\n","/* Copyright 2014 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** @typedef {import(\"../src/display/api\").PDFPageProxy} PDFPageProxy */\n// eslint-disable-next-line max-len\n/** @typedef {import(\"../src/display/display_utils\").PageViewport} PageViewport */\n// eslint-disable-next-line max-len\n/** @typedef {import(\"../src/display/annotation_storage\").AnnotationStorage} AnnotationStorage */\n/** @typedef {import(\"./interfaces\").IDownloadManager} IDownloadManager */\n/** @typedef {import(\"./interfaces\").IPDFLinkService} IPDFLinkService */\n// eslint-disable-next-line max-len\n/** @typedef {import(\"./text_accessibility.js\").TextAccessibilityManager} TextAccessibilityManager */\n\nimport { AnnotationLayer } from \"pdfjs-lib\";\nimport { PresentationModeState } from \"./ui_utils.js\";\n\n/**\n * @typedef {Object} AnnotationLayerBuilderOptions\n * @property {HTMLDivElement} pageDiv\n * @property {PDFPageProxy} pdfPage\n * @property {AnnotationStorage} [annotationStorage]\n * @property {string} [imageResourcesPath] - Path for image resources, mainly\n *   for annotation icons. Include trailing slash.\n * @property {boolean} renderForms\n * @property {IPDFLinkService} linkService\n * @property {IDownloadManager} [downloadManager]\n * @property {boolean} [enableScripting]\n * @property {Promise<boolean>} [hasJSActionsPromise]\n * @property {Promise<Object<string, Array<Object>> | null>}\n *   [fieldObjectsPromise]\n * @property {Map<string, HTMLCanvasElement>} [annotationCanvasMap]\n * @property {TextAccessibilityManager} [accessibilityManager]\n */\n\nclass AnnotationLayerBuilder {\n  #onPresentationModeChanged = null;\n\n  /**\n   * @param {AnnotationLayerBuilderOptions} options\n   */\n  constructor({\n    pageDiv,\n    pdfPage,\n    linkService,\n    downloadManager,\n    annotationStorage = null,\n    imageResourcesPath = \"\",\n    renderForms = true,\n    enableScripting = false,\n    hasJSActionsPromise = null,\n    fieldObjectsPromise = null,\n    annotationCanvasMap = null,\n    accessibilityManager = null,\n  }) {\n    this.pageDiv = pageDiv;\n    this.pdfPage = pdfPage;\n    this.linkService = linkService;\n    this.downloadManager = downloadManager;\n    this.imageResourcesPath = imageResourcesPath;\n    this.renderForms = renderForms;\n    this.annotationStorage = annotationStorage;\n    this.enableScripting = enableScripting;\n    this._hasJSActionsPromise = hasJSActionsPromise || Promise.resolve(false);\n    this._fieldObjectsPromise = fieldObjectsPromise || Promise.resolve(null);\n    this._annotationCanvasMap = annotationCanvasMap;\n    this._accessibilityManager = accessibilityManager;\n\n    this.annotationLayer = null;\n    this.div = null;\n    this._cancelled = false;\n    this._eventBus = linkService.eventBus;\n  }\n\n  /**\n   * @param {PageViewport} viewport\n   * @param {string} intent (default value is 'display')\n   * @returns {Promise<void>} A promise that is resolved when rendering of the\n   *   annotations is complete.\n   */\n  async render(viewport, intent = \"display\") {\n    if (this.div) {\n      if (this._cancelled || !this.annotationLayer) {\n        return;\n      }\n      // If an annotationLayer already exists, refresh its children's\n      // transformation matrices.\n      this.annotationLayer.update({\n        viewport: viewport.clone({ dontFlip: true }),\n      });\n      return;\n    }\n\n    const [annotations, hasJSActions, fieldObjects] = await Promise.all([\n      this.pdfPage.getAnnotations({ intent }),\n      this._hasJSActionsPromise,\n      this._fieldObjectsPromise,\n    ]);\n    if (this._cancelled) {\n      return;\n    }\n\n    // Create an annotation layer div and render the annotations\n    // if there is at least one annotation.\n    const div = (this.div = document.createElement(\"div\"));\n    div.className = \"annotationLayer\";\n    this.pageDiv.append(div);\n\n    if (annotations.length === 0) {\n      this.hide();\n      return;\n    }\n\n    this.annotationLayer = new AnnotationLayer({\n      div,\n      accessibilityManager: this._accessibilityManager,\n      annotationCanvasMap: this._annotationCanvasMap,\n      page: this.pdfPage,\n      viewport: viewport.clone({ dontFlip: true }),\n    });\n\n    await this.annotationLayer.render({\n      annotations,\n      imageResourcesPath: this.imageResourcesPath,\n      renderForms: this.renderForms,\n      linkService: this.linkService,\n      downloadManager: this.downloadManager,\n      annotationStorage: this.annotationStorage,\n      enableScripting: this.enableScripting,\n      hasJSActions,\n      fieldObjects,\n    });\n\n    // Ensure that interactive form elements in the annotationLayer are\n    // disabled while PresentationMode is active (see issue 12232).\n    if (this.linkService.isInPresentationMode) {\n      this.#updatePresentationModeState(PresentationModeState.FULLSCREEN);\n    }\n    if (!this.#onPresentationModeChanged) {\n      this.#onPresentationModeChanged = evt => {\n        this.#updatePresentationModeState(evt.state);\n      };\n      this._eventBus?._on(\n        \"presentationmodechanged\",\n        this.#onPresentationModeChanged\n      );\n    }\n  }\n\n  cancel() {\n    this._cancelled = true;\n\n    if (this.#onPresentationModeChanged) {\n      this._eventBus?._off(\n        \"presentationmodechanged\",\n        this.#onPresentationModeChanged\n      );\n      this.#onPresentationModeChanged = null;\n    }\n  }\n\n  hide() {\n    if (!this.div) {\n      return;\n    }\n    // #1887 modified by ngx-extended-pdf-viewer\n    if (!document.querySelector(\"[data-pdfjsprinting=true]\")) {\n      this.div.hidden = true;\n    }\n  }\n\n  #updatePresentationModeState(state) {\n    if (!this.div) {\n      return;\n    }\n    let disableFormElements = false;\n\n    switch (state) {\n      case PresentationModeState.FULLSCREEN:\n        disableFormElements = true;\n        break;\n      case PresentationModeState.NORMAL:\n        break;\n      default:\n        return;\n    }\n    for (const section of this.div.childNodes) {\n      if (section.hasAttribute(\"data-internal-link\")) {\n        continue;\n      }\n      section.inert = disableFormElements;\n    }\n  }\n}\n\nexport { AnnotationLayerBuilder };\n","/* Copyright 2018 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst compatibilityParams = Object.create(null);\nif (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"GENERIC\")) {\n  if (\n    typeof PDFJSDev !== \"undefined\" &&\n    PDFJSDev.test(\"LIB\") &&\n    typeof navigator === \"undefined\"\n  ) {\n    globalThis.navigator = Object.create(null);\n  }\n  const userAgent = navigator.userAgent || \"\";\n  const platform = navigator.platform || \"\";\n  const maxTouchPoints = navigator.maxTouchPoints || 1;\n\n  const isAndroid = /Android/.test(userAgent);\n  const isIOS =\n    /\\b(iPad|iPhone|iPod)(?=;)/.test(userAgent) ||\n    (platform === \"MacIntel\" && maxTouchPoints > 1);\n\n  // Limit canvas size to 5 mega-pixels on mobile.\n  // Support: Android, iOS\n  (function checkCanvasSizeLimitation() {\n    if (isIOS || isAndroid) {\n      compatibilityParams.maxCanvasPixels = 5242880;\n    }\n  })();\n}\n\nconst OptionKind = {\n  BROWSER: 0x01,\n  VIEWER: 0x02,\n  API: 0x04,\n  WORKER: 0x08,\n  PREFERENCE: 0x80,\n};\n\n/**\n * NOTE: These options are used to generate the `default_preferences.json` file,\n *       see `OptionKind.PREFERENCE`, hence the values below must use only\n *       primitive types and cannot rely on any imported types.\n */\nconst defaultOptions = {\n  canvasMaxAreaInBytes: {\n    /** @type {number} */\n    value: -1,\n    kind: OptionKind.BROWSER + OptionKind.API,\n  },\n  isInAutomation: {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.BROWSER,\n  },\n  supportsDocumentFonts: {\n    /** @type {boolean} */\n    value: true,\n    kind: OptionKind.BROWSER,\n  },\n  supportsIntegratedFind: {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.BROWSER,\n  },\n  supportsMouseWheelZoomCtrlKey: {\n    /** @type {boolean} */\n    value: true,\n    kind: OptionKind.BROWSER,\n  },\n  supportsMouseWheelZoomMetaKey: {\n    /** @type {boolean} */\n    value: true,\n    kind: OptionKind.BROWSER,\n  },\n  supportsPinchToZoom: {\n    /** @type {boolean} */\n    value: true,\n    kind: OptionKind.BROWSER,\n  },\n\n  annotationEditorMode: {\n    /** @type {number} */\n    value: 0,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  annotationMode: {\n    /** @type {number} */\n    value: 2,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  cursorToolOnLoad: {\n    /** @type {number} */\n    value: 0,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  defaultZoomDelay: {\n    /** @type {number} */\n    value: 400,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  defaultZoomValue: {\n    /** @type {string} */\n    value: \"\",\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  disableHistory: {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.VIEWER,\n  },\n  disablePageLabels: {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  enablePermissions: {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  enablePrintAutoRotate: {\n    /** @type {boolean} */\n    value: true,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  enableScripting: {\n    /** @type {boolean} */\n    value: typeof PDFJSDev === \"undefined\" || !PDFJSDev.test(\"CHROME\"),\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  externalLinkRel: {\n    /** @type {string} */\n    value: \"noopener noreferrer nofollow\",\n    kind: OptionKind.VIEWER,\n  },\n  externalLinkTarget: {\n    /** @type {number} */\n    value: 0,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  historyUpdateUrl: {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  ignoreDestinationZoom: {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  imageResourcesPath: {\n    /** @type {string} */\n    value:\n      typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")\n        ? \"resource://pdf.js/web/images/\"\n        : \"./images/\",\n    kind: OptionKind.VIEWER,\n  },\n  maxCanvasPixels: {\n    /** @type {number} */\n    value: 16777216,\n    kind: OptionKind.VIEWER,\n  },\n  forcePageColors: {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  pageColorsBackground: {\n    /** @type {string} */\n    value: \"Canvas\",\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  pageColorsForeground: {\n    /** @type {string} */\n    value: \"CanvasText\",\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  pdfBugEnabled: {\n    /** @type {boolean} */\n    value: typeof PDFJSDev === \"undefined\",\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  printResolution: {\n    /** @type {number} */\n    value: 150,\n    kind: OptionKind.VIEWER,\n  },\n  removePageBorders: {\n    // #194\n    value: false,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  sidebarViewOnLoad: {\n    /** @type {number} */\n    value: -1,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  scrollModeOnLoad: {\n    /** @type {number} */\n    value: -1,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  spreadModeOnLoad: {\n    /** @type {number} */\n    value: -1,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  textLayerMode: {\n    /** @type {number} */\n    value: 1,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  viewOnLoad: {\n    /** @type {boolean} */\n    value: 0,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n\n  cMapPacked: {\n    /** @type {boolean} */\n    value: true,\n    kind: OptionKind.API,\n  },\n  cMapUrl: {\n    /** @type {string} */\n    value:\n      // eslint-disable-next-line no-nested-ternary\n      typeof PDFJSDev === \"undefined\"\n        ? \"../external/bcmaps/\"\n        : PDFJSDev.test(\"MOZCENTRAL\")\n          ? \"resource://pdf.js/web/cmaps/\"\n          : \"../web/cmaps/\",\n    kind: OptionKind.API,\n  },\n  disableAutoFetch: {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.API + OptionKind.PREFERENCE,\n  },\n  disableFontFace: {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.API + OptionKind.PREFERENCE,\n  },\n  disableRange: {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.API + OptionKind.PREFERENCE,\n  },\n  disableStream: {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.API + OptionKind.PREFERENCE,\n  },\n  docBaseUrl: {\n    /** @type {string} */\n    value: \"\",\n    kind: OptionKind.API,\n  },\n  enableXfa: {\n    /** @type {boolean} */\n    value: true,\n    kind: OptionKind.API + OptionKind.PREFERENCE,\n  },\n  fontExtraProperties: {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.API,\n  },\n  isEvalSupported: {\n    /** @type {boolean} */\n    value: true,\n    kind: OptionKind.API,\n  },\n  isOffscreenCanvasSupported: {\n    /** @type {boolean} */\n    value: true,\n    kind: OptionKind.API,\n  },\n  maxImageSize: {\n    /** @type {number} */\n    value: -1,\n    kind: OptionKind.API,\n  },\n  pdfBug: {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.API,\n  },\n  standardFontDataUrl: {\n    /** @type {string} */\n    value:\n      // eslint-disable-next-line no-nested-ternary\n      typeof PDFJSDev === \"undefined\"\n        ? \"../external/standard_fonts/\"\n        : PDFJSDev.test(\"MOZCENTRAL\")\n          ? \"resource://pdf.js/web/standard_fonts/\"\n          : \"../web/standard_fonts/\",\n    kind: OptionKind.API,\n  },\n  verbosity: {\n    /** @type {number} */\n    value: 1,\n    kind: OptionKind.API,\n  },\n\n  workerPort: {\n    /** @type {Object} */\n    value: null,\n    kind: OptionKind.WORKER,\n  },\n  workerSrc: {\n    /** @type {string} */\n    value:\n      // eslint-disable-next-line no-nested-ternary\n      typeof PDFJSDev === \"undefined\"\n        ? \"../src/pdf.worker.js\"\n        : PDFJSDev.test(\"MOZCENTRAL\")\n          ? \"resource://pdf.js/build/pdf.worker.mjs\"\n          : \"./assets/pdf.worker.mjs\",\n    kind: OptionKind.WORKER,\n  },\n};\nif (typeof PDFJSDev === \"undefined\" || !PDFJSDev.test(\"MOZCENTRAL\")) {\n  defaultOptions.viewerCssTheme = {\n    /** @type {number} */\n    value: typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"CHROME\") ? 2 : 0,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  };\n}\nif (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"GENERIC\")) {\n  defaultOptions.defaultUrl = {\n    /** @type {string} */\n    value: \"compressed.tracemonkey-pldi-09.pdf\",\n    kind: OptionKind.VIEWER,\n  };\n  defaultOptions.disablePreferences = {\n    /** @type {boolean} */\n    value: typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"TESTING\"),\n    kind: OptionKind.VIEWER,\n  };\n  defaultOptions.locale = {\n    /** @type {string} */\n    value: navigator.language || \"en-US\",\n    kind: OptionKind.VIEWER,\n  };\n  defaultOptions.sandboxBundleSrc = {\n    /** @type {string} */\n    value:\n      typeof PDFJSDev === \"undefined\"\n        ? \"../build/dev-sandbox/pdf.sandbox.mjs\"\n        : \"../build/pdf.sandbox.mjs\",\n    kind: OptionKind.VIEWER,\n  };\n} else if (PDFJSDev.test(\"CHROME\")) {\n  defaultOptions.defaultUrl = {\n    /** @type {string} */\n    value: \"\",\n    kind: OptionKind.VIEWER,\n  };\n  defaultOptions.disableTelemetry = {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  };\n  defaultOptions.sandboxBundleSrc = {\n    /** @type {string} */\n    value: \"../build/pdf.sandbox.js\",\n    kind: OptionKind.VIEWER,\n  };\n}\n\nconst userOptions = Object.create(null);\n\nif (globalThis.pdfDefaultOptions) {\n  for (const key in globalThis.pdfDefaultOptions) {\n    userOptions[key] = globalThis.pdfDefaultOptions[key];\n  }\n}\n\nclass AppOptions {\n  constructor() {\n    throw new Error(\"Cannot initialize AppOptions.\");\n  }\n\n  static get(name) {\n    const userOption = userOptions[name];\n    if (userOption !== undefined) {\n      return userOption;\n    }\n    const defaultOption = defaultOptions[name];\n    if (defaultOption !== undefined) {\n      return compatibilityParams[name] ?? defaultOption.value;\n    }\n    return undefined;\n  }\n\n  static getAll(kind = null) {\n    const options = Object.create(null);\n    for (const name in defaultOptions) {\n      const defaultOption = defaultOptions[name];\n      if (kind) {\n        if (!(kind & defaultOption.kind)) {\n          continue;\n        }\n        if (\n          (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"LIB\")) &&\n          kind === OptionKind.PREFERENCE\n        ) {\n          if (defaultOption.kind & OptionKind.BROWSER) {\n            throw new Error(`Invalid kind for preference: ${name}`);\n          }\n          const value = defaultOption.value,\n            valueType = typeof value;\n\n          if (\n            valueType === \"boolean\" ||\n            valueType === \"string\" ||\n            (valueType === \"number\" && Number.isInteger(value))\n          ) {\n            options[name] = value;\n            continue;\n          }\n          throw new Error(`Invalid type for preference: ${name}`);\n        }\n      }\n      const userOption = userOptions[name];\n      options[name] =\n        userOption !== undefined\n          ? userOption\n          : compatibilityParams[name] ?? defaultOption.value;\n    }\n    return options;\n  }\n\n  static set(name, value) {\n    userOptions[name] = value;\n  }\n\n  static setAll(options, init = false) {\n    if ((typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"GENERIC\")) && init) {\n      if (this.get(\"disablePreferences\")) {\n        // Give custom implementations of the default viewer a simpler way to\n        // opt-out of having the `Preferences` override existing `AppOptions`.\n        return;\n      }\n      if (Object.keys(userOptions).length) {\n        console.warn(\n          \"setAll: The Preferences may override manually set AppOptions; \" +\n            'please use the \"disablePreferences\"-option in order to prevent that.'\n        );\n      }\n    }\n\n    for (const name in options) {\n      userOptions[name] = options[name];\n    }\n  }\n\n  static remove(name) {\n    delete userOptions[name];\n  }\n}\n\nexport { AppOptions, compatibilityParams, OptionKind };\n","/* Copyright 2013 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** @typedef {import(\"./interfaces\").IDownloadManager} IDownloadManager */\n\nimport { createValidAbsoluteUrl, isPdfFile } from \"pdfjs-lib\";\n\nif (typeof PDFJSDev !== \"undefined\" && !PDFJSDev.test(\"CHROME || GENERIC\")) {\n  throw new Error(\n    'Module \"pdfjs-web/download_manager\" shall not be used ' +\n      \"outside CHROME and GENERIC builds.\"\n  );\n}\n\nfunction download(blobUrl, filename) {\n  const a = document.createElement(\"a\");\n  if (!a.click) {\n    throw new Error('DownloadManager: \"a.click()\" is not supported.');\n  }\n  a.href = blobUrl;\n  a.target = \"_parent\";\n  // Use a.download if available. This increases the likelihood that\n  // the file is downloaded instead of opened by another PDF plugin.\n  if (\"download\" in a) {\n    a.download = filename;\n  }\n  // <a> must be in the document for recent Firefox versions,\n  // otherwise .click() is ignored.\n  (document.body || document.documentElement).append(a);\n  a.click();\n  a.remove();\n}\n\n/**\n * @implements {IDownloadManager}\n */\nclass DownloadManager {\n  #openBlobUrls = new WeakMap();\n\n  downloadUrl(url, filename, _options) {\n    if (!createValidAbsoluteUrl(url, \"http://example.com\")) {\n      globalThis.ngxConsole.error(`downloadUrl - not a valid URL: ${url}`);\n      return; // restricted/invalid URL\n    }\n    download(url + \"#pdfjs.action=download\", filename);\n  }\n\n  downloadData(data, filename, contentType) {\n    const blobUrl = URL.createObjectURL(\n      new Blob([data], { type: contentType })\n    );\n    download(blobUrl, filename);\n  }\n\n  /**\n   * @returns {boolean} Indicating if the data was opened.\n   */\n  openOrDownloadData(data, filename, dest = null) {\n    const isPdfData = isPdfFile(filename);\n    const contentType = isPdfData ? \"application/pdf\" : \"\";\n\n    if (\n      (typeof PDFJSDev === \"undefined\" || !PDFJSDev.test(\"COMPONENTS\")) &&\n      isPdfData\n    ) {\n      let blobUrl = this.#openBlobUrls.get(data);\n      if (!blobUrl) {\n        blobUrl = URL.createObjectURL(new Blob([data], { type: contentType }));\n        this.#openBlobUrls.set(data, blobUrl);\n      }\n      // #1657 modified by ngx-extended-pdf-viewer\n      // The lines below try to open the PDF file in the viewer.\n      // That doesn't work if the viewer is embedded in an Angular application.\n      // Angular tries to take over and doesn't know what to do with the blob.\n      // The solution is to simply open the blob in a new window without\n      // adding anything to the URL.\n      /*\n      let viewerUrl;\n      if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"GENERIC\")) {\n        // The current URL is the viewer, let's use it and append the file.\n        viewerUrl = \"?file=\" + encodeURIComponent(blobUrl + \"#\" + filename);\n      } else if (PDFJSDev.test(\"CHROME\")) {\n        // In the Chrome extension, the URL is rewritten using the history API\n        // in viewer.js, so an absolute URL must be generated.\n        viewerUrl =\n          // eslint-disable-next-line no-undef\n          chrome.runtime.getURL(\"/content/web/viewer.html\") +\n          \"?file=\" +\n          encodeURIComponent(blobUrl + \"#\" + filename);\n      }\n      */\n\n      try {\n        /*\n        window.open(viewerUrl);\n        */\n        window.open(blobUrl);\n        // #1657 end of modification by ngx-extended-pdf-viewer\n        return true;\n      } catch (ex) {\n        globalThis.ngxConsole.error(`openOrDownloadData: ${ex}`);\n        // Release the `blobUrl`, since opening it failed, and fallback to\n        // downloading the PDF file.\n        URL.revokeObjectURL(blobUrl);\n        this.#openBlobUrls.delete(data);\n      }\n    }\n\n    this.downloadData(data, filename, contentType);\n    return false;\n  }\n\n  download(blob, url, filename, _options) {\n    const blobUrl = URL.createObjectURL(blob);\n    download(blobUrl, filename);\n  }\n}\n\nexport { DownloadManager };\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst WaitOnType = {\n  EVENT: \"event\",\n  TIMEOUT: \"timeout\",\n};\n\n/**\n * @typedef {Object} WaitOnEventOrTimeoutParameters\n * @property {Object} target - The event target, can for example be:\n *   `window`, `document`, a DOM element, or an {EventBus} instance.\n * @property {string} name - The name of the event.\n * @property {number} delay - The delay, in milliseconds, after which the\n *   timeout occurs (if the event wasn't already dispatched).\n */\n\n/**\n * Allows waiting for an event or a timeout, whichever occurs first.\n * Can be used to ensure that an action always occurs, even when an event\n * arrives late or not at all.\n *\n * @param {WaitOnEventOrTimeoutParameters}\n * @returns {Promise} A promise that is resolved with a {WaitOnType} value.\n */\nfunction waitOnEventOrTimeout({ target, name, delay = 0 }) {\n  return new Promise(function (resolve, reject) {\n    if (\n      typeof target !== \"object\" ||\n      !(name && typeof name === \"string\") ||\n      !(Number.isInteger(delay) && delay >= 0)\n    ) {\n      throw new Error(\"waitOnEventOrTimeout - invalid parameters.\");\n    }\n\n    function handler(type) {\n      if (target instanceof EventBus) {\n        target._off(name, eventHandler);\n      } else {\n        target.removeEventListener(name, eventHandler);\n      }\n\n      if (timeout) {\n        clearTimeout(timeout);\n      }\n      resolve(type);\n    }\n\n    const eventHandler = handler.bind(null, WaitOnType.EVENT);\n    if (target instanceof EventBus) {\n      target._on(name, eventHandler);\n    } else {\n      target.addEventListener(name, eventHandler);\n    }\n\n    const timeoutHandler = handler.bind(null, WaitOnType.TIMEOUT);\n    const timeout = setTimeout(timeoutHandler, delay);\n  });\n}\n\n/**\n * Simple event bus for an application. Listeners are attached using the `on`\n * and `off` methods. To raise an event, the `dispatch` method shall be used.\n */\nclass EventBus {\n  #listeners = Object.create(null);\n\n  /**\n   * @param {string} eventName\n   * @param {function} listener\n   * @param {Object} [options]\n   */\n  on(eventName, listener, options = null) {\n    this._on(eventName, listener, {\n      external: true,\n      once: options?.once,\n    });\n  }\n\n  /**\n   * @param {string} eventName\n   * @param {function} listener\n   * @param {Object} [options]\n   */\n  off(eventName, listener, options = null) {\n    this._off(eventName, listener, {\n      external: true,\n      once: options?.once,\n    });\n  }\n\n  /**\n   * @param {string} eventName\n   * @param {Object} data\n   */\n  dispatch(eventName, data) {\n    const eventListeners = this.#listeners[eventName];\n    if (!eventListeners || eventListeners.length === 0) {\n      return;\n    }\n    let externalListeners;\n    // Making copy of the listeners array in case if it will be modified\n    // during dispatch.\n    for (const { listener, external, once } of eventListeners.slice(0)) {\n      if (once) {\n        this._off(eventName, listener);\n      }\n      if (external) {\n        (externalListeners ||= []).push(listener);\n        continue;\n      }\n      listener(data);\n    }\n    // Dispatch any \"external\" listeners *after* the internal ones, to give the\n    // viewer components time to handle events and update their state first.\n    if (externalListeners) {\n      for (const listener of externalListeners) {\n        listener(data);\n      }\n      externalListeners = null;\n    }\n  }\n\n  /**\n   * @ignore\n   */\n  _on(eventName, listener, options = null) {\n    const eventListeners = (this.#listeners[eventName] ||= []);\n    eventListeners.push({\n      listener,\n      external: options?.external === true,\n      once: options?.once === true,\n    });\n  }\n\n  /**\n   * @ignore\n   */\n  _off(eventName, listener, options = null) {\n    const eventListeners = this.#listeners[eventName];\n    if (!eventListeners) {\n      return;\n    }\n    for (let i = 0, ii = eventListeners.length; i < ii; i++) {\n      if (eventListeners[i].listener === listener) {\n        eventListeners.splice(i, 1);\n        return;\n      }\n    }\n  }\n}\n\n/**\n * NOTE: Only used to support various PDF viewer tests in `mozilla-central`.\n */\nclass AutomationEventBus extends EventBus {\n  dispatch(eventName, data) {\n    if (typeof PDFJSDev !== \"undefined\" && !PDFJSDev.test(\"MOZCENTRAL\")) {\n      throw new Error(\"Not implemented: AutomationEventBus.dispatch\");\n    }\n    super.dispatch(eventName, data);\n\n    const detail = Object.create(null);\n    if (data) {\n      for (const key in data) {\n        const value = data[key];\n        if (key === \"source\") {\n          if (value === window || value === document) {\n            return; // No need to re-dispatch (already) global events.\n          }\n          continue; // Ignore the `source` property.\n        }\n        detail[key] = value;\n      }\n    }\n    const event = new CustomEvent(eventName, {\n      bubbles: true,\n      cancelable: true,\n      detail,\n    });\n    document.dispatchEvent(event);\n  }\n}\n\nexport { AutomationEventBus, EventBus, waitOnEventOrTimeout, WaitOnType };\n","/* Copyright 2020 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { getPdfFilenameFromUrl } from \"pdfjs-lib\";\n\nasync function docProperties(pdfDocument) {\n  const url = \"\",\n    baseUrl = url.split(\"#\")[0];\n  // eslint-disable-next-line prefer-const\n  let { info, metadata, contentDispositionFilename, contentLength } =\n    await pdfDocument.getMetadata();\n\n  if (!contentLength) {\n    const { length } = await pdfDocument.getDownloadInfo();\n    contentLength = length;\n  }\n\n  return {\n    ...info,\n    baseURL: baseUrl,\n    filesize: contentLength,\n    filename: contentDispositionFilename || getPdfFilenameFromUrl(url),\n    metadata: metadata?.getRaw(),\n    authors: metadata?.get(\"dc:creator\"),\n    numPages: pdfDocument.numPages,\n    URL: url,\n  };\n}\n\nclass GenericScripting {\n  constructor(sandboxBundleSrc) {\n    if (sandboxBundleSrc?.constructor?.name === \"Function\") {\n      sandboxBundleSrc = sandboxBundleSrc();\n    }\n    this._ready = new Promise((resolve, reject) => {\n      const sandbox =\n        typeof PDFJSDev === \"undefined\"\n          ? import(sandboxBundleSrc) // eslint-disable-line no-unsanitized/method\n          : import(/* webpackIgnore: true */ sandboxBundleSrc);\n      sandbox\n        .then(pdfjsSandbox => {\n          resolve(pdfjsSandbox.QuickJSSandbox());\n        })\n        .catch(reject);\n    });\n  }\n\n  async createSandbox(data) {\n    const sandbox = await this._ready;\n    sandbox.create(data);\n  }\n\n  async dispatchEventInSandbox(event) {\n    const sandbox = await this._ready;\n    setTimeout(() => sandbox.dispatchEvent(event), 0);\n  }\n\n  async destroySandbox() {\n    const sandbox = await this._ready;\n    sandbox.nukeSandbox();\n  }\n}\n\nexport { docProperties, GenericScripting };\n","/* Copyright 2017 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** @typedef {import(\"./interfaces\").IL10n} IL10n */\n\nimport { FluentBundle, FluentResource } from \"fluent-bundle\";\nimport { DOMLocalization } from \"fluent-dom\";\nimport { fetchData } from \"pdfjs-lib\";\nimport { L10n } from \"./l10n.js\";\n\n/**\n * @implements {IL10n}\n */\nclass GenericL10n extends L10n {\n  constructor(lang) {\n    super({ lang });\n    this._setL10n(\n      new DOMLocalization(\n        [],\n        GenericL10n.#generateBundles.bind(\n          GenericL10n,\n          \"en-us\",\n          this.getLanguage()\n        )\n      )\n    );\n  }\n\n  /**\n   * Generate the bundles for Fluent.\n   * @param {String} defaultLang - The fallback language to use for\n   *   translations.\n   * @param {String} baseLang - The base language to use for translations.\n   */\n  static async *#generateBundles(defaultLang, baseLang) {\n    const { baseURL, paths } = await this.#getPaths();\n\n    const langs = [baseLang];\n    if (defaultLang !== baseLang) {\n      // Also fallback to the short-format of the base language\n      // (see issue 17269).\n      const shortLang = baseLang.split(\"-\", 1)[0];\n\n      if (shortLang !== baseLang) {\n        langs.push(shortLang);\n      }\n      langs.push(defaultLang);\n    }\n    for (const lang of langs) {\n      const bundle = await this.#createBundle(lang, baseURL, paths);\n      if (bundle) {\n        yield bundle;\n      }\n    }\n  }\n\n  static async #createBundle(lang, baseURL, paths) {\n    const path = paths[lang];\n    if (!path) {\n      return null;\n    }\n    const url = new URL(path, baseURL);\n    const text = await fetchData(url, /* type = */ \"text\");\n\n    const resource = new FluentResource(text);\n    const bundle = new FluentBundle(lang);\n    const errors = bundle.addResource(resource);\n    if (errors.length) {\n      console.error(\"L10n errors\", errors);\n    }\n    return bundle;\n  }\n\n  static async #getPaths() {\n    const { href } = document.querySelector(`link[type=\"application/l10n\"]`);\n    const paths = await fetchData(href, /* type = */ \"json\");\n\n    return { baseURL: href.replace(/[^/]*$/, \"\") || \"./\", paths };\n  }\n}\n\nexport { GenericL10n };\n","/* Copyright 2023 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** @typedef {import(\"./interfaces\").IL10n} IL10n */\n\n/**\n * NOTE: The L10n-implementations should use lowercase language-codes\n *       internally.\n * @implements {IL10n}\n */\nclass L10n {\n  #dir;\n\n  #lang;\n\n  #l10n;\n\n  constructor({ lang, isRTL }, l10n = null) {\n    this.#lang = L10n.#fixupLangCode(lang);\n    this.#l10n = l10n;\n    this.#dir = isRTL ?? L10n.#isRTL(this.#lang) ? \"rtl\" : \"ltr\";\n  }\n\n  _setL10n(l10n) {\n    this.#l10n = l10n;\n    if (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"TESTING\")) {\n      document.l10n = l10n;\n    }\n  }\n\n  /** @inheritdoc */\n  getLanguage() {\n    return this.#lang;\n  }\n\n  /** @inheritdoc */\n  getDirection() {\n    return this.#dir;\n  }\n\n  /** @inheritdoc */\n  async get(ids, args = null, fallback) {\n    if (Array.isArray(ids)) {\n      ids = ids.map(id => ({ id }));\n      const messages = await this.#l10n.formatMessages(ids);\n      return messages.map(message => message.value);\n    }\n\n    const messages = await this.#l10n.formatMessages([\n      {\n        id: ids,\n        args,\n      },\n    ]);\n    return messages?.[0].value || fallback;\n  }\n\n  /** @inheritdoc */\n  async translate(element) {\n    try {\n      this.#l10n.connectRoot(element);\n      await this.#l10n.translateRoots();\n    } catch {\n      // Element is under an existing root, so there is no need to add it again.\n    }\n  }\n\n  /** @inheritdoc */\n  pause() {\n    this.#l10n.pauseObserving();\n  }\n\n  /** @inheritdoc */\n  resume() {\n    this.#l10n.resumeObserving();\n  }\n\n  static #fixupLangCode(langCode) {\n    // Use only lowercase language-codes internally, and fallback to English.\n    langCode = langCode?.toLowerCase() || \"en-us\";\n\n    // Try to support \"incompletely\" specified language codes (see issue 13689).\n    const PARTIAL_LANG_CODES = {\n      en: \"en-us\",\n      es: \"es-es\",\n      fy: \"fy-nl\",\n      ga: \"ga-ie\",\n      gu: \"gu-in\",\n      hi: \"hi-in\",\n      hy: \"hy-am\",\n      nb: \"nb-no\",\n      ne: \"ne-np\",\n      nn: \"nn-no\",\n      pa: \"pa-in\",\n      pt: \"pt-pt\",\n      sv: \"sv-se\",\n      zh: \"zh-cn\",\n    };\n    return PARTIAL_LANG_CODES[langCode] || langCode;\n  }\n\n  static #isRTL(lang) {\n    const shortCode = lang.split(\"-\", 1)[0];\n    return [\"ar\", \"he\", \"fa\", \"ps\", \"ur\"].includes(shortCode);\n  }\n}\n\nexport { L10n };\n","/* Copyright 2021 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** @typedef {import(\"./interfaces\").IL10n} IL10n */\n\nimport { fetchData, shadow } from \"pdfjs-lib\";\nimport { FluentBundle, FluentResource } from \"fluent-bundle\";\nimport { DOMLocalization } from \"fluent-dom\";\nimport { L10n } from \"./l10n.js\";\n\n/**\n * @implements {IL10n}\n */\nclass ConstL10n extends L10n {\n  constructor(lang) {\n    super({ lang });\n    this._setL10n(\n      new DOMLocalization([], ConstL10n.#generateBundles.bind(ConstL10n, lang))\n    );\n  }\n\n  static async *#generateBundles(lang) {\n    const text =\n      typeof PDFJSDev === \"undefined\"\n        ? await fetchData(\n            new URL(`./locale/${lang}/viewer.ftl`, window.location.href),\n            /* type = */ \"text\"\n          )\n        : PDFJSDev.eval(\"DEFAULT_FTL\");\n\n    const resource = new FluentResource(text);\n    const bundle = new FluentBundle(lang);\n    const errors = bundle.addResource(resource);\n    if (errors.length) {\n      console.error(\"L10n errors\", errors);\n    }\n    yield bundle;\n  }\n\n  static get instance() {\n    return shadow(this, \"instance\", new ConstL10n(\"en-us\"));\n  }\n}\n\n/**\n * No-op implementation of the localization service.\n * @implements {IL10n}\n */\nconst NullL10n = {\n  getLanguage() {\n    return ConstL10n.instance.getLanguage();\n  },\n\n  getDirection() {\n    return ConstL10n.instance.getDirection();\n  },\n\n  async get(ids, args = null, fallback) {\n    return ConstL10n.instance.get(ids, args, fallback);\n  },\n\n  async translate(element) {\n    return ConstL10n.instance.translate(element);\n  },\n\n  pause() {\n    return ConstL10n.instance.pause();\n  },\n\n  resume() {\n    return ConstL10n.instance.resume();\n  },\n};\n\nexport { NullL10n };\n","/**\n * Class representing a book page\n */\nclass Page {\n    constructor(render, density) {\n        this.state = {\n            angle: 0,\n            area: [],\n            position: { x: 0, y: 0 },\n            hardAngle: 0,\n            hardDrawingAngle: 0,\n        };\n        this.createdDensity = density;\n        this.nowDrawingDensity = this.createdDensity;\n        this.render = render;\n    }\n    /**\n     * Set a constant page density\n     *\n     * @param {PageDensity} density\n     */\n    setDensity(density) {\n        this.createdDensity = density;\n        this.nowDrawingDensity = density;\n    }\n    /**\n     * Set temp page density to next render\n     *\n     * @param {PageDensity}  density\n     */\n    setDrawingDensity(density) {\n        this.nowDrawingDensity = density;\n    }\n    /**\n     * Set page position\n     *\n     * @param {Point} pagePos\n     */\n    setPosition(pagePos) {\n        this.state.position = pagePos;\n    }\n    /**\n     * Set page angle\n     *\n     * @param {number} angle\n     */\n    setAngle(angle) {\n        this.state.angle = angle;\n    }\n    /**\n     * Set page crop area\n     *\n     * @param {Point[]} area\n     */\n    setArea(area) {\n        this.state.area = area;\n    }\n    /**\n     * Rotate angle for hard pages to next render\n     *\n     * @param {number} angle\n     */\n    setHardDrawingAngle(angle) {\n        this.state.hardDrawingAngle = angle;\n    }\n    /**\n     * Rotate angle for hard pages\n     *\n     * @param {number} angle\n     */\n    setHardAngle(angle) {\n        this.state.hardAngle = angle;\n        this.state.hardDrawingAngle = angle;\n    }\n    /**\n     * Set page orientation\n     *\n     * @param {PageOrientation} orientation\n     */\n    setOrientation(orientation) {\n        this.orientation = orientation;\n    }\n    /**\n     * Get temp page density\n     */\n    getDrawingDensity() {\n        return this.nowDrawingDensity;\n    }\n    /**\n     * Get a constant page density\n     */\n    getDensity() {\n        return this.createdDensity;\n    }\n    /**\n     * Get rotate angle for hard pages\n     */\n    getHardAngle() {\n        return this.state.hardAngle;\n    }\n}\n\n/**\n * Class representing a book page as an image on Canvas\n */\nclass ImagePage extends Page {\n    constructor(render, href, density) {\n        super(render, density);\n        this.image = null;\n        this.isLoad = false;\n        this.loadingAngle = 0;\n        this.image = new Image();\n        this.image.src = href;\n    }\n    draw(tempDensity) {\n        // #1659 modified by ngx-extended-pdf-viewer\n        const options = window.pdfDefaultOptions.activateWillReadFrequentlyFlag ? { willReadFrequently: true} : undefined;\n        const ctx = canvas.getContext(\"2d\", options);\n        // #1659 end of modification by ngx-extended-pdf-viewer\n        const pagePos = this.render.convertToGlobal(this.state.position);\n        const pageWidth = this.render.getRect().pageWidth;\n        const pageHeight = this.render.getRect().height;\n        ctx.save();\n        ctx.translate(pagePos.x, pagePos.y);\n        ctx.beginPath();\n        for (let p of this.state.area) {\n            if (p !== null) {\n                p = this.render.convertToGlobal(p);\n                ctx.lineTo(p.x - pagePos.x, p.y - pagePos.y);\n            }\n        }\n        ctx.rotate(this.state.angle);\n        ctx.clip();\n        if (!this.isLoad) {\n            this.drawLoader(ctx, { x: 0, y: 0 }, pageWidth, pageHeight);\n        }\n        else {\n            ctx.drawImage(this.image, 0, 0, pageWidth, pageHeight);\n        }\n        ctx.restore();\n    }\n    simpleDraw(orient) {\n        const rect = this.render.getRect();\n        // #1659 modified by ngx-extended-pdf-viewer\n        const options = window.pdfDefaultOptions.activateWillReadFrequentlyFlag ? { willReadFrequently: true} : undefined;\n        const ctx = canvas.getContext(\"2d\", options);\n        // #1659 end of modification by ngx-extended-pdf-viewer\n        const pageWidth = rect.pageWidth;\n        const pageHeight = rect.height;\n        const x = orient === 1 /* RIGHT */ ? rect.left + rect.pageWidth : rect.left;\n        const y = rect.top;\n        if (!this.isLoad) {\n            this.drawLoader(ctx, { x, y }, pageWidth, pageHeight);\n        }\n        else {\n            ctx.drawImage(this.image, x, y, pageWidth, pageHeight);\n        }\n    }\n    drawLoader(ctx, shiftPos, pageWidth, pageHeight) {\n        ctx.beginPath();\n        ctx.strokeStyle = 'rgb(200, 200, 200)';\n        ctx.fillStyle = 'rgb(255, 255, 255)';\n        ctx.lineWidth = 1;\n        ctx.rect(shiftPos.x + 1, shiftPos.y + 1, pageWidth - 1, pageHeight - 1);\n        ctx.stroke();\n        ctx.fill();\n        const middlePoint = {\n            x: shiftPos.x + pageWidth / 2,\n            y: shiftPos.y + pageHeight / 2,\n        };\n        ctx.beginPath();\n        ctx.lineWidth = 10;\n        ctx.arc(middlePoint.x, middlePoint.y, 20, this.loadingAngle, (3 * Math.PI) / 2 + this.loadingAngle);\n        ctx.stroke();\n        ctx.closePath();\n        this.loadingAngle += 0.07;\n        if (this.loadingAngle >= 2 * Math.PI) {\n            this.loadingAngle = 0;\n        }\n    }\n    load() {\n        if (!this.isLoad)\n            this.image.onload = () => {\n                this.isLoad = true;\n            };\n    }\n    newTemporaryCopy() {\n        return this;\n    }\n    getTemporaryCopy() {\n        return this;\n    }\n    hideTemporaryCopy() {\n        return;\n    }\n}\n\n/**\n * lass representing a collection of pages\n */\nclass PageCollection {\n    constructor(app, render) {\n        /** Pages List */\n        this.pages = [];\n        /** Index of the current page in list */\n        this.currentPageIndex = 0;\n        /** Number of the current spread in book */\n        this.currentSpreadIndex = 0;\n        /**  Two-page spread in landscape mode */\n        this.landscapeSpread = [];\n        /**  One-page spread in portrait mode */\n        this.portraitSpread = [];\n        this.render = render;\n        this.app = app;\n        this.currentPageIndex = 0;\n        this.isShowCover = this.app.getSettings().showCover;\n    }\n    /**\n     * Clear pages list\n     */\n    destroy() {\n        this.pages = [];\n    }\n    /**\n     * Split the book on the two-page spread in landscape mode and one-page spread in portrait mode\n     */\n    createSpread() {\n        this.landscapeSpread = [];\n        this.portraitSpread = [];\n        for (let i = 0; i < this.pages.length; i++) {\n            this.portraitSpread.push([i]); // In portrait mode - (one spread = one page)\n        }\n        let start = 0;\n        if (this.isShowCover) {\n            this.pages[0].setDensity(\"hard\" /* HARD */);\n            this.landscapeSpread.push([start]);\n            start++;\n        }\n        for (let i = start; i < this.pages.length; i += 2) {\n            if (i < this.pages.length - 1)\n                this.landscapeSpread.push([i, i + 1]);\n            else {\n                this.landscapeSpread.push([i]);\n                this.pages[i].setDensity(\"hard\" /* HARD */);\n            }\n        }\n    }\n    /**\n     * Get spread by mode (portrait or landscape)\n     */\n    getSpread() {\n        return this.render.getOrientation() === \"landscape\" /* LANDSCAPE */\n            ? this.landscapeSpread\n            : this.portraitSpread;\n    }\n    /**\n     * Get spread index by page number\n     *\n     * @param {number} pageNum - page index\n     */\n    getSpreadIndexByPage(pageNum) {\n        const spread = this.getSpread();\n        for (let i = 0; i < spread.length; i++)\n            if (pageNum === spread[i][0] || pageNum === spread[i][1])\n                return i;\n        return null;\n    }\n    /**\n     * Get the total number of pages\n     */\n    getPageCount() {\n        return this.pages.length;\n    }\n    /**\n     * Get the pages list\n     */\n    getPages() {\n        return this.pages;\n    }\n    /**\n     * Get page by index\n     *\n     * @param {number} pageIndex\n     */\n    getPage(pageIndex) {\n        if (pageIndex >= 0 && pageIndex < this.pages.length) {\n            return this.pages[pageIndex];\n        }\n        throw new Error('Invalid page number');\n    }\n    /**\n     * Get the next page from the specified\n     *\n     * @param {Page} current\n     */\n    nextBy(current) {\n        const idx = this.pages.indexOf(current);\n        if (idx < this.pages.length - 1)\n            return this.pages[idx + 1];\n        return null;\n    }\n    /**\n     * Get previous page from specified\n     *\n     * @param {Page} current\n     */\n    prevBy(current) {\n        const idx = this.pages.indexOf(current);\n        if (idx > 0)\n            return this.pages[idx - 1];\n        return null;\n    }\n    /**\n     * Get flipping page depending on the direction\n     *\n     * @param {FlipDirection} direction\n     */\n    getFlippingPage(direction) {\n        const current = this.currentSpreadIndex;\n        if (this.render.getOrientation() === \"portrait\" /* PORTRAIT */) {\n            return direction === 0 /* FORWARD */\n                ? this.pages[current].newTemporaryCopy()\n                : this.pages[current - 1];\n        }\n        else {\n            const spread = direction === 0 /* FORWARD */\n                ? this.getSpread()[current + 1]\n                : this.getSpread()[current - 1];\n            if (spread.length === 1)\n                return this.pages[spread[0]];\n            return direction === 0 /* FORWARD */\n                ? this.pages[spread[0]]\n                : this.pages[spread[1]];\n        }\n    }\n    /**\n     * Get Next page at the time of flipping\n     *\n     * @param {FlipDirection}  direction\n     */\n    getBottomPage(direction) {\n        const current = this.currentSpreadIndex;\n        if (this.render.getOrientation() === \"portrait\" /* PORTRAIT */) {\n            return direction === 0 /* FORWARD */\n                ? this.pages[current + 1]\n                : this.pages[current - 1];\n        }\n        else {\n            const spread = direction === 0 /* FORWARD */\n                ? this.getSpread()[current + 1]\n                : this.getSpread()[current - 1];\n            if (spread.length === 1)\n                return this.pages[spread[0]];\n            return direction === 0 /* FORWARD */\n                ? this.pages[spread[1]]\n                : this.pages[spread[0]];\n        }\n    }\n    /**\n     * Show next spread\n     */\n    showNext() {\n        if (this.currentSpreadIndex < this.getSpread().length) {\n            this.currentSpreadIndex++;\n            this.showSpread();\n        }\n    }\n    /**\n     * Show prev spread\n     */\n    showPrev() {\n        if (this.currentSpreadIndex > 0) {\n            this.currentSpreadIndex--;\n            this.showSpread();\n        }\n    }\n    /**\n     * Get the number of the current spread in book\n     */\n    getCurrentPageIndex() {\n        return this.currentPageIndex;\n    }\n    /**\n     * Show specified page\n     * @param {number} pageNum - Page index (from 0s)\n     */\n    show(pageNum = null) {\n        if (pageNum === null)\n            pageNum = this.currentPageIndex;\n        if (pageNum < 0 || pageNum >= this.pages.length)\n            return;\n        const spreadIndex = this.getSpreadIndexByPage(pageNum);\n        if (spreadIndex !== null) {\n            this.currentSpreadIndex = spreadIndex;\n            this.showSpread();\n        }\n    }\n    /**\n     * Index of the current page in list\n     */\n    getCurrentSpreadIndex() {\n        return this.currentSpreadIndex;\n    }\n    /**\n     * Set new spread index as current\n     *\n     * @param {number} newIndex - new spread index\n     */\n    setCurrentSpreadIndex(newIndex) {\n        if (newIndex >= 0 && newIndex < this.getSpread().length) {\n            this.currentSpreadIndex = newIndex;\n        }\n        else {\n            throw new Error('Invalid page');\n        }\n    }\n    /**\n     * Show current spread\n     */\n    showSpread() {\n        const spread = this.getSpread()[this.currentSpreadIndex];\n        if (spread.length === 2) {\n            this.render.setLeftPage(this.pages[spread[0]]);\n            this.render.setRightPage(this.pages[spread[1]]);\n        }\n        else {\n            if (this.render.getOrientation() === \"landscape\" /* LANDSCAPE */) {\n                if (spread[0] === this.pages.length - 1) {\n                    this.render.setLeftPage(this.pages[spread[0]]);\n                    this.render.setRightPage(null);\n                }\n                else {\n                    this.render.setLeftPage(null);\n                    this.render.setRightPage(this.pages[spread[0]]);\n                }\n            }\n            else {\n                this.render.setLeftPage(null);\n                this.render.setRightPage(this.pages[spread[0]]);\n            }\n        }\n        this.currentPageIndex = spread[0];\n        this.app.updatePageIndex(this.currentPageIndex);\n    }\n}\n\n/**\n * lass representing a collection of pages as images on the canvas\n */\nclass ImagePageCollection extends PageCollection {\n    constructor(app, render, imagesHref) {\n        super(app, render);\n        this.imagesHref = imagesHref;\n    }\n    load() {\n        for (const href of this.imagesHref) {\n            const page = new ImagePage(this.render, href, \"soft\" /* SOFT */);\n            page.load();\n            this.pages.push(page);\n        }\n        this.createSpread();\n    }\n}\n\n/**\n * A class containing helping mathematical methods\n */\nclass Helper {\n    /**\n     * Get the distance between two points\n     *\n     * @param {Point} point1\n     * @param {Point} point2\n     */\n    static GetDistanceBetweenTwoPoint(point1, point2) {\n        if (point1 === null || point2 === null) {\n            return Infinity;\n        }\n        return Math.sqrt(Math.pow(point2.x - point1.x, 2) + Math.pow(point2.y - point1.y, 2));\n    }\n    /**\n     * Get the length of the line segment\n     *\n     * @param {Segment} segment\n     */\n    static GetSegmentLength(segment) {\n        return Helper.GetDistanceBetweenTwoPoint(segment[0], segment[1]);\n    }\n    /**\n     * Get the angle between two lines\n     *\n     * @param {Segment} line1\n     * @param {Segment} line2\n     */\n    static GetAngleBetweenTwoLine(line1, line2) {\n        const A1 = line1[0].y - line1[1].y;\n        const A2 = line2[0].y - line2[1].y;\n        const B1 = line1[1].x - line1[0].x;\n        const B2 = line2[1].x - line2[0].x;\n        return Math.acos((A1 * A2 + B1 * B2) / (Math.sqrt(A1 * A1 + B1 * B1) * Math.sqrt(A2 * A2 + B2 * B2)));\n    }\n    /**\n     * Check for a point in a rectangle\n     *\n     * @param {Rect} rect\n     * @param {Point} pos\n     *\n     * @returns {Point} If the point enters the rectangle its coordinates will be returned, otherwise - null\n     */\n    static PointInRect(rect, pos) {\n        if (pos === null) {\n            return null;\n        }\n        if (pos.x >= rect.left &&\n            pos.x <= rect.width + rect.left &&\n            pos.y >= rect.top &&\n            pos.y <= rect.top + rect.height) {\n            return pos;\n        }\n        return null;\n    }\n    /**\n     * Transform point coordinates to a given angle\n     *\n     * @param {Point} transformedPoint - Point to rotate\n     * @param {Point} startPoint - Transformation reference point\n     * @param {number} angle - Rotation angle (in radians)\n     *\n     * @returns {Point} Point coordinates after rotation\n     */\n    static GetRotatedPoint(transformedPoint, startPoint, angle) {\n        return {\n            x: transformedPoint.x * Math.cos(angle) + transformedPoint.y * Math.sin(angle) + startPoint.x,\n            y: transformedPoint.y * Math.cos(angle) - transformedPoint.x * Math.sin(angle) + startPoint.y,\n        };\n    }\n    /**\n     * Limit a point \"linePoint\" to a given circle centered at point \"startPoint\" and a given radius\n     *\n     * @param {Point} startPoint - Circle center\n     * @param {number} radius - Circle radius\n     * @param {Point} limitedPoint - hecked point\n     *\n     * @returns {Point} If \"linePoint\" enters the circle, then its coordinates are returned.\n     * Else will be returned the intersection point between the line ([startPoint, linePoint]) and the circle\n     */\n    static LimitPointToCircle(startPoint, radius, limitedPoint) {\n        // If \"linePoint\" enters the circle, do nothing\n        if (Helper.GetDistanceBetweenTwoPoint(startPoint, limitedPoint) <= radius) {\n            return limitedPoint;\n        }\n        const a = startPoint.x;\n        const b = startPoint.y;\n        const n = limitedPoint.x;\n        const m = limitedPoint.y;\n        // Find the intersection between the line at two points: (startPoint and limitedPoint) and the circle.\n        let x = Math.sqrt((Math.pow(radius, 2) * Math.pow(a - n, 2)) / (Math.pow(a - n, 2) + Math.pow(b - m, 2))) + a;\n        if (limitedPoint.x < 0) {\n            x *= -1;\n        }\n        let y = ((x - a) * (b - m)) / (a - n) + b;\n        if (a - n + b === 0) {\n            y = radius;\n        }\n        return { x, y };\n    }\n    /**\n     * Find the intersection of two lines bounded by a rectangle \"rectBorder\"\n     *\n     * @param {Rect} rectBorder\n     * @param {Segment} one\n     * @param {Segment} two\n     *\n     * @returns {Point} The intersection point, or \"null\" if it does not exist, or it lies outside the rectangle \"rectBorder\"\n     */\n    static GetIntersectBetweenTwoSegment(rectBorder, one, two) {\n        return Helper.PointInRect(rectBorder, Helper.GetIntersectBeetwenTwoLine(one, two));\n    }\n    /**\n     * Find the intersection point of two lines\n     *\n     * @param one\n     * @param two\n     *\n     * @returns {Point} The intersection point, or \"null\" if it does not exist\n     * @throws Error if the segments are on the same line\n     */\n    static GetIntersectBeetwenTwoLine(one, two) {\n        const A1 = one[0].y - one[1].y;\n        const A2 = two[0].y - two[1].y;\n        const B1 = one[1].x - one[0].x;\n        const B2 = two[1].x - two[0].x;\n        const C1 = one[0].x * one[1].y - one[1].x * one[0].y;\n        const C2 = two[0].x * two[1].y - two[1].x * two[0].y;\n        const det1 = A1 * C2 - A2 * C1;\n        const det2 = B1 * C2 - B2 * C1;\n        const x = -((C1 * B2 - C2 * B1) / (A1 * B2 - A2 * B1));\n        const y = -((A1 * C2 - A2 * C1) / (A1 * B2 - A2 * B1));\n        if (isFinite(x) && isFinite(y)) {\n            return { x, y };\n        }\n        else {\n            if (Math.abs(det1 - det2) < 0.1)\n                throw new Error('Segment included');\n        }\n        return null;\n    }\n    /**\n     * Get a list of coordinates (step: 1px) between two points\n     *\n     * @param pointOne\n     * @param pointTwo\n     *\n     * @returns {Point[]}\n     */\n    static GetCordsFromTwoPoint(pointOne, pointTwo) {\n        const sizeX = Math.abs(pointOne.x - pointTwo.x);\n        const sizeY = Math.abs(pointOne.y - pointTwo.y);\n        const lengthLine = Math.max(sizeX, sizeY);\n        const result = [pointOne];\n        function getCord(c1, c2, size, length, index) {\n            if (c2 > c1) {\n                return c1 + index * (size / length);\n            }\n            else if (c2 < c1) {\n                return c1 - index * (size / length);\n            }\n            return c1;\n        }\n        for (let i = 1; i <= lengthLine; i += 1) {\n            result.push({\n                x: getCord(pointOne.x, pointTwo.x, sizeX, lengthLine, i),\n                y: getCord(pointOne.y, pointTwo.y, sizeY, lengthLine, i),\n            });\n        }\n        return result;\n    }\n}\n\n/**\n * Class representing a book page as a HTML Element\n */\nclass HTMLPage extends Page {\n    constructor(render, element, density) {\n        super(render, density);\n        this.copiedElement = null;\n        this.temporaryCopy = null;\n        this.isLoad = false;\n        this.element = element;\n        this.element.classList.add('stf__item');\n        this.element.classList.add('--' + density);\n    }\n    newTemporaryCopy() {\n        if (this.nowDrawingDensity === \"hard\" /* HARD */) {\n            return this;\n        }\n        if (this.temporaryCopy === null) {\n            this.copiedElement = this.element.cloneNode(true);\n            this.element.parentElement.appendChild(this.copiedElement);\n            this.temporaryCopy = new HTMLPage(this.render, this.copiedElement, this.nowDrawingDensity);\n        }\n        return this.getTemporaryCopy();\n    }\n    getTemporaryCopy() {\n        return this.temporaryCopy;\n    }\n    hideTemporaryCopy() {\n        if (this.temporaryCopy !== null) {\n            this.copiedElement.remove();\n            this.copiedElement = null;\n            this.temporaryCopy = null;\n        }\n    }\n    draw(tempDensity) {\n        const density = tempDensity ? tempDensity : this.nowDrawingDensity;\n        const pagePos = this.render.convertToGlobal(this.state.position);\n        const pageWidth = this.render.getRect().pageWidth;\n        const pageHeight = this.render.getRect().height;\n        this.element.classList.remove('--simple');\n        // modified by ngx-extended-pdf-viewer (added position: absolute)\n        const commonStyle = `\n            position: absolute;\n            display: block;\n            z-index: ${this.element.style.zIndex};\n            left: 0;\n            top: 0;\n            width: ${pageWidth}px;\n            height: ${pageHeight}px;\n        `;\n        // end of modification by ngx-extended-pdf-viewer\n        density === \"hard\" /* HARD */\n            ? this.drawHard(commonStyle)\n            : this.drawSoft(pagePos, commonStyle);\n    }\n    drawHard(commonStyle = '') {\n        const pos = this.render.getRect().left + this.render.getRect().width / 2;\n        const angle = this.state.hardDrawingAngle;\n        const newStyle = commonStyle +\n            `\n                backface-visibility: hidden;\n                -webkit-backface-visibility: hidden;\n                clip-path: none;\n                -webkit-clip-path: none;\n            ` +\n            (this.orientation === 0 /* LEFT */\n                ? `transform-origin: ${this.render.getRect().pageWidth}px 0;\n                   transform: translate3d(0, 0, 0) rotateY(${angle}deg);`\n                : `transform-origin: 0 0;\n                   transform: translate3d(${pos}px, 0, 0) rotateY(${angle}deg);`);\n        this.element.style.cssText = newStyle;\n    }\n    drawSoft(position, commonStyle = '') {\n        let polygon = 'polygon( ';\n        for (const p of this.state.area) {\n            if (p !== null) {\n                let g = this.render.getDirection() === 1 /* BACK */\n                    ? {\n                        x: -p.x + this.state.position.x,\n                        y: p.y - this.state.position.y,\n                    }\n                    : {\n                        x: p.x - this.state.position.x,\n                        y: p.y - this.state.position.y,\n                    };\n                g = Helper.GetRotatedPoint(g, { x: 0, y: 0 }, this.state.angle);\n                polygon += g.x + 'px ' + g.y + 'px, ';\n            }\n        }\n        polygon = polygon.slice(0, -2);\n        polygon += ')';\n        const newStyle = commonStyle +\n            `transform-origin: 0 0; clip-path: ${polygon}; -webkit-clip-path: ${polygon};` +\n            (this.render.isSafari() && this.state.angle === 0\n                ? `transform: translate(${position.x}px, ${position.y}px);`\n                : `transform: translate3d(${position.x}px, ${position.y}px, 0) rotate(${this.state.angle}rad);`);\n        this.element.style.cssText = newStyle;\n    }\n    simpleDraw(orient) {\n        const rect = this.render.getRect();\n        const pageWidth = rect.pageWidth;\n        const pageHeight = rect.height;\n        const x = orient === 1 /* RIGHT */ ? rect.left + rect.pageWidth : rect.left;\n        const y = rect.top;\n        this.element.classList.add('--simple');\n        this.element.style.cssText = `\n            position: absolute;\n            display: block;\n            height: ${pageHeight}px;\n            left: ${x}px;\n            top: ${y}px;\n            width: ${pageWidth}px;\n            z-index: ${this.render.getSettings().startZIndex + 1};`;\n    }\n    getElement() {\n        return this.element;\n    }\n    load() {\n        this.isLoad = true;\n    }\n    setOrientation(orientation) {\n        super.setOrientation(orientation);\n        this.element.classList.remove('--left', '--right');\n        this.element.classList.add(orientation === 1 /* RIGHT */ ? '--right' : '--left');\n    }\n    setDrawingDensity(density) {\n        this.element.classList.remove('--soft', '--hard');\n        this.element.classList.add('--' + density);\n        super.setDrawingDensity(density);\n    }\n}\n\n/**\n * lass representing a collection of pages as HTML Element\n */\nclass HTMLPageCollection extends PageCollection {\n    constructor(app, render, element, items) {\n        super(app, render);\n        this.element = element;\n        this.pagesElement = items;\n    }\n    load() {\n        for (const pageElement of this.pagesElement) {\n            const page = new HTMLPage(this.render, pageElement, pageElement.dataset['density'] === 'hard' ? \"hard\" /* HARD */ : \"soft\" /* SOFT */);\n            page.load();\n            this.pages.push(page);\n        }\n        this.createSpread();\n    }\n}\n\n/**\n * Class representing mathematical methods for calculating page position (rotation angle, clip area ...)\n */\nclass FlipCalculation {\n    /**\n     * @constructor\n     *\n     * @param {FlipDirection} direction - Flipping direction\n     * @param {FlipCorner} corner - Flipping corner\n     * @param pageWidth - Current page width\n     * @param pageHeight - Current page height\n     */\n    constructor(direction, corner, pageWidth, pageHeight) {\n        this.direction = direction;\n        this.corner = corner;\n        /** The point of intersection of the page with the borders of the book */\n        this.topIntersectPoint = null; // With top border\n        this.sideIntersectPoint = null; // With side border\n        this.bottomIntersectPoint = null; // With bottom border\n        this.pageWidth = parseInt(pageWidth, 10);\n        this.pageHeight = parseInt(pageHeight, 10);\n    }\n    /**\n     * The main calculation method\n     *\n     * @param {Point} localPos - Touch Point Coordinates (relative active page!)\n     *\n     * @returns {boolean} True - if the calculations were successful, false if errors occurred\n     */\n    calc(localPos) {\n        try {\n            // Find: page rotation angle and active corner position\n            this.position = this.calcAngleAndPosition(localPos);\n            // Find the intersection points of the scrolling page and the book\n            this.calculateIntersectPoint(this.position);\n            return true;\n        }\n        catch (e) {\n            return false;\n        }\n    }\n    /**\n     * Get the crop area for the flipping page\n     *\n     * @returns {Point[]} Polygon page\n     */\n    getFlippingClipArea() {\n        const result = [];\n        let clipBottom = false;\n        result.push(this.rect.topLeft);\n        result.push(this.topIntersectPoint);\n        if (this.sideIntersectPoint === null) {\n            clipBottom = true;\n        }\n        else {\n            result.push(this.sideIntersectPoint);\n            if (this.bottomIntersectPoint === null)\n                clipBottom = false;\n        }\n        result.push(this.bottomIntersectPoint);\n        if (clipBottom || this.corner === \"bottom\" /* BOTTOM */) {\n            result.push(this.rect.bottomLeft);\n        }\n        return result;\n    }\n    /**\n     * Get the crop area for the page that is below the page to be flipped\n     *\n     * @returns {Point[]} Polygon page\n     */\n    getBottomClipArea() {\n        const result = [];\n        result.push(this.topIntersectPoint);\n        if (this.corner === \"top\" /* TOP */) {\n            result.push({ x: this.pageWidth, y: 0 });\n        }\n        else {\n            if (this.topIntersectPoint !== null) {\n                result.push({ x: this.pageWidth, y: 0 });\n            }\n            result.push({ x: this.pageWidth, y: this.pageHeight });\n        }\n        if (this.sideIntersectPoint !== null) {\n            if (Helper.GetDistanceBetweenTwoPoint(this.sideIntersectPoint, this.topIntersectPoint) >= 10)\n                result.push(this.sideIntersectPoint);\n        }\n        else {\n            if (this.corner === \"top\" /* TOP */) {\n                result.push({ x: this.pageWidth, y: this.pageHeight });\n            }\n        }\n        result.push(this.bottomIntersectPoint);\n        result.push(this.topIntersectPoint);\n        return result;\n    }\n    /**\n     * Get page rotation angle\n     */\n    getAngle() {\n        if (this.direction === 0 /* FORWARD */) {\n            return -this.angle;\n        }\n        return this.angle;\n    }\n    /**\n     * Get page area while flipping\n     */\n    getRect() {\n        return this.rect;\n    }\n    /**\n     * Get the position of the active angle when turning\n     */\n    getPosition() {\n        return this.position;\n    }\n    /**\n     * Get the active corner of the page (which pull)\n     */\n    getActiveCorner() {\n        if (this.direction === 0 /* FORWARD */) {\n            return this.rect.topLeft;\n        }\n        return this.rect.topRight;\n    }\n    /**\n     * Get flipping direction\n     */\n    getDirection() {\n        return this.direction;\n    }\n    /**\n     * Get flipping progress (0-100)\n     */\n    getFlippingProgress() {\n        return Math.abs(((this.position.x - this.pageWidth) / (2 * this.pageWidth)) * 100);\n    }\n    /**\n     * Get flipping corner position (top, bottom)\n     */\n    getCorner() {\n        return this.corner;\n    }\n    /**\n     * Get start position for the page that is below the page to be flipped\n     */\n    getBottomPagePosition() {\n        if (this.direction === 1 /* BACK */) {\n            return { x: this.pageWidth, y: 0 };\n        }\n        return { x: 0, y: 0 };\n    }\n    /**\n     * Get the starting position of the shadow\n     */\n    getShadowStartPoint() {\n        if (this.corner === \"top\" /* TOP */) {\n            return this.topIntersectPoint;\n        }\n        else {\n            if (this.sideIntersectPoint !== null)\n                return this.sideIntersectPoint;\n            return this.topIntersectPoint;\n        }\n    }\n    /**\n     * Get the rotate angle of the shadow\n     */\n    getShadowAngle() {\n        const angle = Helper.GetAngleBetweenTwoLine(this.getSegmentToShadowLine(), [\n            { x: 0, y: 0 },\n            { x: this.pageWidth, y: 0 },\n        ]);\n        if (this.direction === 0 /* FORWARD */) {\n            return angle;\n        }\n        return Math.PI - angle;\n    }\n    calcAngleAndPosition(pos) {\n        let result = pos;\n        this.updateAngleAndGeometry(result);\n        if (this.corner === \"top\" /* TOP */) {\n            result = this.checkPositionAtCenterLine(result, { x: 0, y: 0 }, { x: 0, y: this.pageHeight });\n        }\n        else {\n            result = this.checkPositionAtCenterLine(result, { x: 0, y: this.pageHeight }, { x: 0, y: 0 });\n        }\n        if (Math.abs(result.x - this.pageWidth) < 1 && Math.abs(result.y) < 1) {\n            throw new Error('Point is too small');\n        }\n        return result;\n    }\n    updateAngleAndGeometry(pos) {\n        this.angle = this.calculateAngle(pos);\n        this.rect = this.getPageRect(pos);\n    }\n    calculateAngle(pos) {\n        const left = this.pageWidth - pos.x + 1;\n        const top = this.corner === \"bottom\" /* BOTTOM */ ? this.pageHeight - pos.y : pos.y;\n        let angle = 2 * Math.acos(left / Math.sqrt(top * top + left * left));\n        if (top < 0)\n            angle = -angle;\n        const da = Math.PI - angle;\n        if (!isFinite(angle) || (da >= 0 && da < 0.003))\n            throw new Error('The G point is too small');\n        if (this.corner === \"bottom\" /* BOTTOM */)\n            angle = -angle;\n        return angle;\n    }\n    getPageRect(localPos) {\n        if (this.corner === \"top\" /* TOP */) {\n            return this.getRectFromBasePoint([\n                { x: 0, y: 0 },\n                { x: this.pageWidth, y: 0 },\n                { x: 0, y: this.pageHeight },\n                { x: this.pageWidth, y: this.pageHeight },\n            ], localPos);\n        }\n        return this.getRectFromBasePoint([\n            { x: 0, y: -this.pageHeight },\n            { x: this.pageWidth, y: -this.pageHeight },\n            { x: 0, y: 0 },\n            { x: this.pageWidth, y: 0 },\n        ], localPos);\n    }\n    getRectFromBasePoint(points, localPos) {\n        return {\n            topLeft: this.getRotatedPoint(points[0], localPos),\n            topRight: this.getRotatedPoint(points[1], localPos),\n            bottomLeft: this.getRotatedPoint(points[2], localPos),\n            bottomRight: this.getRotatedPoint(points[3], localPos),\n        };\n    }\n    getRotatedPoint(transformedPoint, startPoint) {\n        return {\n            x: transformedPoint.x * Math.cos(this.angle) +\n                transformedPoint.y * Math.sin(this.angle) +\n                startPoint.x,\n            y: transformedPoint.y * Math.cos(this.angle) -\n                transformedPoint.x * Math.sin(this.angle) +\n                startPoint.y,\n        };\n    }\n    calculateIntersectPoint(pos) {\n        const boundRect = {\n            left: -1,\n            top: -1,\n            width: this.pageWidth + 2,\n            height: this.pageHeight + 2,\n        };\n        if (this.corner === \"top\" /* TOP */) {\n            this.topIntersectPoint = Helper.GetIntersectBetweenTwoSegment(boundRect, [pos, this.rect.topRight], [\n                { x: 0, y: 0 },\n                { x: this.pageWidth, y: 0 },\n            ]);\n            this.sideIntersectPoint = Helper.GetIntersectBetweenTwoSegment(boundRect, [pos, this.rect.bottomLeft], [\n                { x: this.pageWidth, y: 0 },\n                { x: this.pageWidth, y: this.pageHeight },\n            ]);\n            this.bottomIntersectPoint = Helper.GetIntersectBetweenTwoSegment(boundRect, [this.rect.bottomLeft, this.rect.bottomRight], [\n                { x: 0, y: this.pageHeight },\n                { x: this.pageWidth, y: this.pageHeight },\n            ]);\n        }\n        else {\n            this.topIntersectPoint = Helper.GetIntersectBetweenTwoSegment(boundRect, [this.rect.topLeft, this.rect.topRight], [\n                { x: 0, y: 0 },\n                { x: this.pageWidth, y: 0 },\n            ]);\n            this.sideIntersectPoint = Helper.GetIntersectBetweenTwoSegment(boundRect, [pos, this.rect.topLeft], [\n                { x: this.pageWidth, y: 0 },\n                { x: this.pageWidth, y: this.pageHeight },\n            ]);\n            this.bottomIntersectPoint = Helper.GetIntersectBetweenTwoSegment(boundRect, [this.rect.bottomLeft, this.rect.bottomRight], [\n                { x: 0, y: this.pageHeight },\n                { x: this.pageWidth, y: this.pageHeight },\n            ]);\n        }\n    }\n    checkPositionAtCenterLine(checkedPos, centerOne, centerTwo) {\n        let result = checkedPos;\n        const tmp = Helper.LimitPointToCircle(centerOne, this.pageWidth, result);\n        if (result !== tmp) {\n            result = tmp;\n            this.updateAngleAndGeometry(result);\n        }\n        const rad = Math.sqrt(Math.pow(this.pageWidth, 2) + Math.pow(this.pageHeight, 2));\n        let checkPointOne = this.rect.bottomRight;\n        let checkPointTwo = this.rect.topLeft;\n        if (this.corner === \"bottom\" /* BOTTOM */) {\n            checkPointOne = this.rect.topRight;\n            checkPointTwo = this.rect.bottomLeft;\n        }\n        if (checkPointOne.x <= 0) {\n            const bottomPoint = Helper.LimitPointToCircle(centerTwo, rad, checkPointTwo);\n            if (bottomPoint !== result) {\n                result = bottomPoint;\n                this.updateAngleAndGeometry(result);\n            }\n        }\n        return result;\n    }\n    getSegmentToShadowLine() {\n        const first = this.getShadowStartPoint();\n        const second = first !== this.sideIntersectPoint && this.sideIntersectPoint !== null\n            ? this.sideIntersectPoint\n            : this.bottomIntersectPoint;\n        return [first, second];\n    }\n}\n\n/**\n * Class representing the flipping process\n */\nclass Flip {\n    constructor(render, app) {\n        this.flippingPage = null;\n        this.bottomPage = null;\n        this.calc = null;\n        this.state = \"read\" /* READ */;\n        this.render = render;\n        this.app = app;\n    }\n    /**\n     * Called when the page folding (User drags page corner)\n     *\n     * @param globalPos - Touch Point Coordinates (relative window)\n     */\n    fold(globalPos) {\n        this.setState(\"user_fold\" /* USER_FOLD */);\n        // If the process has not started yet\n        if (this.calc === null)\n            this.start(globalPos);\n        this.do(this.render.convertToPage(globalPos));\n    }\n    /**\n     * Page turning with animation\n     *\n     * @param globalPos - Touch Point Coordinates (relative window)\n     */\n    flip(globalPos) {\n        if (this.app.getSettings().disableFlipByClick && !this.isPointOnCorners(globalPos))\n            return;\n        // the flipiing process is already running\n        if (this.calc !== null)\n            this.render.finishAnimation();\n        if (!this.start(globalPos))\n            return;\n        const rect = this.getBoundsRect();\n        this.setState(\"flipping\" /* FLIPPING */);\n        // Margin from top to start flipping\n        const topMargins = rect.height / 10;\n        // Defining animation start points\n        const yStart = this.calc.getCorner() === \"bottom\" /* BOTTOM */ ? rect.height - topMargins : topMargins;\n        const yDest = this.calc.getCorner() === \"bottom\" /* BOTTOM */ ? rect.height : 0;\n        // alculations for these points\n        this.calc.calc({ x: rect.pageWidth - topMargins, y: yStart });\n        // Run flipping animation\n        this.animateFlippingTo({ x: rect.pageWidth - topMargins, y: yStart }, { x: -rect.pageWidth, y: yDest }, true);\n    }\n    /**\n     * Start the flipping process. Find direction and corner of flipping. Creating an object for calculation.\n     *\n     * @param {Point} globalPos - Touch Point Coordinates (relative window)\n     *\n     * @returns {boolean} True if flipping is possible, false otherwise\n     */\n    start(globalPos) {\n        this.reset();\n        const bookPos = this.render.convertToBook(globalPos);\n        const rect = this.getBoundsRect();\n        // Find the direction of flipping\n        const direction = this.getDirectionByPoint(bookPos);\n        // Find the active corner\n        const flipCorner = bookPos.y >= rect.height / 2 ? \"bottom\" /* BOTTOM */ : \"top\" /* TOP */;\n        if (!this.checkDirection(direction))\n            return false;\n        try {\n            this.flippingPage = this.app.getPageCollection().getFlippingPage(direction);\n            this.bottomPage = this.app.getPageCollection().getBottomPage(direction);\n            // In landscape mode, needed to set the density  of the next page to the same as that of the flipped\n            if (this.render.getOrientation() === \"landscape\" /* LANDSCAPE */) {\n                if (direction === 1 /* BACK */) {\n                    const nextPage = this.app.getPageCollection().nextBy(this.flippingPage);\n                    if (nextPage !== null) {\n                        if (this.flippingPage.getDensity() !== nextPage.getDensity()) {\n                            this.flippingPage.setDrawingDensity(\"hard\" /* HARD */);\n                            nextPage.setDrawingDensity(\"hard\" /* HARD */);\n                        }\n                    }\n                }\n                else {\n                    const prevPage = this.app.getPageCollection().prevBy(this.flippingPage);\n                    if (prevPage !== null) {\n                        if (this.flippingPage.getDensity() !== prevPage.getDensity()) {\n                            this.flippingPage.setDrawingDensity(\"hard\" /* HARD */);\n                            prevPage.setDrawingDensity(\"hard\" /* HARD */);\n                        }\n                    }\n                }\n            }\n            this.render.setDirection(direction);\n            this.calc = new FlipCalculation(direction, flipCorner, rect.pageWidth.toString(10), // fix bug with type casting\n            rect.height.toString(10) // fix bug with type casting\n            );\n            return true;\n        }\n        catch (e) {\n            return false;\n        }\n    }\n    /**\n     * Perform calculations for the current page position. Pass data to render object\n     *\n     * @param {Point} pagePos - Touch Point Coordinates (relative active page)\n     */\n    do(pagePos) {\n        if (this.calc === null)\n            return; // Flipping process not started\n        if (this.calc.calc(pagePos)) {\n            // Perform calculations for a specific position\n            const progress = this.calc.getFlippingProgress();\n            this.bottomPage.setArea(this.calc.getBottomClipArea());\n            this.bottomPage.setPosition(this.calc.getBottomPagePosition());\n            this.bottomPage.setAngle(0);\n            this.bottomPage.setHardAngle(0);\n            this.flippingPage.setArea(this.calc.getFlippingClipArea());\n            this.flippingPage.setPosition(this.calc.getActiveCorner());\n            this.flippingPage.setAngle(this.calc.getAngle());\n            if (this.calc.getDirection() === 0 /* FORWARD */) {\n                this.flippingPage.setHardAngle((90 * (200 - progress * 2)) / 100);\n            }\n            else {\n                this.flippingPage.setHardAngle((-90 * (200 - progress * 2)) / 100);\n            }\n            this.render.setPageRect(this.calc.getRect());\n            this.render.setBottomPage(this.bottomPage);\n            this.render.setFlippingPage(this.flippingPage);\n            this.render.setShadowData(this.calc.getShadowStartPoint(), this.calc.getShadowAngle(), progress, this.calc.getDirection());\n        }\n    }\n    /**\n     * Turn to the specified page number (with animation)\n     *\n     * @param {number} page - New page number\n     * @param {FlipCorner} corner - Active page corner when turning\n     */\n    flipToPage(page, corner) {\n        const current = this.app.getPageCollection().getCurrentSpreadIndex();\n        const next = this.app.getPageCollection().getSpreadIndexByPage(page);\n        try {\n            if (next > current) {\n                this.app.getPageCollection().setCurrentSpreadIndex(next - 1);\n                this.flipNext(corner);\n            }\n            if (next < current) {\n                this.app.getPageCollection().setCurrentSpreadIndex(next + 1);\n                this.flipPrev(corner);\n            }\n        }\n        catch (e) {\n            //\n        }\n    }\n    /**\n     * Turn to the next page (with animation)\n     *\n     * @param {FlipCorner} corner - Active page corner when turning\n     */\n    flipNext(corner) {\n        this.flip({\n            x: this.render.getRect().left + this.render.getRect().pageWidth * 2 - 10,\n            y: corner === \"top\" /* TOP */ ? 1 : this.render.getRect().height - 2,\n        });\n    }\n    /**\n     * Turn to the prev page (with animation)\n     *\n     * @param {FlipCorner} corner - Active page corner when turning\n     */\n    flipPrev(corner) {\n        this.flip({\n            x: 10,\n            y: corner === \"top\" /* TOP */ ? 1 : this.render.getRect().height - 2,\n        });\n    }\n    /**\n     * Called when the user has stopped flipping\n     */\n    stopMove() {\n        if (this.calc === null)\n            return;\n        const pos = this.calc.getPosition();\n        const rect = this.getBoundsRect();\n        const y = this.calc.getCorner() === \"bottom\" /* BOTTOM */ ? rect.height : 0;\n        if (pos.x <= 0)\n            this.animateFlippingTo(pos, { x: -rect.pageWidth, y }, true);\n        else\n            this.animateFlippingTo(pos, { x: rect.pageWidth, y }, false);\n    }\n    /**\n     * Fold the corners of the book when the mouse pointer is over them.\n     * Called when the mouse pointer is over the book without clicking\n     *\n     * @param globalPos\n     */\n    showCorner(globalPos) {\n        if (!this.checkState(\"read\" /* READ */, \"fold_corner\" /* FOLD_CORNER */))\n            return;\n        const rect = this.getBoundsRect();\n        const pageWidth = rect.pageWidth;\n        if (this.isPointOnCorners(globalPos)) {\n            if (this.calc === null) {\n                if (!this.start(globalPos))\n                    return;\n                this.setState(\"fold_corner\" /* FOLD_CORNER */);\n                this.calc.calc({ x: pageWidth - 1, y: 1 });\n                const fixedCornerSize = 50;\n                const yStart = this.calc.getCorner() === \"bottom\" /* BOTTOM */ ? rect.height - 1 : 1;\n                const yDest = this.calc.getCorner() === \"bottom\" /* BOTTOM */\n                    ? rect.height - fixedCornerSize\n                    : fixedCornerSize;\n                this.animateFlippingTo({ x: pageWidth - 1, y: yStart }, { x: pageWidth - fixedCornerSize, y: yDest }, false, false);\n            }\n            else {\n                this.do(this.render.convertToPage(globalPos));\n            }\n        }\n        else {\n            this.setState(\"read\" /* READ */);\n            this.render.finishAnimation();\n            this.stopMove();\n        }\n    }\n    /**\n     * Starting the flipping animation process\n     *\n     * @param {Point} start - animation start point\n     * @param {Point} dest - animation end point\n     * @param {boolean} isTurned - will the page turn over, or just bring it back\n     * @param {boolean} needReset - reset the flipping process at the end of the animation\n     */\n    animateFlippingTo(start, dest, isTurned, needReset = true) {\n        const points = Helper.GetCordsFromTwoPoint(start, dest);\n        // Create frames\n        const frames = [];\n        for (const p of points)\n            frames.push(() => this.do(p));\n        const duration = this.getAnimationDuration(points.length);\n        this.render.startAnimation(frames, duration, () => {\n            // callback function\n            if (!this.calc)\n                return;\n            if (isTurned) {\n                if (this.calc.getDirection() === 1 /* BACK */)\n                    this.app.turnToPrevPage();\n                else\n                    this.app.turnToNextPage();\n            }\n            if (needReset) {\n                this.render.setBottomPage(null);\n                this.render.setFlippingPage(null);\n                this.render.clearShadow();\n                this.setState(\"read\" /* READ */);\n                this.reset();\n            }\n        });\n    }\n    /**\n     * Get the current calculations object\n     */\n    getCalculation() {\n        return this.calc;\n    }\n    /**\n     * Get current flipping state\n     */\n    getState() {\n        return this.state;\n    }\n    setState(newState) {\n        if (this.state !== newState) {\n            this.app.updateState(newState);\n            this.state = newState;\n        }\n    }\n    getDirectionByPoint(touchPos) {\n        const rect = this.getBoundsRect();\n        if (this.render.getOrientation() === \"portrait\" /* PORTRAIT */) {\n            if (touchPos.x - rect.pageWidth <= rect.width / 5) {\n                return 1 /* BACK */;\n            }\n        }\n        else if (touchPos.x < rect.width / 2) {\n            return 1 /* BACK */;\n        }\n        return 0 /* FORWARD */;\n    }\n    getAnimationDuration(size) {\n        const defaultTime = this.app.getSettings().flippingTime;\n        if (size >= 1000)\n            return defaultTime;\n        return (size / 1000) * defaultTime;\n    }\n    checkDirection(direction) {\n        if (direction === 0 /* FORWARD */)\n            return this.app.getCurrentPageIndex() < this.app.getPageCount() - 1;\n        return this.app.getCurrentPageIndex() >= 1;\n    }\n    reset() {\n        this.calc = null;\n        this.flippingPage = null;\n        this.bottomPage = null;\n    }\n    getBoundsRect() {\n        return this.render.getRect();\n    }\n    checkState(...states) {\n        for (const state of states) {\n            if (this.state === state)\n                return true;\n        }\n        return false;\n    }\n    isPointOnCorners(globalPos) {\n        const rect = this.getBoundsRect();\n        const pageWidth = rect.pageWidth;\n        const operatingDistance = Math.sqrt(Math.pow(pageWidth, 2) + Math.pow(rect.height, 2)) / 5;\n        const bookPos = this.render.convertToBook(globalPos);\n        return (bookPos.x > 0 &&\n            bookPos.y > 0 &&\n            bookPos.x < rect.width &&\n            bookPos.y < rect.height &&\n            (bookPos.x < operatingDistance || bookPos.x > rect.width - operatingDistance) &&\n            (bookPos.y < operatingDistance || bookPos.y > rect.height - operatingDistance));\n    }\n}\n\n/**\n * Class responsible for rendering the book\n */\nclass Render {\n    constructor(app, setting) {\n        /** Left static book page */\n        this.leftPage = null;\n        /** Right static book page */\n        this.rightPage = null;\n        /** Page currently flipping */\n        this.flippingPage = null;\n        /** Next page at the time of flipping */\n        this.bottomPage = null;\n        /** Current flipping direction */\n        this.direction = null;\n        /** Current book orientation */\n        this.orientation = null;\n        /** urrent state of the shadows */\n        this.shadow = null;\n        /** urrent animation process */\n        this.animation = null;\n        /** Page borders while flipping */\n        this.pageRect = null;\n        /** Current book area */\n        this.boundsRect = null;\n        /** Timer started from start of rendering */\n        this.timer = 0;\n        /**\n         * Safari browser definitions for resolving a bug with a css property clip-area\n         *\n         * https://bugs.webkit.org/show_bug.cgi?id=126207\n         */\n        this.safari = false;\n        this.setting = setting;\n        this.app = app;\n        // detect safari\n        const regex = new RegExp('Version\\\\/[\\\\d\\\\.]+.*Safari/');\n        this.safari = regex.exec(window.navigator.userAgent) !== null;\n    }\n    /**\n     * Executed when requestAnimationFrame is called. Performs the current animation process and call drawFrame()\n     *\n     * @param timer\n     */\n    render(timer) {\n        if (this.animation !== null) {\n            // Find current frame of animation\n            const frameIndex = Math.round((timer - this.animation.startedAt) / this.animation.durationFrame);\n            if (frameIndex < this.animation.frames.length) {\n                this.animation.frames[frameIndex]();\n            }\n            else {\n                this.animation.onAnimateEnd();\n                this.animation = null;\n            }\n          }\n        this.timer = timer; // modified by ngx-extended-pdf-viewer\n        this.drawFrame(); // modified by ngx-extended-pdf-viewer\n    }\n    /**\n     * Running requestAnimationFrame, and rendering process\n     */\n    start() {\n        this.update();\n        const loop = (timer) => {\n          window.ngxZone.runOutsideAngular(() => {\n            this.render(timer);\n            requestAnimationFrame(loop);\n          });\n        };\n        window.ngxZone.runOutsideAngular(() => {\n          requestAnimationFrame(loop);\n        });\n    }\n    /**\n     * Start a new animation process\n     *\n     * @param {FrameAction[]} frames - Frame list\n     * @param {number} duration - total animation duration\n     * @param {AnimationSuccessAction} onAnimateEnd - Animation callback function\n     */\n    startAnimation(frames, duration, onAnimateEnd) {\n        this.finishAnimation(); // finish the previous animation process\n        this.animation = {\n            frames,\n            duration,\n            durationFrame: duration / frames.length,\n            onAnimateEnd,\n            startedAt: this.timer,\n        };\n    }\n    /**\n     * End the current animation process and call the callback\n     */\n    finishAnimation() {\n        if (this.animation !== null) {\n            this.animation.frames[this.animation.frames.length - 1]();\n            if (this.animation.onAnimateEnd !== null) {\n                this.animation.onAnimateEnd();\n            }\n        }\n        this.animation = null;\n    }\n    /**\n     * Recalculate the size of the displayed area, and update the page orientation\n     */\n    update() {\n        this.boundsRect = null;\n        const orientation = this.calculateBoundsRect();\n        if (this.orientation !== orientation) {\n            this.orientation = orientation;\n            this.app.updateOrientation(orientation);\n        }\n    }\n    /**\n     * Calculate the size and position of the book depending on the parent element and configuration parameters\n     */\n    calculateBoundsRect() {\n        let orientation = \"landscape\" /* LANDSCAPE */;\n        const blockWidth = this.getBlockWidth();\n        const middlePoint = {\n            x: blockWidth / 2,\n            y: this.getBlockHeight() / 2,\n        };\n        const ratio = this.setting.width / this.setting.height;\n        let pageWidth = this.setting.width;\n        let pageHeight = this.setting.height;\n        let left = middlePoint.x - pageWidth;\n        if (this.setting.size === \"stretch\" /* STRETCH */) {\n            if (blockWidth < this.setting.minWidth * 2 && this.app.getSettings().usePortrait)\n                orientation = \"portrait\" /* PORTRAIT */;\n            pageWidth =\n                orientation === \"portrait\" /* PORTRAIT */\n                    ? this.getBlockWidth()\n                    : this.getBlockWidth() / 2;\n            if (pageWidth > this.setting.maxWidth)\n                pageWidth = this.setting.maxWidth;\n            pageHeight = pageWidth / ratio;\n            if (pageHeight > this.getBlockHeight()) {\n                pageHeight = this.getBlockHeight();\n                pageWidth = pageHeight * ratio;\n            }\n            left =\n                orientation === \"portrait\" /* PORTRAIT */\n                    ? middlePoint.x - pageWidth / 2 - pageWidth\n                    : middlePoint.x - pageWidth;\n        }\n        else {\n            if (blockWidth < pageWidth * 2) {\n                if (this.app.getSettings().usePortrait) {\n                    orientation = \"portrait\" /* PORTRAIT */;\n                    left = middlePoint.x - pageWidth / 2 - pageWidth;\n                }\n            }\n        }\n        this.boundsRect = {\n            left,\n            top: middlePoint.y - pageHeight / 2,\n            width: pageWidth * 2,\n            height: pageHeight,\n            pageWidth: pageWidth,\n        };\n        return orientation;\n    }\n    /**\n     * Set the current parameters of the drop shadow\n     *\n     * @param {Point} pos - Shadow Position Start Point\n     * @param {number} angle - The angle of the shadows relative to the book\n     * @param {number} progress - Flipping progress in percent (0 - 100)\n     * @param {FlipDirection} direction - Flipping Direction, the direction of the shadow gradients\n     */\n    setShadowData(pos, angle, progress, direction) {\n        if (!this.app.getSettings().drawShadow)\n            return;\n        const maxShadowOpacity = 100 * this.getSettings().maxShadowOpacity;\n        this.shadow = {\n            pos,\n            angle,\n            width: (((this.getRect().pageWidth * 3) / 4) * progress) / 100,\n            opacity: ((100 - progress) * maxShadowOpacity) / 100 / 100,\n            direction,\n            progress: progress * 2,\n        };\n    }\n    /**\n     * Clear shadow\n     */\n    clearShadow() {\n        this.shadow = null;\n    }\n    /**\n     * Get parent block offset width\n     */\n    getBlockWidth() {\n        return this.app.getUI().getDistElement().offsetWidth;\n    }\n    /**\n     * Get parent block offset height\n     */\n    getBlockHeight() {\n        return this.app.getUI().getDistElement().offsetHeight;\n    }\n    /**\n     * Get current flipping direction\n     */\n    getDirection() {\n        return this.direction;\n    }\n    /**\n     * urrent size and position of the book\n     */\n    getRect() {\n        if (this.boundsRect === null)\n            this.calculateBoundsRect();\n        return this.boundsRect;\n    }\n    /**\n     * Get configuration object\n     */\n    getSettings() {\n        return this.app.getSettings();\n    }\n    /**\n     * Get current book orientation\n     */\n    getOrientation() {\n        return this.orientation;\n    }\n    /**\n     * Set page area while flipping\n     *\n     * @param direction\n     */\n    setPageRect(pageRect) {\n        this.pageRect = pageRect;\n    }\n    /**\n     * Set flipping direction\n     *\n     * @param direction\n     */\n    setDirection(direction) {\n        this.direction = direction;\n    }\n    /**\n     * Set right static book page\n     *\n     * @param page\n     */\n    setRightPage(page) {\n        if (page !== null)\n            page.setOrientation(1 /* RIGHT */);\n        this.rightPage = page;\n    }\n    /**\n     * Set left static book page\n     * @param page\n     */\n    setLeftPage(page) {\n        if (page !== null)\n            page.setOrientation(0 /* LEFT */);\n        this.leftPage = page;\n    }\n    /**\n     * Set next page at the time of flipping\n     * @param page\n     */\n    setBottomPage(page) {\n        if (page !== null)\n            page.setOrientation(this.direction === 1 /* BACK */ ? 0 /* LEFT */ : 1 /* RIGHT */);\n        this.bottomPage = page;\n    }\n    /**\n     * Set currently flipping page\n     *\n     * @param page\n     */\n    setFlippingPage(page) {\n        if (page !== null)\n            page.setOrientation(this.direction === 0 /* FORWARD */ &&\n                this.orientation !== \"portrait\" /* PORTRAIT */\n                ? 0 /* LEFT */\n                : 1 /* RIGHT */);\n        this.flippingPage = page;\n    }\n    /**\n     * Coordinate conversion function. Window coordinates -> to book coordinates\n     *\n     * @param {Point} pos - Global coordinates relative to the window\n     * @returns {Point} Coordinates relative to the book\n     */\n    convertToBook(pos) {\n        const rect = this.getRect();\n        return {\n            x: pos.x - rect.left,\n            y: pos.y - rect.top,\n        };\n    }\n    isSafari() {\n        return this.safari;\n    }\n    /**\n     * Coordinate conversion function. Window coordinates -> to current coordinates of the working page\n     *\n     * @param {Point} pos - Global coordinates relative to the window\n     * @param {FlipDirection} direction  - Current flipping direction\n     *\n     * @returns {Point} Coordinates relative to the work page\n     */\n    convertToPage(pos, direction) {\n        if (!direction)\n            direction = this.direction;\n        const rect = this.getRect();\n        const x = direction === 0 /* FORWARD */\n            ? pos.x - rect.left - rect.width / 2\n            : rect.width / 2 - pos.x + rect.left;\n        return {\n            x,\n            y: pos.y - rect.top,\n        };\n    }\n    /**\n     * Coordinate conversion function. Coordinates relative to the work page -> Window coordinates\n     *\n     * @param {Point} pos - Coordinates relative to the work page\n     * @param {FlipDirection} direction  - Current flipping direction\n     *\n     * @returns {Point} Global coordinates relative to the window\n     */\n    convertToGlobal(pos, direction) {\n        if (!direction)\n            direction = this.direction;\n        if (pos == null)\n            return null;\n        const rect = this.getRect();\n        const x = direction === 0 /* FORWARD */\n            ? pos.x + rect.left + rect.width / 2\n            : rect.width / 2 - pos.x + rect.left;\n        return {\n            x,\n            y: pos.y + rect.top,\n        };\n    }\n    /**\n     * Casting the coordinates of the corners of the rectangle in the coordinates relative to the window\n     *\n     * @param {RectPoints} rect - Coordinates of the corners of the rectangle relative to the work page\n     * @param {FlipDirection} direction  - Current flipping direction\n     *\n     * @returns {RectPoints} Coordinates of the corners of the rectangle relative to the window\n     */\n    convertRectToGlobal(rect, direction) {\n        if (!direction)\n            direction = this.direction;\n        return {\n            topLeft: this.convertToGlobal(rect.topLeft, direction),\n            topRight: this.convertToGlobal(rect.topRight, direction),\n            bottomLeft: this.convertToGlobal(rect.bottomLeft, direction),\n            bottomRight: this.convertToGlobal(rect.bottomRight, direction),\n        };\n    }\n}\n\n/**\n * Class responsible for rendering the Canvas book\n */\nclass CanvasRender extends Render {\n    constructor(app, setting, inCanvas) {\n        super(app, setting);\n        this.canvas = inCanvas;\n        // #1659 modified by ngx-extended-pdf-viewer\n        const options = window.pdfDefaultOptions.activateWillReadFrequentlyFlag ? { willReadFrequently: true} : undefined;\n        const ctx = canvas.getContext(\"2d\", options);\n        // #1659 end of modification by ngx-extended-pdf-viewer\n    }\n    getContext() {\n        return this.ctx;\n    }\n    reload() {\n        //\n    }\n    drawFrame() {\n        this.clear();\n        if (this.orientation !== \"portrait\" /* PORTRAIT */)\n            if (this.leftPage != null)\n                this.leftPage.simpleDraw(0 /* LEFT */);\n        if (this.rightPage != null)\n            this.rightPage.simpleDraw(1 /* RIGHT */);\n        if (this.bottomPage != null)\n            this.bottomPage.draw();\n        this.drawBookShadow();\n        if (this.flippingPage != null)\n            this.flippingPage.draw();\n        if (this.shadow != null) {\n            this.drawOuterShadow();\n            this.drawInnerShadow();\n        }\n        const rect = this.getRect();\n        if (this.orientation === \"portrait\" /* PORTRAIT */) {\n            this.ctx.beginPath();\n            this.ctx.rect(rect.left + rect.pageWidth, rect.top, rect.width, rect.height);\n            this.ctx.clip();\n        }\n    }\n    drawBookShadow() {\n        const rect = this.getRect();\n        this.ctx.save();\n        this.ctx.beginPath();\n        const shadowSize = rect.width / 20;\n        this.ctx.rect(rect.left, rect.top, rect.width, rect.height);\n        const shadowPos = { x: rect.left + rect.width / 2 - shadowSize / 2, y: 0 };\n        this.ctx.translate(shadowPos.x, shadowPos.y);\n        const outerGradient = this.ctx.createLinearGradient(0, 0, shadowSize, 0);\n        outerGradient.addColorStop(0, 'rgba(0, 0, 0, 0)');\n        outerGradient.addColorStop(0.4, 'rgba(0, 0, 0, 0.2)');\n        outerGradient.addColorStop(0.49, 'rgba(0, 0, 0, 0.1)');\n        outerGradient.addColorStop(0.5, 'rgba(0, 0, 0, 0.5)');\n        outerGradient.addColorStop(0.51, 'rgba(0, 0, 0, 0.4)');\n        outerGradient.addColorStop(1, 'rgba(0, 0, 0, 0)');\n        this.ctx.clip();\n        this.ctx.fillStyle = outerGradient;\n        this.ctx.fillRect(0, 0, shadowSize, rect.height * 2);\n        this.ctx.restore();\n    }\n    drawOuterShadow() {\n        const rect = this.getRect();\n        this.ctx.save();\n        this.ctx.beginPath();\n        this.ctx.rect(rect.left, rect.top, rect.width, rect.height);\n        const shadowPos = this.convertToGlobal({ x: this.shadow.pos.x, y: this.shadow.pos.y });\n        this.ctx.translate(shadowPos.x, shadowPos.y);\n        this.ctx.rotate(Math.PI + this.shadow.angle + Math.PI / 2);\n        const outerGradient = this.ctx.createLinearGradient(0, 0, this.shadow.width, 0);\n        if (this.shadow.direction === 0 /* FORWARD */) {\n            this.ctx.translate(0, -100);\n            outerGradient.addColorStop(0, 'rgba(0, 0, 0, ' + this.shadow.opacity + ')');\n            outerGradient.addColorStop(1, 'rgba(0, 0, 0, 0)');\n        }\n        else {\n            this.ctx.translate(-this.shadow.width, -100);\n            outerGradient.addColorStop(0, 'rgba(0, 0, 0, 0)');\n            outerGradient.addColorStop(1, 'rgba(0, 0, 0, ' + this.shadow.opacity + ')');\n        }\n        this.ctx.clip();\n        this.ctx.fillStyle = outerGradient;\n        this.ctx.fillRect(0, 0, this.shadow.width, rect.height * 2);\n        this.ctx.restore();\n    }\n    drawInnerShadow() {\n        const rect = this.getRect();\n        this.ctx.save();\n        this.ctx.beginPath();\n        const shadowPos = this.convertToGlobal({ x: this.shadow.pos.x, y: this.shadow.pos.y });\n        const pageRect = this.convertRectToGlobal(this.pageRect);\n        this.ctx.moveTo(pageRect.topLeft.x, pageRect.topLeft.y);\n        this.ctx.lineTo(pageRect.topRight.x, pageRect.topRight.y);\n        this.ctx.lineTo(pageRect.bottomRight.x, pageRect.bottomRight.y);\n        this.ctx.lineTo(pageRect.bottomLeft.x, pageRect.bottomLeft.y);\n        this.ctx.translate(shadowPos.x, shadowPos.y);\n        this.ctx.rotate(Math.PI + this.shadow.angle + Math.PI / 2);\n        const isw = (this.shadow.width * 3) / 4;\n        const innerGradient = this.ctx.createLinearGradient(0, 0, isw, 0);\n        if (this.shadow.direction === 0 /* FORWARD */) {\n            this.ctx.translate(-isw, -100);\n            innerGradient.addColorStop(1, 'rgba(0, 0, 0, ' + this.shadow.opacity + ')');\n            innerGradient.addColorStop(0.9, 'rgba(0, 0, 0, 0.05)');\n            innerGradient.addColorStop(0.7, 'rgba(0, 0, 0, ' + this.shadow.opacity + ')');\n            innerGradient.addColorStop(0, 'rgba(0, 0, 0, 0)');\n        }\n        else {\n            this.ctx.translate(0, -100);\n            innerGradient.addColorStop(0, 'rgba(0, 0, 0, ' + this.shadow.opacity + ')');\n            innerGradient.addColorStop(0.1, 'rgba(0, 0, 0, 0.05)');\n            innerGradient.addColorStop(0.3, 'rgba(0, 0, 0, ' + this.shadow.opacity + ')');\n            innerGradient.addColorStop(1, 'rgba(0, 0, 0, 0)');\n        }\n        this.ctx.clip();\n        this.ctx.fillStyle = innerGradient;\n        this.ctx.fillRect(0, 0, isw, rect.height * 2);\n        this.ctx.restore();\n    }\n    clear() {\n        this.ctx.fillStyle = 'white';\n        this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);\n    }\n}\n\n/**\n * UI Class, represents work with DOM\n */\nclass UI {\n    /**\n     * @constructor\n     *\n     * @param {HTMLElement} inBlock - Root HTML Element\n     * @param {PageFlip} app - PageFlip instanse\n     * @param {FlipSetting} setting - Configuration object\n     */\n    constructor(inBlock, app, setting) {\n        this.touchPoint = null;\n        this.swipeTimeout = 250;\n        this.onResize = () => {\n            this.update();\n        };\n        this.onMouseDown = (e) => {\n            if (this.checkTarget(e.target)) {\n                const pos = this.getMousePos(e.clientX, e.clientY);\n                this.app.startUserTouch(pos);\n                e.preventDefault();\n            }\n        };\n        this.onTouchStart = (e) => {\n            if (this.checkTarget(e.target)) {\n                if (e.changedTouches.length > 0) {\n                    const t = e.changedTouches[0];\n                    const pos = this.getMousePos(t.clientX, t.clientY);\n                    this.touchPoint = {\n                        point: pos,\n                        time: Date.now(),\n                    };\n                    // part of swipe detection\n                    setTimeout(() => {\n                        if (this.touchPoint !== null) {\n                            this.app.startUserTouch(pos);\n                        }\n                    }, this.swipeTimeout);\n                    if (!this.app.getSettings().mobileScrollSupport)\n                        e.preventDefault();\n                }\n            }\n        };\n        this.onMouseUp = (e) => {\n            const pos = this.getMousePos(e.clientX, e.clientY);\n            this.app.userStop(pos);\n        };\n        this.onMouseMove = (e) => {\n            const pos = this.getMousePos(e.clientX, e.clientY);\n            this.app.userMove(pos, false);\n        };\n        this.onTouchMove = (e) => {\n            if (e.changedTouches.length > 0) {\n                const t = e.changedTouches[0];\n                const pos = this.getMousePos(t.clientX, t.clientY);\n                if (this.app.getSettings().mobileScrollSupport) {\n                    if (this.touchPoint !== null) {\n                        if (Math.abs(this.touchPoint.point.x - pos.x) > 10 ||\n                            this.app.getState() !== \"read\" /* READ */) {\n                            if (e.cancelable)\n                                this.app.userMove(pos, true);\n                        }\n                    }\n                    if (this.app.getState() !== \"read\" /* READ */) {\n                        e.preventDefault();\n                    }\n                }\n                else {\n                    this.app.userMove(pos, true);\n                }\n            }\n        };\n        this.onTouchEnd = (e) => {\n            if (e.changedTouches.length > 0) {\n                const t = e.changedTouches[0];\n                const pos = this.getMousePos(t.clientX, t.clientY);\n                let isSwipe = false;\n                // swipe detection\n                if (this.touchPoint !== null) {\n                    const dx = pos.x - this.touchPoint.point.x;\n                    const distY = Math.abs(pos.y - this.touchPoint.point.y);\n                    if (Math.abs(dx) > this.swipeDistance &&\n                        distY < this.swipeDistance * 2 &&\n                        Date.now() - this.touchPoint.time < this.swipeTimeout) {\n                        if (dx > 0) {\n                            this.app.flipPrev(this.touchPoint.point.y < this.app.getRender().getRect().height / 2\n                                ? \"top\" /* TOP */\n                                : \"bottom\" /* BOTTOM */);\n                        }\n                        else {\n                            this.app.flipNext(this.touchPoint.point.y < this.app.getRender().getRect().height / 2\n                                ? \"top\" /* TOP */\n                                : \"bottom\" /* BOTTOM */);\n                        }\n                        isSwipe = true;\n                    }\n                    this.touchPoint = null;\n                }\n                this.app.userStop(pos, isSwipe);\n            }\n        };\n        this.parentElement = inBlock;\n        inBlock.classList.add('stf__parent');\n        // Add first wrapper\n        inBlock.insertAdjacentHTML('afterbegin', '<div class=\"stf__wrapper\"></div>');\n        this.wrapper = inBlock.querySelector('.stf__wrapper');\n        this.app = app;\n        const k = this.app.getSettings().usePortrait ? 1 : 2;\n        // Setting block sizes based on configuration\n        inBlock.style.minWidth = setting.minWidth * k + 'px';\n        inBlock.style.minHeight = setting.minHeight + 'px';\n        if (setting.size === \"fixed\" /* FIXED */) {\n            inBlock.style.minWidth = setting.width * k + 'px';\n            inBlock.style.minHeight = setting.height + 'px';\n        }\n        if (setting.autoSize) {\n            inBlock.style.width = '100%';\n            inBlock.style.maxWidth = setting.maxWidth * 2 + 'px';\n        }\n        inBlock.style.display = 'block';\n        window.addEventListener('resize', this.onResize, false);\n        this.swipeDistance = setting.swipeDistance;\n    }\n    /**\n     * Destructor. Remove all HTML elements and all event handlers\n     */\n    destroy() {\n        if (this.app.getSettings().useMouseEvents)\n            this.removeHandlers();\n        this.distElement.remove();\n        this.wrapper.remove();\n    }\n    /**\n     * Get parent element for book\n     *\n     * @returns {HTMLElement}\n     */\n    getDistElement() {\n        return this.distElement;\n    }\n    /**\n     * Get wrapper element\n     *\n     * @returns {HTMLElement}\n     */\n    getWrapper() {\n        return this.wrapper;\n    }\n    /**\n     * Updates styles and sizes based on book orientation\n     *\n     * @param {Orientation} orientation - New book orientation\n     */\n    setOrientationStyle(orientation) {\n        this.wrapper.classList.remove('--portrait', '--landscape');\n        if (orientation === \"portrait\" /* PORTRAIT */) {\n            if (this.app.getSettings().autoSize)\n                this.wrapper.style.paddingBottom =\n                    (this.app.getSettings().height / this.app.getSettings().width) * 100 + '%';\n            this.wrapper.classList.add('--portrait');\n        }\n        else {\n            if (this.app.getSettings().autoSize)\n                this.wrapper.style.paddingBottom =\n                    (this.app.getSettings().height / (this.app.getSettings().width * 2)) * 100 +\n                        '%';\n            this.wrapper.classList.add('--landscape');\n        }\n        this.update();\n    }\n    removeHandlers() {\n        window.removeEventListener('resize', this.onResize);\n        this.distElement.removeEventListener('mousedown', this.onMouseDown);\n        this.distElement.removeEventListener('touchstart', this.onTouchStart);\n        window.removeEventListener('mousemove', this.onMouseMove);\n        window.removeEventListener('touchmove', this.onTouchMove);\n        window.removeEventListener('mouseup', this.onMouseUp);\n        window.removeEventListener('touchend', this.onTouchEnd);\n    }\n    setHandlers() {\n        window.addEventListener('resize', this.onResize, false);\n        if (!this.app.getSettings().useMouseEvents)\n            return;\n        this.distElement.addEventListener('mousedown', this.onMouseDown);\n        this.distElement.addEventListener('touchstart', this.onTouchStart);\n        window.addEventListener('mousemove', this.onMouseMove);\n        window.addEventListener('touchmove', this.onTouchMove, {\n            passive: !this.app.getSettings().mobileScrollSupport,\n        });\n        window.addEventListener('mouseup', this.onMouseUp);\n        window.addEventListener('touchend', this.onTouchEnd);\n    }\n    /**\n     * Convert global coordinates to relative book coordinates\n     *\n     * @param x\n     * @param y\n     */\n    getMousePos(x, y) {\n        const rect = this.distElement.getBoundingClientRect();\n        return {\n            x: x - rect.left,\n            y: y - rect.top,\n        };\n    }\n    checkTarget(targer) {\n        if (!this.app.getSettings().clickEventForward)\n            return true;\n        if (['a', 'button'].includes(targer.tagName.toLowerCase())) {\n            return false;\n        }\n        return true;\n    }\n}\n\n/**\n * UI for HTML mode\n */\nclass HTMLUI extends UI {\n    constructor(inBlock, app, setting, items) {\n        super(inBlock, app, setting);\n        // Second wrapper to HTML page\n        this.wrapper.insertAdjacentHTML('afterbegin', '<div class=\"stf__block\"></div>');\n        this.distElement = inBlock.querySelector('.stf__block');\n        this.items = items;\n        for (const item of items) {\n            this.distElement.appendChild(item);\n        }\n        this.setHandlers();\n    }\n    clear() {\n        for (const item of this.items) {\n            this.parentElement.appendChild(item);\n        }\n    }\n    /**\n     * Update page list from HTMLElements\n     *\n     * @param {(NodeListOf<HTMLElement>|HTMLElement[])} items - List of pages as HTML Element\n     */\n    updateItems(items) {\n        this.removeHandlers();\n        this.distElement.innerHTML = '';\n        for (const item of items) {\n            this.distElement.appendChild(item);\n        }\n        this.items = items;\n        this.setHandlers();\n    }\n    update() {\n        this.app.getRender().update();\n    }\n}\n\n/**\n * UI for canvas mode\n */\nclass CanvasUI extends UI {\n    constructor(inBlock, app, setting) {\n        super(inBlock, app, setting);\n        this.wrapper.innerHTML = '<canvas class=\"stf__canvas\"></canvas>';\n        this.canvas = inBlock.querySelectorAll('canvas')[0];\n        this.distElement = this.canvas;\n        this.resizeCanvas();\n        this.setHandlers();\n    }\n    resizeCanvas() {\n        const cs = getComputedStyle(this.canvas);\n        const width = parseInt(cs.getPropertyValue('width'), 10);\n        const height = parseInt(cs.getPropertyValue('height'), 10);\n        this.canvas.width = width;\n        this.canvas.height = height;\n    }\n    /**\n     * Get canvas element\n     */\n    getCanvas() {\n        return this.canvas;\n    }\n    update() {\n        this.resizeCanvas();\n        this.app.getRender().update();\n    }\n}\n\n/**\n * A class implementing a basic event model\n */\nclass EventObject {\n    constructor() {\n        this.events = new Map();\n    }\n    /**\n     * Add new event handler\n     *\n     * @param {string} eventName\n     * @param {EventCallback} callback\n     */\n    on(eventName, callback) {\n        if (!this.events.has(eventName)) {\n            this.events.set(eventName, [callback]);\n        }\n        else {\n            this.events.get(eventName).push(callback);\n        }\n        return this;\n    }\n    /**\n     * Removing all handlers from an event\n     *\n     * @param {string} event - Event name\n     */\n    off(event) {\n        this.events.delete(event);\n    }\n    trigger(eventName, app, data = null) {\n        if (!this.events.has(eventName))\n            return;\n        for (const callback of this.events.get(eventName)) {\n            callback({ data, object: app });\n        }\n    }\n}\n\n/**\n * Class responsible for rendering the HTML book\n */\nclass HTMLRender extends Render {\n    /**\n     * @constructor\n     *\n     * @param {PageFlip} app - PageFlip object\n     * @param {FlipSetting} setting - Configuration object\n     * @param {HTMLElement} element - Parent HTML Element\n     */\n    constructor(app, setting, element) {\n        super(app, setting);\n        this.outerShadow = null;\n        this.innerShadow = null;\n        this.hardShadow = null;\n        this.hardInnerShadow = null;\n        this.element = element;\n        this.createShadows();\n    }\n    createShadows() {\n        this.element.insertAdjacentHTML('beforeend', `<div class=\"stf__outerShadow\"></div>\n             <div class=\"stf__innerShadow\"></div>\n             <div class=\"stf__hardShadow\"></div>\n             <div class=\"stf__hardInnerShadow\"></div>`);\n        this.outerShadow = this.element.querySelector('.stf__outerShadow');\n        this.innerShadow = this.element.querySelector('.stf__innerShadow');\n        this.hardShadow = this.element.querySelector('.stf__hardShadow');\n        this.hardInnerShadow = this.element.querySelector('.stf__hardInnerShadow');\n    }\n    clearShadow() {\n        super.clearShadow();\n        this.outerShadow.style.cssText = 'display: none';\n        this.innerShadow.style.cssText = 'display: none';\n        this.hardShadow.style.cssText = 'display: none';\n        this.hardInnerShadow.style.cssText = 'display: none';\n    }\n    reload() {\n        const testShadow = this.element.querySelector('.stf__outerShadow');\n        if (!testShadow) {\n            this.createShadows();\n        }\n    }\n    /**\n     * Draw inner shadow to the hard page\n     */\n    drawHardInnerShadow() {\n        const rect = this.getRect();\n        const progress = this.shadow.progress > 100 ? 200 - this.shadow.progress : this.shadow.progress;\n        let innerShadowSize = ((100 - progress) * (2.5 * rect.pageWidth)) / 100 + 20;\n        if (innerShadowSize > rect.pageWidth)\n            innerShadowSize = rect.pageWidth;\n        let newStyle = `\n            display: block;\n            z-index: ${(this.getSettings().startZIndex + 5).toString(10)};\n            width: ${innerShadowSize}px;\n            height: ${rect.height}px;\n            background: linear-gradient(to right,\n                rgba(0, 0, 0, ${(this.shadow.opacity * progress) / 100}) 5%,\n                rgba(0, 0, 0, 0) 100%);\n            left: ${rect.left + rect.width / 2}px;\n            transform-origin: 0 0;\n        `;\n        newStyle +=\n            (this.getDirection() === 0 /* FORWARD */ && this.shadow.progress > 100) ||\n                (this.getDirection() === 1 /* BACK */ && this.shadow.progress <= 100)\n                ? `transform: translate3d(0, 0, 0);`\n                : `transform: translate3d(0, 0, 0) rotateY(180deg);`;\n        this.hardInnerShadow.style.cssText = newStyle;\n    }\n    /**\n     * Draw outer shadow to the hard page\n     */\n    drawHardOuterShadow() {\n        const rect = this.getRect();\n        const progress = this.shadow.progress > 100 ? 200 - this.shadow.progress : this.shadow.progress;\n        let shadowSize = ((100 - progress) * (2.5 * rect.pageWidth)) / 100 + 20;\n        if (shadowSize > rect.pageWidth)\n            shadowSize = rect.pageWidth;\n        let newStyle = `\n            display: block;\n            z-index: ${(this.getSettings().startZIndex + 4).toString(10)};\n            width: ${shadowSize}px;\n            height: ${rect.height}px;\n            background: linear-gradient(to left, rgba(0, 0, 0, ${this.shadow.opacity}) 5%, rgba(0, 0, 0, 0) 100%);\n            left: ${rect.left + rect.width / 2}px;\n            transform-origin: 0 0;\n        `;\n        newStyle +=\n            (this.getDirection() === 0 /* FORWARD */ && this.shadow.progress > 100) ||\n                (this.getDirection() === 1 /* BACK */ && this.shadow.progress <= 100)\n                ? `transform: translate3d(0, 0, 0) rotateY(180deg);`\n                : `transform: translate3d(0, 0, 0);`;\n        this.hardShadow.style.cssText = newStyle;\n    }\n    /**\n     * Draw inner shadow to the soft page\n     */\n    drawInnerShadow() {\n        const rect = this.getRect();\n        const innerShadowSize = (this.shadow.width * 3) / 4;\n        const shadowTranslate = this.getDirection() === 0 /* FORWARD */ ? innerShadowSize : 0;\n        const shadowDirection = this.getDirection() === 0 /* FORWARD */ ? 'to left' : 'to right';\n        const shadowPos = this.convertToGlobal(this.shadow.pos);\n        const angle = this.shadow.angle + (3 * Math.PI) / 2;\n        const clip = [\n            this.pageRect.topLeft,\n            this.pageRect.topRight,\n            this.pageRect.bottomRight,\n            this.pageRect.bottomLeft,\n        ];\n        let polygon = 'polygon( ';\n        for (const p of clip) {\n            let g = this.getDirection() === 1 /* BACK */\n                ? {\n                    x: -p.x + this.shadow.pos.x,\n                    y: p.y - this.shadow.pos.y,\n                }\n                : {\n                    x: p.x - this.shadow.pos.x,\n                    y: p.y - this.shadow.pos.y,\n                };\n            g = Helper.GetRotatedPoint(g, { x: shadowTranslate, y: 100 }, angle);\n            polygon += g.x + 'px ' + g.y + 'px, ';\n        }\n        polygon = polygon.slice(0, -2);\n        polygon += ')';\n        const newStyle = `\n            display: block;\n            z-index: ${(this.getSettings().startZIndex + 10).toString(10)};\n            width: ${innerShadowSize}px;\n            height: ${rect.height * 2}px;\n            background: linear-gradient(${shadowDirection},\n                rgba(0, 0, 0, ${this.shadow.opacity}) 5%,\n                rgba(0, 0, 0, 0.05) 15%,\n                rgba(0, 0, 0, ${this.shadow.opacity}) 35%,\n                rgba(0, 0, 0, 0) 100%);\n            transform-origin: ${shadowTranslate}px 100px;\n            transform: translate3d(${shadowPos.x - shadowTranslate}px, ${shadowPos.y - 100}px, 0) rotate(${angle}rad);\n            clip-path: ${polygon};\n            -webkit-clip-path: ${polygon};\n        `;\n        this.innerShadow.style.cssText = newStyle;\n    }\n    /**\n     * Draw outer shadow to the soft page\n     */\n    drawOuterShadow() {\n        const rect = this.getRect();\n        const shadowPos = this.convertToGlobal({ x: this.shadow.pos.x, y: this.shadow.pos.y });\n        const angle = this.shadow.angle + (3 * Math.PI) / 2;\n        const shadowTranslate = this.getDirection() === 1 /* BACK */ ? this.shadow.width : 0;\n        const shadowDirection = this.getDirection() === 0 /* FORWARD */ ? 'to right' : 'to left';\n        const clip = [\n            { x: 0, y: 0 },\n            { x: rect.pageWidth, y: 0 },\n            { x: rect.pageWidth, y: rect.height },\n            { x: 0, y: rect.height },\n        ];\n        let polygon = 'polygon( ';\n        for (const p of clip) {\n            if (p !== null) {\n                let g = this.getDirection() === 1 /* BACK */\n                    ? {\n                        x: -p.x + this.shadow.pos.x,\n                        y: p.y - this.shadow.pos.y,\n                    }\n                    : {\n                        x: p.x - this.shadow.pos.x,\n                        y: p.y - this.shadow.pos.y,\n                    };\n                g = Helper.GetRotatedPoint(g, { x: shadowTranslate, y: 100 }, angle);\n                polygon += g.x + 'px ' + g.y + 'px, ';\n            }\n        }\n        polygon = polygon.slice(0, -2);\n        polygon += ')';\n        const newStyle = `\n            display: block;\n            z-index: ${(this.getSettings().startZIndex + 10).toString(10)};\n            width: ${this.shadow.width}px;\n            height: ${rect.height * 2}px;\n            background: linear-gradient(${shadowDirection}, rgba(0, 0, 0, ${this.shadow.opacity}), rgba(0, 0, 0, 0));\n            transform-origin: ${shadowTranslate}px 100px;\n            transform: translate3d(${shadowPos.x - shadowTranslate}px, ${shadowPos.y - 100}px, 0) rotate(${angle}rad);\n            clip-path: ${polygon};\n            -webkit-clip-path: ${polygon};\n        `;\n        this.outerShadow.style.cssText = newStyle;\n    }\n    /**\n     * Draw left static page\n     */\n    drawLeftPage() {\n        if (this.orientation === \"portrait\" /* PORTRAIT */ || this.leftPage === null)\n            return;\n        if (this.direction === 1 /* BACK */ &&\n            this.flippingPage !== null &&\n            this.flippingPage.getDrawingDensity() === \"hard\" /* HARD */) {\n            const angle = this.flippingPage.getHardAngle();\n            if (angle < -90) {\n                this.leftPage.getElement().style.zIndex = (this.getSettings().startZIndex + 5).toString(10);\n                this.leftPage.setHardDrawingAngle(180 + this.flippingPage.getHardAngle());\n                this.leftPage.draw(this.flippingPage.getDrawingDensity());\n            } else {\n                this.leftPage.getElement().style.display=\"none\";\n            }\n        }\n        else {\n            this.leftPage.simpleDraw(0 /* LEFT */);\n        }\n    }\n    /**\n     * Draw right static page\n     */\n    drawRightPage() {\n        if (this.rightPage === null)\n            return;\n        if (this.direction === 0 /* FORWARD */ &&\n            this.flippingPage !== null &&\n            this.flippingPage.getDrawingDensity() === \"hard\" /* HARD */) {\n            const angle = this.flippingPage.getHardAngle();\n            if (angle > 90) {\n                this.rightPage.getElement().style.zIndex = (this.getSettings().startZIndex + 5).toString(10);\n                this.rightPage.setHardDrawingAngle(180 + this.flippingPage.getHardAngle());\n                this.rightPage.draw(this.flippingPage.getDrawingDensity());\n            } else {\n                this.rightPage.getElement().style.display=\"none\";\n            }\n        }\n        else {\n            this.rightPage.simpleDraw(1 /* RIGHT */);\n        }\n    }\n    /**\n     * Draw the next page at the time of flipping\n     */\n    drawBottomPage() {\n        if (this.bottomPage === null)\n            return;\n        const tempDensity = this.flippingPage != null ? this.flippingPage.getDrawingDensity() : null;\n        if (!(this.orientation === \"portrait\" /* PORTRAIT */ && this.direction === 1 /* BACK */)) {\n            this.bottomPage.getElement().style.zIndex = (this.getSettings().startZIndex + 3).toString(10);\n            this.bottomPage.draw(tempDensity);\n        }\n    }\n    drawFrame() {\n        if (this.flippingPage !== null) {\n            if (this.flippingPage.getHardAngle() === this.lastAngle) {\n                return;\n            }\n            this.lastAngle = this.flippingPage.getHardAngle();\n        } else {\n            this.lastAngle=-1234; // some non-existing value\n\n        }\n        this.clear();\n        this.drawLeftPage();\n        this.drawRightPage();\n        this.drawBottomPage();\n        if (this.flippingPage != null) {\n            const angle = this.flippingPage.state.hardDrawingAngle;\n            if (angle <= 90) {\n                this.flippingPage.getElement().style.zIndex = (this.getSettings().startZIndex + 5).toString(10);\n                this.flippingPage.draw();\n            } else {\n                this.flippingPage.getElement().style.display=\"none\";\n            }\n        }\n        if (this.shadow != null && this.flippingPage !== null) {\n            if (this.flippingPage.getDrawingDensity() === \"soft\" /* SOFT */) {\n                this.drawOuterShadow();\n                this.drawInnerShadow();\n            }\n            else {\n                this.drawHardOuterShadow();\n                this.drawHardInnerShadow();\n            }\n        }\n    }\n    clear() {\n        for (const page of this.app.getPageCollection().getPages()) {\n            if (page !== this.leftPage &&\n                page !== this.rightPage &&\n                page !== this.flippingPage &&\n                page !== this.bottomPage) {\n              const style = page.getElement().style;\n              if (style.display !== 'none') {\n                style.cssText = 'display: none';\n              }\n            }\n\n            if (page.getTemporaryCopy() !== this.flippingPage) {\n                page.hideTemporaryCopy();\n            }\n        }\n    }\n    update() {\n        super.update();\n        if (this.rightPage !== null) {\n            this.rightPage.setOrientation(1 /* RIGHT */);\n        }\n        if (this.leftPage !== null) {\n            this.leftPage.setOrientation(0 /* LEFT */);\n        }\n    }\n}\n\nclass Settings {\n    constructor() {\n        this._default = {\n            startPage: 0,\n            size: \"fixed\" /* FIXED */,\n            width: 0,\n            height: 0,\n            minWidth: 0,\n            maxWidth: 0,\n            minHeight: 0,\n            maxHeight: 0,\n            drawShadow: true,\n            flippingTime: 1000,\n            usePortrait: true,\n            startZIndex: 0,\n            autoSize: true,\n            maxShadowOpacity: 1,\n            showCover: false,\n            mobileScrollSupport: true,\n            swipeDistance: 30,\n            clickEventForward: true,\n            useMouseEvents: true,\n            showPageCorners: true,\n            disableFlipByClick: false,\n        };\n    }\n    /**\n     * Processing parameters received from the user. Substitution default values\n     *\n     * @param userSetting\n     * @returns {FlipSetting} onfiguration object\n     */\n    getSettings(userSetting) {\n        const result = this._default;\n        Object.assign(result, userSetting);\n        if (result.size !== \"stretch\" /* STRETCH */ && result.size !== \"fixed\" /* FIXED */)\n            throw new Error('Invalid size type. Available only \"fixed\" and \"stretch\" value');\n        if (result.width <= 0 || result.height <= 0)\n            throw new Error('Invalid width or height');\n        if (result.flippingTime <= 0)\n            throw new Error('Invalid flipping time');\n        if (result.size === \"stretch\" /* STRETCH */) {\n            if (result.minWidth <= 0)\n                result.minWidth = 100;\n            if (result.maxWidth < result.minWidth)\n                result.maxWidth = 2000;\n            if (result.minHeight <= 0)\n                result.minHeight = 100;\n            if (result.maxHeight < result.minHeight)\n                result.maxHeight = 2000;\n        }\n        else {\n            result.minWidth = result.width;\n            result.maxWidth = result.width;\n            result.minHeight = result.height;\n            result.maxHeight = result.height;\n        }\n        return result;\n    }\n}\n\nfunction styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar css_248z = \".stf__parent {\\n  position: relative;\\n  display: block;\\n  box-sizing: border-box;\\n  transform: translateZ(0);\\n\\n  -ms-touch-action: pan-y;\\n  touch-action: pan-y;\\n}\\n\\n.sft__wrapper {\\n  position: relative;\\n  width: 100%;\\n  box-sizing: border-box;\\n}\\n\\n.stf__parent canvas {\\n  position: absolute;\\n  width: 100%;\\n  height: 100%;\\n  left: 0;\\n  top: 0;\\n}\\n\\n.stf__block {\\n  position: absolute;\\n  width: 100%;\\n  height: 100%;\\n  box-sizing: border-box;\\n  perspective: 2000px;\\n}\\n\\n.stf__item {\\n  display: none;\\n  position: absolute;\\n  transform-style: preserve-3d;\\n}\\n\\n.stf__outerShadow {\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n}\\n\\n.stf__innerShadow {\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n}\\n\\n.stf__hardShadow {\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n}\\n\\n.stf__hardInnerShadow {\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n}\";\nstyleInject(css_248z);\n\n/**\n * Class representing a main PageFlip object\n *\n * @extends EventObject\n */\nclass PageFlip extends EventObject {\n    /**\n     * Create a new PageFlip instance\n     *\n     * @constructor\n     * @param {HTMLElement} inBlock - Root HTML Element\n     * @param {Object} setting - Configuration object\n     */\n    constructor(inBlock, setting) {\n        super();\n        this.isUserTouch = false;\n        this.isUserMove = false;\n        this.setting = null;\n        this.pages = null;\n        this.setting = new Settings().getSettings(setting);\n        this.block = inBlock;\n    }\n    /**\n     * Destructor. Remove a root HTML element and all event handlers\n     */\n    destroy() {\n        this.ui.destroy();\n        // #1415 modified by ngx-extended-pdf-viewer\n        // this.block.remove(); // this would remove the viewer div\n        // #1415 end of modification by ngx-extended-pdf-viewer\n    }\n    /**\n     * Update the render area. Re-show current page.\n     */\n    update() {\n        this.render.update();\n        this.pages.show();\n    }\n    /**\n     * Load pages from images on the Canvas mode\n     *\n     * @param {string[]} imagesHref - List of paths to images\n     */\n    loadFromImages(imagesHref) {\n        this.ui = new CanvasUI(this.block, this, this.setting);\n        const canvas = this.ui.getCanvas();\n        this.render = new CanvasRender(this, this.setting, canvas);\n        this.flipController = new Flip(this.render, this);\n        this.pages = new ImagePageCollection(this, this.render, imagesHref);\n        this.pages.load();\n        this.render.start();\n        this.pages.show(this.setting.startPage);\n        // safari fix\n        setTimeout(() => {\n            this.ui.update();\n            this.trigger('init', this, {\n                page: this.setting.startPage,\n                mode: this.render.getOrientation(),\n            });\n        }, 1);\n    }\n    /**\n     * Load pages from HTML elements on the HTML mode\n     *\n     * @param {(NodeListOf<HTMLElement>|HTMLElement[])} items - List of pages as HTML Element\n     */\n    loadFromHTML(items) {\n        this.ui = new HTMLUI(this.block, this, this.setting, items);\n        this.render = new HTMLRender(this, this.setting, this.ui.getDistElement());\n        this.flipController = new Flip(this.render, this);\n        this.pages = new HTMLPageCollection(this, this.render, this.ui.getDistElement(), items);\n        this.pages.load();\n        this.render.start();\n        this.pages.show(this.setting.startPage);\n        // safari fix\n        setTimeout(() => {\n            this.ui.update();\n            this.trigger('init', this, {\n                page: this.setting.startPage,\n                mode: this.render.getOrientation(),\n            });\n        }, 1);\n    }\n    /**\n     * Update current pages from images\n     *\n     * @param {string[]} imagesHref - List of paths to images\n     */\n    updateFromImages(imagesHref) {\n        const current = this.pages.getCurrentPageIndex();\n        this.pages.destroy();\n        this.pages = new ImagePageCollection(this, this.render, imagesHref);\n        this.pages.load();\n        this.pages.show(current);\n        this.trigger('update', this, {\n            page: current,\n            mode: this.render.getOrientation(),\n        });\n    }\n    /**\n     * Update current pages from HTML\n     *\n     * @param {(NodeListOf<HTMLElement>|HTMLElement[])} items - List of pages as HTML Element\n     */\n    updateFromHtml(items) {\n        const current = this.pages.getCurrentPageIndex();\n        this.pages.destroy();\n        this.pages = new HTMLPageCollection(this, this.render, this.ui.getDistElement(), items);\n        this.pages.load();\n        this.ui.updateItems(items);\n        this.render.reload();\n        this.pages.show(current);\n        this.trigger('update', this, {\n            page: current,\n            mode: this.render.getOrientation(),\n        });\n    }\n    /**\n     * Clear pages from HTML (remove to initinalState)\n     */\n    clear() {\n        this.pages.destroy();\n        this.ui.clear();\n    }\n    /**\n     * Turn to the previous page (without animation)\n     */\n    turnToPrevPage() {\n        this.pages.showPrev();\n    }\n    /**\n     * Turn to the next page (without animation)\n     */\n    turnToNextPage() {\n        this.pages.showNext();\n    }\n    /**\n     * Turn to the specified page number (without animation)\n     *\n     * @param {number} page - New page number\n     */\n    turnToPage(page) {\n        this.pages.show(page);\n    }\n    /**\n     * Turn to the next page (with animation)\n     *\n     * @param {FlipCorner} corner - Active page corner when turning\n     */\n    flipNext(corner = \"top\" /* TOP */) {\n        this.flipController.flipNext(corner);\n    }\n    /**\n     * Turn to the prev page (with animation)\n     *\n     * @param {FlipCorner} corner - Active page corner when turning\n     */\n    flipPrev(corner = \"top\" /* TOP */) {\n        this.flipController.flipPrev(corner);\n    }\n    /**\n     * Turn to the specified page number (with animation)\n     *\n     * @param {number} page - New page number\n     * @param {FlipCorner} corner - Active page corner when turning\n     */\n    flip(page, corner = \"top\" /* TOP */) {\n        this.flipController.flipToPage(page, corner);\n    }\n    /**\n     * Call a state change event trigger\n     *\n     * @param {FlippingState} newState - New  state of the object\n     */\n    updateState(newState) {\n        this.trigger('changeState', this, newState);\n    }\n    /**\n     * Call a page number change event trigger\n     *\n     * @param {number} newPage - New page Number\n     */\n    updatePageIndex(newPage) {\n        this.trigger('flip', this, newPage);\n    }\n    /**\n     * Call a page orientation change event trigger. Update UI and rendering area\n     *\n     * @param {Orientation} newOrientation - New page orientation (portrait, landscape)\n     */\n    updateOrientation(newOrientation) {\n        this.ui.setOrientationStyle(newOrientation);\n        this.update();\n        this.trigger('changeOrientation', this, newOrientation);\n    }\n    /**\n     * Get the total number of pages in a book\n     *\n     * @returns {number}\n     */\n    getPageCount() {\n        return this.pages.getPageCount();\n    }\n    /**\n     * Get the index of the current page in the page list (starts at 0)\n     *\n     * @returns {number}\n     */\n    getCurrentPageIndex() {\n        return this.pages.getCurrentPageIndex();\n    }\n    /**\n     * Get page from collection by number\n     *\n     * @param {number} pageIndex\n     * @returns {Page}\n     */\n    getPage(pageIndex) {\n        return this.pages.getPage(pageIndex);\n    }\n    /**\n     * Get the current rendering object\n     *\n     * @returns {Render}\n     */\n    getRender() {\n        return this.render;\n    }\n    /**\n     * Get current object responsible for flipping\n     *\n     * @returns {Flip}\n     */\n    getFlipController() {\n        return this.flipController;\n    }\n    /**\n     * Get current page orientation\n     *\n     * @returns {Orientation} urrent orientation: portrait or landscape\n     */\n    getOrientation() {\n        return this.render.getOrientation();\n    }\n    /**\n     * Get current book sizes and position\n     *\n     * @returns {PageRect}\n     */\n    getBoundsRect() {\n        return this.render.getRect();\n    }\n    /**\n     * Get configuration object\n     *\n     * @returns {FlipSetting}\n     */\n    getSettings() {\n        return this.setting;\n    }\n    /**\n     * Get UI object\n     *\n     * @returns {UI}\n     */\n    getUI() {\n        return this.ui;\n    }\n    /**\n     * Get current flipping state\n     *\n     * @returns {FlippingState}\n     */\n    getState() {\n        return this.flipController.getState();\n    }\n    /**\n     * Get page collection\n     *\n     * @returns {PageCollection}\n     */\n    getPageCollection() {\n        return this.pages;\n    }\n    /**\n     * Start page turning. Called when a user clicks or touches\n     *\n     * @param {Point} pos - Touch position in coordinates relative to the book\n     */\n    startUserTouch(pos) {\n        this.mousePosition = pos; // Save touch position\n        this.isUserTouch = true;\n        this.isUserMove = false;\n    }\n    /**\n     * Called when a finger / mouse moves\n     *\n     * @param {Point} pos - Touch position in coordinates relative to the book\n     * @param {boolean} isTouch - True if there was a touch event, not a mouse click\n     */\n    userMove(pos, isTouch) {\n        if (!this.isUserTouch && !isTouch && this.setting.showPageCorners) {\n            this.flipController.showCorner(pos); // fold Page Corner\n        }\n        else if (this.isUserTouch) {\n            if (Helper.GetDistanceBetweenTwoPoint(this.mousePosition, pos) > 5) {\n                this.isUserMove = true;\n                this.flipController.fold(pos);\n            }\n        }\n    }\n    /**\n     * alled when the user has stopped touching\n     *\n     * @param {Point} pos - Touch end position in coordinates relative to the book\n     * @param {boolean} isSwipe - true if there was a mobile swipe event\n     */\n    userStop(pos, isSwipe = false) {\n        if (this.isUserTouch) {\n            this.isUserTouch = false;\n            if (!isSwipe) {\n                if (!this.isUserMove)\n                    this.flipController.flip(pos);\n                else\n                    this.flipController.stopMove();\n            }\n        }\n    }\n}\n\nexport { PageFlip };\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** @typedef {import(\"../src/display/api\").PDFDocumentProxy} PDFDocumentProxy */\n/** @typedef {import(\"./event_utils\").EventBus} EventBus */\n/** @typedef {import(\"./interfaces\").IPDFLinkService} IPDFLinkService */\n\nimport { binarySearchFirstItem, scrollIntoView } from \"./ui_utils.js\";\nimport { getCharacterType, getNormalizeWithNFKC } from \"./pdf_find_utils.js\";\nimport { PromiseCapability } from \"pdfjs-lib\";\n\nconst FindState = {\n  FOUND: 0,\n  NOT_FOUND: 1,\n  WRAPPED: 2,\n  PENDING: 3,\n};\n\nconst FIND_TIMEOUT = 250; // ms\nconst MATCH_SCROLL_OFFSET_TOP = -50; // px\nconst MATCH_SCROLL_OFFSET_LEFT = -400; // px\n\nconst CHARACTERS_TO_NORMALIZE = {\n  \"\\u2010\": \"-\", // Hyphen\n  \"\\u2018\": \"'\", // Left single quotation mark\n  \"\\u2019\": \"'\", // Right single quotation mark\n  \"\\u201A\": \"'\", // Single low-9 quotation mark\n  \"\\u201B\": \"'\", // Single high-reversed-9 quotation mark\n  \"\\u201C\": '\"', // Left double quotation mark\n  \"\\u201D\": '\"', // Right double quotation mark\n  \"\\u201E\": '\"', // Double low-9 quotation mark\n  \"\\u201F\": '\"', // Double high-reversed-9 quotation mark\n  \"\\u00BC\": \"1/4\", // Vulgar fraction one quarter\n  \"\\u00BD\": \"1/2\", // Vulgar fraction one half\n  \"\\u00BE\": \"3/4\", // Vulgar fraction three quarters\n};\n\n// These diacritics aren't considered as combining diacritics\n// when searching in a document:\n//   https://searchfox.org/mozilla-central/source/intl/unicharutil/util/is_combining_diacritic.py.\n// The combining class definitions can be found:\n//   https://www.unicode.org/reports/tr44/#Canonical_Combining_Class_Values\n// Category 0 corresponds to [^\\p{Mn}].\nconst DIACRITICS_EXCEPTION = new Set([\n  // UNICODE_COMBINING_CLASS_KANA_VOICING\n  // https://www.compart.com/fr/unicode/combining/8\n  0x3099, 0x309a,\n  // UNICODE_COMBINING_CLASS_VIRAMA (under 0xFFFF)\n  // https://www.compart.com/fr/unicode/combining/9\n  0x094d, 0x09cd, 0x0a4d, 0x0acd, 0x0b4d, 0x0bcd, 0x0c4d, 0x0ccd, 0x0d3b,\n  0x0d3c, 0x0d4d, 0x0dca, 0x0e3a, 0x0eba, 0x0f84, 0x1039, 0x103a, 0x1714,\n  0x1734, 0x17d2, 0x1a60, 0x1b44, 0x1baa, 0x1bab, 0x1bf2, 0x1bf3, 0x2d7f,\n  0xa806, 0xa82c, 0xa8c4, 0xa953, 0xa9c0, 0xaaf6, 0xabed,\n  // 91\n  // https://www.compart.com/fr/unicode/combining/91\n  0x0c56,\n  // 129\n  // https://www.compart.com/fr/unicode/combining/129\n  0x0f71,\n  // 130\n  // https://www.compart.com/fr/unicode/combining/130\n  0x0f72, 0x0f7a, 0x0f7b, 0x0f7c, 0x0f7d, 0x0f80,\n  // 132\n  // https://www.compart.com/fr/unicode/combining/132\n  0x0f74,\n]);\nlet DIACRITICS_EXCEPTION_STR; // Lazily initialized, see below.\n\nconst DIACRITICS_REG_EXP = /\\p{M}+/gu;\nconst SPECIAL_CHARS_REG_EXP =\n  /([.*+?^${}()|[\\]\\\\])|(\\p{P})|(\\s+)|(\\p{M})|(\\p{L})/gu;\nconst NOT_DIACRITIC_FROM_END_REG_EXP = /([^\\p{M}])\\p{M}*$/u;\nconst NOT_DIACRITIC_FROM_START_REG_EXP = /^\\p{M}*([^\\p{M}])/u;\n\n// The range [AC00-D7AF] corresponds to the Hangul syllables.\n// The few other chars are some CJK Compatibility Ideographs.\nconst SYLLABLES_REG_EXP = /[\\uAC00-\\uD7AF\\uFA6C\\uFACF-\\uFAD1\\uFAD5-\\uFAD7]+/g;\nconst SYLLABLES_LENGTHS = new Map();\n// When decomposed (in using NFD) the above syllables will start\n// with one of the chars in this regexp.\nconst FIRST_CHAR_SYLLABLES_REG_EXP =\n  \"[\\\\u1100-\\\\u1112\\\\ud7a4-\\\\ud7af\\\\ud84a\\\\ud84c\\\\ud850\\\\ud854\\\\ud857\\\\ud85f]\";\n\nconst NFKC_CHARS_TO_NORMALIZE = new Map();\n\nlet noSyllablesRegExp = null;\nlet withSyllablesRegExp = null;\n\nfunction normalize(text) {\n  // The diacritics in the text or in the query can be composed or not.\n  // So we use a decomposed text using NFD (and the same for the query)\n  // in order to be sure that diacritics are in the same order.\n\n  // Collect syllables length and positions.\n  const syllablePositions = [];\n  let m;\n  while ((m = SYLLABLES_REG_EXP.exec(text)) !== null) {\n    let { index } = m;\n    for (const char of m[0]) {\n      let len = SYLLABLES_LENGTHS.get(char);\n      if (!len) {\n        len = char.normalize(\"NFD\").length;\n        SYLLABLES_LENGTHS.set(char, len);\n      }\n      syllablePositions.push([len, index++]);\n    }\n  }\n\n  let normalizationRegex;\n  if (syllablePositions.length === 0 && noSyllablesRegExp) {\n    normalizationRegex = noSyllablesRegExp;\n  } else if (syllablePositions.length > 0 && withSyllablesRegExp) {\n    normalizationRegex = withSyllablesRegExp;\n  } else {\n    // Compile the regular expression for text normalization once.\n    const replace = Object.keys(CHARACTERS_TO_NORMALIZE).join(\"\");\n    const toNormalizeWithNFKC = getNormalizeWithNFKC();\n\n    // 3040-309F: Hiragana\n    // 30A0-30FF: Katakana\n    const CJK = \"(?:\\\\p{Ideographic}|[\\u3040-\\u30FF])\";\n    const HKDiacritics = \"(?:\\u3099|\\u309A)\";\n    const regexp = `([${replace}])|([${toNormalizeWithNFKC}])|(${HKDiacritics}\\\\n)|(\\\\p{M}+(?:-\\\\n)?)|(\\\\S-\\\\n)|(${CJK}\\\\n)|(\\\\n)`;\n\n    if (syllablePositions.length === 0) {\n      // Most of the syllables belong to Hangul so there are no need\n      // to search for them in a non-Hangul document.\n      // We use the \\0 in order to have the same number of groups.\n      normalizationRegex = noSyllablesRegExp = new RegExp(\n        regexp + \"|(\\\\u0000)\",\n        \"gum\"\n      );\n    } else {\n      normalizationRegex = withSyllablesRegExp = new RegExp(\n        regexp + `|(${FIRST_CHAR_SYLLABLES_REG_EXP})`,\n        \"gum\"\n      );\n    }\n  }\n\n  // The goal of this function is to normalize the string and\n  // be able to get from an index in the new string the\n  // corresponding index in the old string.\n  // For example if we have: abCd12ef456gh where C is replaced by ccc\n  // and numbers replaced by nothing (it's the case for diacritics), then\n  // we'll obtain the normalized string: abcccdefgh.\n  // So here the reverse map is: [0,1,2,2,2,3,6,7,11,12].\n\n  // The goal is to obtain the array: [[0, 0], [3, -1], [4, -2],\n  // [6, 0], [8, 3]].\n  // which can be used like this:\n  //  - let say that i is the index in new string and j the index\n  //    the old string.\n  //  - if i is in [0; 3[ then j = i + 0\n  //  - if i is in [3; 4[ then j = i - 1\n  //  - if i is in [4; 6[ then j = i - 2\n  //  ...\n  // Thanks to a binary search it's easy to know where is i and what's the\n  // shift.\n  // Let say that the last entry in the array is [x, s] and we have a\n  // substitution at index y (old string) which will replace o chars by n chars.\n  // Firstly, if o === n, then no need to add a new entry: the shift is\n  // the same.\n  // Secondly, if o < n, then we push the n - o elements:\n  // [y - (s - 1), s - 1], [y - (s - 2), s - 2], ...\n  // Thirdly, if o > n, then we push the element: [y - (s - n), o + s - n]\n\n  // Collect diacritics length and positions.\n  const rawDiacriticsPositions = [];\n  while ((m = DIACRITICS_REG_EXP.exec(text)) !== null) {\n    rawDiacriticsPositions.push([m[0].length, m.index]);\n  }\n\n  let normalized = text.normalize(\"NFD\");\n  const positions = [[0, 0]];\n  let rawDiacriticsIndex = 0;\n  let syllableIndex = 0;\n  let shift = 0;\n  let shiftOrigin = 0;\n  let eol = 0;\n  let hasDiacritics = false;\n\n  normalized = normalized.replace(\n    normalizationRegex,\n    (match, p1, p2, p3, p4, p5, p6, p7, p8, i) => {\n      i -= shiftOrigin;\n      if (p1) {\n        // Maybe fractions or quotations mark...\n        const replacement = CHARACTERS_TO_NORMALIZE[p1];\n        const jj = replacement.length;\n        for (let j = 1; j < jj; j++) {\n          positions.push([i - shift + j, shift - j]);\n        }\n        shift -= jj - 1;\n        return replacement;\n      }\n\n      if (p2) {\n        // Use the NFKC representation to normalize the char.\n        let replacement = NFKC_CHARS_TO_NORMALIZE.get(p2);\n        if (!replacement) {\n          replacement = p2.normalize(\"NFKC\");\n          NFKC_CHARS_TO_NORMALIZE.set(p2, replacement);\n        }\n        const jj = replacement.length;\n        for (let j = 1; j < jj; j++) {\n          positions.push([i - shift + j, shift - j]);\n        }\n        shift -= jj - 1;\n        return replacement;\n      }\n\n      if (p3) {\n        // We've a Katakana-Hiragana diacritic followed by a \\n so don't replace\n        // the \\n by a whitespace.\n        hasDiacritics = true;\n\n        // Diacritic.\n        if (i + eol === rawDiacriticsPositions[rawDiacriticsIndex]?.[1]) {\n          ++rawDiacriticsIndex;\n        } else {\n          // i is the position of the first diacritic\n          // so (i - 1) is the position for the letter before.\n          positions.push([i - 1 - shift + 1, shift - 1]);\n          shift -= 1;\n          shiftOrigin += 1;\n        }\n\n        // End-of-line.\n        positions.push([i - shift + 1, shift]);\n        shiftOrigin += 1;\n        eol += 1;\n\n        return p3.charAt(0);\n      }\n\n      if (p4) {\n        const hasTrailingDashEOL = p4.endsWith(\"\\n\");\n        const len = hasTrailingDashEOL ? p4.length - 2 : p4.length;\n\n        // Diacritics.\n        hasDiacritics = true;\n        let jj = len;\n        if (i + eol === rawDiacriticsPositions[rawDiacriticsIndex]?.[1]) {\n          jj -= rawDiacriticsPositions[rawDiacriticsIndex][0];\n          ++rawDiacriticsIndex;\n        }\n\n        for (let j = 1; j <= jj; j++) {\n          // i is the position of the first diacritic\n          // so (i - 1) is the position for the letter before.\n          positions.push([i - 1 - shift + j, shift - j]);\n        }\n        shift -= jj;\n        shiftOrigin += jj;\n\n        if (hasTrailingDashEOL) {\n          // Diacritics are followed by a -\\n.\n          // See comments in `if (p5)` block.\n          i += len - 1;\n          positions.push([i - shift + 1, 1 + shift]);\n          shift += 1;\n          shiftOrigin += 1;\n          eol += 1;\n          return p4.slice(0, len);\n        }\n\n        return p4;\n      }\n\n      if (p5) {\n        // \"X-\\n\" is removed because an hyphen at the end of a line\n        // with not a space before is likely here to mark a break\n        // in a word.\n        // If X is encoded with UTF-32 then it can have a length greater than 1.\n        // The \\n isn't in the original text so here y = i, n = X.len - 2 and\n        // o = X.len - 1.\n        const len = p5.length - 2;\n        positions.push([i - shift + len, 1 + shift]);\n        shift += 1;\n        shiftOrigin += 1;\n        eol += 1;\n        return p5.slice(0, -2);\n      }\n\n      if (p6) {\n        // An ideographic at the end of a line doesn't imply adding an extra\n        // white space.\n        // A CJK can be encoded in UTF-32, hence their length isn't always 1.\n        const len = p6.length - 1;\n        positions.push([i - shift + len, shift]);\n        shiftOrigin += 1;\n        eol += 1;\n        return p6.slice(0, -1);\n      }\n\n      if (p7) {\n        // eol is replaced by space: \"foo\\nbar\" is likely equivalent to\n        // \"foo bar\".\n        positions.push([i - shift + 1, shift - 1]);\n        shift -= 1;\n        shiftOrigin += 1;\n        eol += 1;\n        return \" \";\n      }\n\n      // p8\n      if (i + eol === syllablePositions[syllableIndex]?.[1]) {\n        // A syllable (1 char) is replaced with several chars (n) so\n        // newCharsLen = n - 1.\n        const newCharLen = syllablePositions[syllableIndex][0] - 1;\n        ++syllableIndex;\n        for (let j = 1; j <= newCharLen; j++) {\n          positions.push([i - (shift - j), shift - j]);\n        }\n        shift -= newCharLen;\n        shiftOrigin += newCharLen;\n      }\n      return p8;\n    }\n  );\n\n  positions.push([normalized.length, shift]);\n\n  return [normalized, positions, hasDiacritics];\n}\n\n// Determine the original, non-normalized, match index such that highlighting of\n// search results is correct in the `textLayer` for strings containing e.g. \"\"\n// characters; essentially \"inverting\" the result of the `normalize` function.\nfunction getOriginalIndex(diffs, pos, len) {\n  if (!diffs) {\n    return [pos, len];\n  }\n\n  // First char in the new string.\n  const start = pos;\n  // Last char in the new string.\n  const end = pos + len - 1;\n  let i = binarySearchFirstItem(diffs, x => x[0] >= start);\n  if (diffs[i][0] > start) {\n    --i;\n  }\n\n  let j = binarySearchFirstItem(diffs, x => x[0] >= end, i);\n  if (diffs[j][0] > end) {\n    --j;\n  }\n\n  // First char in the old string.\n  const oldStart = start + diffs[i][1];\n\n  // Last char in the old string.\n  const oldEnd = end + diffs[j][1];\n  const oldLen = oldEnd + 1 - oldStart;\n\n  return [oldStart, oldLen];\n}\n\n/**\n * @typedef {Object} PDFFindControllerOptions\n * @property {IPDFLinkService} linkService - The navigation/linking service.\n * @property {EventBus} eventBus - The application event bus.\n * @property {boolean} [updateMatchesCountOnProgress] - True if the matches\n *   count must be updated on progress or only when the last page is reached.\n *   The default value is `true`.\n */\n\n/**\n * Provides search functionality to find a given string in a PDF document.\n */\nclass PDFFindController {\n  #state = null;\n\n  #updateMatchesCountOnProgress = true;\n\n  #visitedPagesCount = 0;\n\n  /**\n   * @param {PDFFindControllerOptions} options\n   */\n  constructor({ linkService, eventBus, updateMatchesCountOnProgress = true, pageViewMode }) {\n    this._linkService = linkService;\n    this._eventBus = eventBus;\n    this.#updateMatchesCountOnProgress = updateMatchesCountOnProgress;\n    this._pageViewMode = pageViewMode;\n\n    /**\n     * Callback used to check if a `pageNumber` is currently visible.\n     * @type {function}\n     */\n    this.onIsPageVisible = null;\n\n    this.#reset();\n    eventBus._on(\"find\", this.#onFind.bind(this));\n    eventBus._on(\"findbarclose\", this.#onFindBarClose.bind(this));\n  }\n\n  get highlightMatches() {\n    return this._highlightMatches;\n  }\n\n  get pageMatches() {\n    return this._pageMatches;\n  }\n\n  get pageMatchesLength() {\n    return this._pageMatchesLength;\n  }\n\n  get selected() {\n    return this._selected;\n  }\n\n  get state() {\n    return this.#state;\n  }\n\n  /**\n   * Set a reference to the PDF document in order to search it.\n   * Note that searching is not possible if this method is not called.\n   *\n   * @param {PDFDocumentProxy} pdfDocument - The PDF document to search.\n   */\n  setDocument(pdfDocument) {\n    if (this._pdfDocument) {\n      this.#reset();\n    }\n    if (!pdfDocument) {\n      return;\n    }\n    this._pdfDocument = pdfDocument;\n    this._firstPageCapability.resolve();\n  }\n\n  #onFind(state) {\n    if (!state) {\n      return;\n    }\n    const pdfDocument = this._pdfDocument;\n    const { type } = state;\n\n    if (this.#state === null || this.#shouldDirtyMatch(state)) {\n      this._dirtyMatch = true;\n    }\n    this.#state = state;\n    if (type !== \"highlightallchange\") {\n      this.#updateUIState(FindState.PENDING);\n    } else {  // #1181 modified by ngx-extended-pdf-viewer\n      const hasMatches = this._pageMatches.some(matches => matches.length > 0);\n      const emptyQuery = !this.state?.query;\n      const reportAsFound = emptyQuery || hasMatches;\n      this.#updateUIState(reportAsFound ? FindState.FOUND : FindState.NOT_FOUND);\n    }\n    // #1181 end of modification by ngx-extended-pdf-viewer\n\n    this._firstPageCapability.promise.then(() => {\n      // If the document was closed before searching began, or if the search\n      // operation was relevant for a previously opened document, do nothing.\n      if (\n        !this._pdfDocument ||\n        (pdfDocument && this._pdfDocument !== pdfDocument)\n      ) {\n        return;\n      }\n      this.#extractText();\n\n      const findbarClosed = !this._highlightMatches;\n      const pendingTimeout = !!this._findTimeout;\n\n      if (this._findTimeout) {\n        clearTimeout(this._findTimeout);\n        this._findTimeout = null;\n      }\n      if (!type) {\n        // Trigger the find action with a small delay to avoid starting the\n        // search when the user is still typing (saving resources).\n        this._findTimeout = setTimeout(() => {\n          this.#nextMatch();\n          this._findTimeout = null;\n        }, FIND_TIMEOUT);\n      } else if (this._dirtyMatch) {\n        // Immediately trigger searching for non-'find' operations, when the\n        // current state needs to be reset and matches re-calculated.\n        this.#nextMatch();\n      } else if (type === \"again\") {\n        this.#nextMatch();\n\n        // When the findbar was previously closed, and `highlightAll` is set,\n        // ensure that the matches on all active pages are highlighted again.\n        if (findbarClosed && this.#state.highlightAll) {\n          this.#updateAllPages();\n        }\n      } else if (type === \"highlightallchange\") {\n        // If there was a pending search operation, synchronously trigger a new\n        // search *first* to ensure that the correct matches are highlighted.\n        if (pendingTimeout) {\n          this.#nextMatch();\n        } else {\n          this._highlightMatches = true;\n        }\n        this.#updateAllPages(); // Update the highlighting on all active pages.\n      } else {\n        this.#nextMatch();\n      }\n    });\n  }\n\n  /**\n   * @typedef {Object} PDFFindControllerScrollMatchIntoViewParams\n   * @property {HTMLElement} element\n   * @property {number} selectedLeft\n   * @property {number} pageIndex\n   * @property {number} matchIndex\n   */\n\n  /**\n   * Scroll the current match into view.\n   * @param {PDFFindControllerScrollMatchIntoViewParams}\n   */\n  scrollMatchIntoView({\n    element = null,\n    selectedLeft = 0,\n    pageIndex = -1,\n    matchIndex = -1,\n  }) {\n    if (!this._scrollMatches || !element) {\n      return;\n    } else if (matchIndex === -1 || matchIndex !== this._selected.matchIdx) {\n      return;\n    } else if (pageIndex === -1 || pageIndex !== this._selected.pageIdx) {\n      return;\n    }\n    this._scrollMatches = false; // Ensure that scrolling only happens once.\n\n    const spot = {\n      top: MATCH_SCROLL_OFFSET_TOP,\n      left: selectedLeft + MATCH_SCROLL_OFFSET_LEFT,\n    };\n    /** #492 modified by ngx-extended-pdf-viewer */\n    scrollIntoView(element, spot, /* scrollMatches = */ true, this._pageViewMode === 'infinite-scroll');\n    /** #492 end of modification */\n  }\n\n  #reset() {\n    this._highlightMatches = false;\n    this._scrollMatches = false;\n    this._pdfDocument = null;\n    this._pageMatches = [];\n    this._pageMatchesLength = [];\n    this.#visitedPagesCount = 0;\n    this.#state = null;\n    // Currently selected match.\n    this._selected = {\n      pageIdx: -1,\n      matchIdx: -1,\n    };\n    // Where the find algorithm currently is in the document.\n    this._offset = {\n      pageIdx: null,\n      matchIdx: null,\n      wrapped: false,\n    };\n    this._extractTextPromises = [];\n    this._pageContents = []; // Stores the normalized text for each page.\n    this._pageDiffs = [];\n    this._hasDiacritics = [];\n    this._matchesCountTotal = 0;\n    this._pagesToSearch = null;\n    this._pendingFindMatches = new Set();\n    this._resumePageIdx = null;\n    this._dirtyMatch = false;\n    clearTimeout(this._findTimeout);\n    this._findTimeout = null;\n\n    this._firstPageCapability = new PromiseCapability();\n  }\n\n  /**\n   * @type {string|Array} The (current) normalized search query.\n   */\n  get #query() {\n    const { query } = this.#state;\n    if (typeof query === \"string\") {\n      if (query !== this._rawQuery) {\n        this._rawQuery = query;\n        [this._normalizedQuery] = normalize(query);\n      }\n      return this._normalizedQuery;\n    }\n    // We don't bother caching the normalized search query in the Array-case,\n    // since this code-path is *essentially* unused in the default viewer.\n    return (query || []).filter(q => !!q).map(q => normalize(q)[0]);\n  }\n\n  #shouldDirtyMatch(state) {\n    // When the search query changes, regardless of the actual search command\n    // used, always re-calculate matches to avoid errors (fixes bug 1030622).\n    const newQuery = state.query,\n      prevQuery = this.#state.query;\n    const newType = typeof newQuery,\n      prevType = typeof prevQuery;\n\n    if (newType !== prevType) {\n      return true;\n    }\n    if (newType === \"string\") {\n      if (newQuery !== prevQuery) {\n        return true;\n      }\n    } else if (\n      /* isArray && */ JSON.stringify(newQuery) !== JSON.stringify(prevQuery)\n    ) {\n      return true;\n    }\n\n    switch (state.type) {\n      case \"again\":\n        const pageNumber = this._selected.pageIdx + 1;\n        const linkService = this._linkService;\n        // Only treat a 'findagain' event as a new search operation when it's\n        // *absolutely* certain that the currently selected match is no longer\n        // visible, e.g. as a result of the user scrolling in the document.\n        //\n        // NOTE: If only a simple `this._linkService.page` check was used here,\n        // there's a risk that consecutive 'findagain' operations could \"skip\"\n        // over matches at the top/bottom of pages thus making them completely\n        // inaccessible when there's multiple pages visible in the viewer.\n        return (\n          pageNumber >= 1 &&\n          pageNumber <= linkService.pagesCount &&\n          pageNumber !== linkService.page &&\n          !(this.onIsPageVisible?.(pageNumber) ?? true)\n        );\n      case \"highlightallchange\":\n        return false;\n    }\n    return true;\n  }\n\n  /**\n   * Determine if the search query constitutes a \"whole word\", by comparing the\n   * first/last character type with the preceding/following character type.\n   */\n  #isEntireWord(content, startIdx, length) {\n    let match = content\n      .slice(0, startIdx)\n      .match(NOT_DIACRITIC_FROM_END_REG_EXP);\n    if (match) {\n      const first = content.charCodeAt(startIdx);\n      const limit = match[1].charCodeAt(0);\n      if (getCharacterType(first) === getCharacterType(limit)) {\n        return false;\n      }\n    }\n\n    match = content\n      .slice(startIdx + length)\n      .match(NOT_DIACRITIC_FROM_START_REG_EXP);\n    if (match) {\n      const last = content.charCodeAt(startIdx + length - 1);\n      const limit = match[1].charCodeAt(0);\n      if (getCharacterType(last) === getCharacterType(limit)) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  #calculateRegExpMatch(query, entireWord, pageIndex, pageContent) {\n    const matches = (this._pageMatches[pageIndex] = []);\n    const matchesLength = (this._pageMatchesLength[pageIndex] = []);\n    if (!query) {\n      // The query can be empty because some chars like diacritics could have\n      // been stripped out.\n      return;\n    }\n    const diffs = this._pageDiffs[pageIndex];\n    let match;\n    while ((match = query.exec(pageContent)) !== null) {\n      if (\n        entireWord &&\n        !this.#isEntireWord(pageContent, match.index, match[0].length)\n      ) {\n        continue;\n      }\n\n      const [matchPos, matchLen] = getOriginalIndex(\n        diffs,\n        match.index,\n        match[0].length\n      );\n\n      if (matchLen) {\n        matches.push(matchPos);\n        matchesLength.push(matchLen);\n      }\n    }\n  }\n\n  #convertToRegExpString(query, hasDiacritics) {\n    const { matchDiacritics } = this.#state;\n    let isUnicode = false;\n    query = query.replaceAll(\n      SPECIAL_CHARS_REG_EXP,\n      (\n        match,\n        p1 /* to escape */,\n        p2 /* punctuation */,\n        p3 /* whitespaces */,\n        p4 /* diacritics */,\n        p5 /* letters */\n      ) => {\n        // We don't need to use a \\s for whitespaces since all the different\n        // kind of whitespaces are replaced by a single \" \".\n\n        if (p1) {\n          // Escape characters like *+?... to not interfer with regexp syntax.\n          return `[ ]*\\\\${p1}[ ]*`;\n        }\n        if (p2) {\n          // Allow whitespaces around punctuation signs.\n          return `[ ]*${p2}[ ]*`;\n        }\n        if (p3) {\n          // Replace spaces by \\s+ to be sure to match any spaces.\n          return \"[ ]+\";\n        }\n        if (matchDiacritics) {\n          return p4 || p5;\n        }\n\n        if (p4) {\n          // Diacritics are removed with few exceptions.\n          return DIACRITICS_EXCEPTION.has(p4.charCodeAt(0)) ? p4 : \"\";\n        }\n\n        // A letter has been matched and it can be followed by any diacritics\n        // in normalized text.\n        if (hasDiacritics) {\n          isUnicode = true;\n          return `${p5}\\\\p{M}*`;\n        }\n        return p5;\n      }\n    );\n\n    const trailingSpaces = \"[ ]*\";\n    if (query.endsWith(trailingSpaces)) {\n      // The [ ]* has been added in order to help to match \"foo . bar\" but\n      // it doesn't make sense to match some whitespaces after the dot\n      // when it's the last character.\n      query = query.slice(0, query.length - trailingSpaces.length);\n    }\n\n    if (matchDiacritics) {\n      // aX must not match aXY.\n      if (hasDiacritics) {\n        DIACRITICS_EXCEPTION_STR ||= String.fromCharCode(\n          ...DIACRITICS_EXCEPTION\n        );\n\n        isUnicode = true;\n        query = `${query}(?=[${DIACRITICS_EXCEPTION_STR}]|[^\\\\p{M}]|$)`;\n      }\n    }\n\n    return [isUnicode, query];\n  }\n\n  #calculateMatch(pageIndex) {\n    let query = this.#query;\n    if (query.length === 0) {\n      return; // Do nothing: the matches should be wiped out already.\n    }\n    const { caseSensitive, entireWord } = this.#state;\n    const pageContent = this._pageContents[pageIndex];\n    const hasDiacritics = this._hasDiacritics[pageIndex];\n\n    let isUnicode = false;\n    if (typeof query === \"string\") {\n      [isUnicode, query] = this.#convertToRegExpString(query, hasDiacritics);\n    } else {\n      // Words are sorted in reverse order to be sure that \"foobar\" is matched\n      // before \"foo\" in case the query is \"foobar foo\".\n      query = query\n        .sort()\n        .reverse()\n        .map(q => {\n          const [isUnicodePart, queryPart] = this.#convertToRegExpString(\n            q,\n            hasDiacritics\n          );\n          isUnicode ||= isUnicodePart;\n          return `(${queryPart})`;\n        })\n        .join(\"|\");\n    }\n\n    const flags = `g${isUnicode ? \"u\" : \"\"}${caseSensitive ? \"\" : \"i\"}`;\n    query = query ? new RegExp(query, flags) : null;\n\n    this.#calculateRegExpMatch(query, entireWord, pageIndex, pageContent);\n\n    // When `highlightAll` is set, ensure that the matches on previously\n    // rendered (and still active) pages are correctly highlighted.\n    if (this.#state.highlightAll) {\n      this.#updatePage(pageIndex);\n    }\n    if (this._resumePageIdx === pageIndex) {\n      this._resumePageIdx = null;\n      this.#nextPageMatch();\n    }\n\n    // Update the match count.\n    const pageMatchesCount = this._pageMatches[pageIndex].length;\n    this._matchesCountTotal += pageMatchesCount;\n    if (this.#updateMatchesCountOnProgress) {\n      if (pageMatchesCount > 0) {\n        this.#updateUIResultsCount();\n      }\n    } else if (++this.#visitedPagesCount === this._linkService.pagesCount) {\n      // For example, in GeckoView we want to have only the final update because\n      // the Java side provides only one object to update the counts.\n      this.#updateUIResultsCount();\n    }\n  }\n\n  #extractText() {\n    // Perform text extraction once if this method is called multiple times.\n    if (this._extractTextPromises.length > 0) {\n      return;\n    }\n\n    let promise = Promise.resolve();\n    const textOptions = { disableNormalization: true };\n    for (let i = 0, ii = this._linkService.pagesCount; i < ii; i++) {\n      const extractTextCapability = new PromiseCapability();\n      this._extractTextPromises[i] = extractTextCapability.promise;\n\n      promise = promise.then(() => {\n        return this._pdfDocument\n          .getPage(i + 1)\n          .then(pdfPage => {\n            return pdfPage.getTextContent(textOptions);\n          })\n          .then(\n            textContent => {\n              const strBuf = [];\n\n              for (const textItem of textContent.items) {\n                strBuf.push(textItem.str);\n                if (textItem.hasEOL) {\n                  strBuf.push(\"\\n\");\n                }\n              }\n\n              // Store the normalized page content (text items) as one string.\n              [\n                this._pageContents[i],\n                this._pageDiffs[i],\n                this._hasDiacritics[i],\n              ] = normalize(strBuf.join(\"\"));\n              extractTextCapability.resolve();\n            },\n            reason => {\n              console.error(\n                `Unable to get text content for page ${i + 1}`,\n                reason\n              );\n              // Page error -- assuming no text content.\n              this._pageContents[i] = \"\";\n              this._pageDiffs[i] = null;\n              this._hasDiacritics[i] = false;\n              extractTextCapability.resolve();\n            }\n          );\n      });\n    }\n  }\n\n  #updatePage(index) {\n    if (this._scrollMatches && this._selected.pageIdx === index) {\n      // If the page is selected, scroll the page into view, which triggers\n      // rendering the page, which adds the text layer. Once the text layer\n      // is built, it will attempt to scroll the selected match into view.\n      this._linkService.page = index + 1;\n    }\n\n    this._eventBus.dispatch(\"updatetextlayermatches\", {\n      source: this,\n      pageIndex: index,\n    });\n  }\n\n  #updateAllPages() {\n    this._eventBus.dispatch(\"updatetextlayermatches\", {\n      source: this,\n      pageIndex: -1,\n    });\n  }\n\n  #nextMatch() {\n    const previous = this.#state.findPrevious;\n    const currentPageIndex = this._linkService.page - 1;\n    const numPages = this._linkService.pagesCount;\n\n    this._highlightMatches = true;\n\n    if (this._dirtyMatch) {\n      // Need to recalculate the matches, reset everything.\n      this._dirtyMatch = false;\n      this._selected.pageIdx = this._selected.matchIdx = -1;\n      this._offset.pageIdx = currentPageIndex;\n      this._offset.matchIdx = null;\n      this._offset.wrapped = false;\n      this._resumePageIdx = null;\n      this._pageMatches.length = 0;\n      this._pageMatchesLength.length = 0;\n      this.#visitedPagesCount = 0;\n      this._matchesCountTotal = 0;\n\n      this.#updateAllPages(); // Wipe out any previously highlighted matches.\n\n      for (let i = 0; i < numPages; i++) {\n        // Start finding the matches as soon as the text is extracted.\n        if (this._pendingFindMatches.has(i)) {\n          continue;\n        }\n        this._pendingFindMatches.add(i);\n        this._extractTextPromises[i].then(() => {\n          this._pendingFindMatches.delete(i);\n          this.#calculateMatch(i);\n        });\n      }\n    }\n\n    // If there's no query there's no point in searching.\n    const query = this.#query;\n    if (query.length === 0) {\n      this.#updateUIState(FindState.FOUND);\n      return;\n    }\n    // If we're waiting on a page, we return since we can't do anything else.\n    if (this._resumePageIdx) {\n      return;\n    }\n\n    const offset = this._offset;\n    // Keep track of how many pages we should maximally iterate through.\n    this._pagesToSearch = numPages;\n    // If there's already a `matchIdx` that means we are iterating through a\n    // page's matches.\n    if (offset.matchIdx !== null) {\n      const numPageMatches = this._pageMatches[offset.pageIdx].length;\n      if (\n        (!previous && offset.matchIdx + 1 < numPageMatches) ||\n        (previous && offset.matchIdx > 0)\n      ) {\n        // The simple case; we just have advance the matchIdx to select\n        // the next match on the page.\n        offset.matchIdx = previous ? offset.matchIdx - 1 : offset.matchIdx + 1;\n        this.#updateMatch(/* found = */ true);\n        return;\n      }\n      // We went beyond the current page's matches, so we advance to\n      // the next page.\n      this.#advanceOffsetPage(previous);\n    }\n    // Start searching through the page.\n    this.#nextPageMatch();\n  }\n\n  #matchesReady(matches) {\n    const offset = this._offset;\n    const numMatches = matches.length;\n    const previous = this.#state.findPrevious;\n\n    if (numMatches) {\n      // There were matches for the page, so initialize `matchIdx`.\n      offset.matchIdx = previous ? numMatches - 1 : 0;\n      this.#updateMatch(/* found = */ true);\n      return true;\n    }\n    // No matches, so attempt to search the next page.\n    this.#advanceOffsetPage(previous);\n    if (offset.wrapped) {\n      offset.matchIdx = null;\n      if (this._pagesToSearch < 0) {\n        // No point in wrapping again, there were no matches.\n        this.#updateMatch(/* found = */ false);\n        // While matches were not found, searching for a page\n        // with matches should nevertheless halt.\n        return true;\n      }\n    }\n    // Matches were not found (and searching is not done).\n    return false;\n  }\n\n  #nextPageMatch() {\n    if (this._resumePageIdx !== null) {\n      console.error(\"There can only be one pending page.\");\n    }\n\n    let matches = null;\n    do {\n      const pageIdx = this._offset.pageIdx;\n      matches = this._pageMatches[pageIdx];\n      if (!matches) {\n        // The matches don't exist yet for processing by `_matchesReady`,\n        // so set a resume point for when they do exist.\n        this._resumePageIdx = pageIdx;\n        break;\n      }\n    } while (!this.#matchesReady(matches));\n  }\n\n  #advanceOffsetPage(previous) {\n    const offset = this._offset;\n    const numPages = this._linkService.pagesCount;\n    offset.pageIdx = previous ? offset.pageIdx - 1 : offset.pageIdx + 1;\n    offset.matchIdx = null;\n\n    this._pagesToSearch--;\n\n    if (offset.pageIdx >= numPages || offset.pageIdx < 0) {\n      offset.pageIdx = previous ? numPages - 1 : 0;\n      offset.wrapped = true;\n    }\n  }\n\n  #updateMatch(found = false) {\n    let state = FindState.NOT_FOUND;\n    const wrapped = this._offset.wrapped;\n    this._offset.wrapped = false;\n\n    if (found) {\n      const previousPage = this._selected.pageIdx;\n      this._selected.pageIdx = this._offset.pageIdx;\n      this._selected.matchIdx = this._offset.matchIdx;\n      state = wrapped ? FindState.WRAPPED : FindState.FOUND;\n\n      // Update the currently selected page to wipe out any selected matches.\n      if (previousPage !== -1 && previousPage !== this._selected.pageIdx) {\n        this.#updatePage(previousPage);\n      }\n    }\n\n    this.#updateUIState(state, this.#state.findPrevious);\n    if (this._selected.pageIdx !== -1) {\n      // Ensure that the match will be scrolled into view.\n      this._scrollMatches = true;\n\n      this.#updatePage(this._selected.pageIdx);\n    }\n  }\n\n  #onFindBarClose(evt) {\n    const pdfDocument = this._pdfDocument;\n    // Since searching is asynchronous, ensure that the removal of highlighted\n    // matches (from the UI) is async too such that the 'updatetextlayermatches'\n    // events will always be dispatched in the expected order.\n    this._firstPageCapability.promise.then(() => {\n      // Only update the UI if the document is open, and is the current one.\n      if (\n        !this._pdfDocument ||\n        (pdfDocument && this._pdfDocument !== pdfDocument)\n      ) {\n        return;\n      }\n      // Ensure that a pending, not yet started, search operation is aborted.\n      if (this._findTimeout) {\n        clearTimeout(this._findTimeout);\n        this._findTimeout = null;\n      }\n      // Abort any long running searches, to avoid a match being scrolled into\n      // view *after* the findbar has been closed. In this case `this._offset`\n      // will most likely differ from `this._selected`, hence we also ensure\n      // that any new search operation will always start with a clean slate.\n      if (this._resumePageIdx) {\n        this._resumePageIdx = null;\n        this._dirtyMatch = true;\n      }\n      // Avoid the UI being in a pending state when the findbar is re-opened.\n      this.#updateUIState(FindState.FOUND);\n\n      this._highlightMatches = false;\n      this.#updateAllPages(); // Wipe out any previously highlighted matches.\n    });\n  }\n\n  #requestMatchesCount() {\n    const { pageIdx, matchIdx } = this._selected;\n    let current = 0,\n      total = this._matchesCountTotal;\n    if (matchIdx !== -1) {\n      for (let i = 0; i < pageIdx; i++) {\n        current += this._pageMatches[i]?.length || 0;\n      }\n      current += matchIdx + 1;\n    }\n    // When searching starts, this method may be called before the `pageMatches`\n    // have been counted (in `_calculateMatch`). Ensure that the UI won't show\n    // temporarily broken state when the active find result doesn't make sense.\n    if (current < 1 || current > total) {\n      current = total = 0;\n    }\n    return { current, total };\n  }\n\n  #updateUIResultsCount() {\n    this._eventBus.dispatch(\"updatefindmatchescount\", {\n      source: this,\n      matchesCount: this.#requestMatchesCount(),\n    });\n  }\n\n  #updateUIState(state, previous = false) {\n    if (\n      !this.#updateMatchesCountOnProgress &&\n      (this.#visitedPagesCount !== this._linkService.pagesCount ||\n        state === FindState.PENDING)\n    ) {\n      // When this.#updateMatchesCountOnProgress is false we only send an update\n      // when everything is ready.\n      return;\n    }\n\n    this._eventBus.dispatch(\"updatefindcontrolstate\", {\n      source: this,\n      state,\n      previous,\n      matchesCount: this.#requestMatchesCount(),\n      rawQuery: this.#state?.query ?? null,\n    });\n  }\n}\n\nexport { FindState, PDFFindController };\n","/* Copyright 2018 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst CharacterType = {\n  SPACE: 0,\n  ALPHA_LETTER: 1,\n  PUNCT: 2,\n  HAN_LETTER: 3,\n  KATAKANA_LETTER: 4,\n  HIRAGANA_LETTER: 5,\n  HALFWIDTH_KATAKANA_LETTER: 6,\n  THAI_LETTER: 7,\n};\n\nfunction isAlphabeticalScript(charCode) {\n  return charCode < 0x2e80;\n}\n\nfunction isAscii(charCode) {\n  return (charCode & 0xff80) === 0;\n}\n\nfunction isAsciiAlpha(charCode) {\n  return (\n    (charCode >= /* a = */ 0x61 && charCode <= /* z = */ 0x7a) ||\n    (charCode >= /* A = */ 0x41 && charCode <= /* Z = */ 0x5a)\n  );\n}\n\nfunction isAsciiDigit(charCode) {\n  return charCode >= /* 0 = */ 0x30 && charCode <= /* 9 = */ 0x39;\n}\n\nfunction isAsciiSpace(charCode) {\n  return (\n    charCode === /* SPACE = */ 0x20 ||\n    charCode === /* TAB = */ 0x09 ||\n    charCode === /* CR = */ 0x0d ||\n    charCode === /* LF = */ 0x0a\n  );\n}\n\nfunction isHan(charCode) {\n  return (\n    (charCode >= 0x3400 && charCode <= 0x9fff) ||\n    (charCode >= 0xf900 && charCode <= 0xfaff)\n  );\n}\n\nfunction isKatakana(charCode) {\n  return charCode >= 0x30a0 && charCode <= 0x30ff;\n}\n\nfunction isHiragana(charCode) {\n  return charCode >= 0x3040 && charCode <= 0x309f;\n}\n\nfunction isHalfwidthKatakana(charCode) {\n  return charCode >= 0xff60 && charCode <= 0xff9f;\n}\n\nfunction isThai(charCode) {\n  return (charCode & 0xff80) === 0x0e00;\n}\n\n/**\n * This function is based on the word-break detection implemented in:\n * https://hg.mozilla.org/mozilla-central/file/tip/intl/lwbrk/WordBreaker.cpp\n */\nfunction getCharacterType(charCode) {\n  if (isAlphabeticalScript(charCode)) {\n    if (isAscii(charCode)) {\n      if (isAsciiSpace(charCode)) {\n        return CharacterType.SPACE;\n      } else if (\n        isAsciiAlpha(charCode) ||\n        isAsciiDigit(charCode) ||\n        charCode === /* UNDERSCORE = */ 0x5f\n      ) {\n        return CharacterType.ALPHA_LETTER;\n      }\n      return CharacterType.PUNCT;\n    } else if (isThai(charCode)) {\n      return CharacterType.THAI_LETTER;\n    } else if (charCode === /* NBSP = */ 0xa0) {\n      return CharacterType.SPACE;\n    }\n    return CharacterType.ALPHA_LETTER;\n  }\n\n  if (isHan(charCode)) {\n    return CharacterType.HAN_LETTER;\n  } else if (isKatakana(charCode)) {\n    return CharacterType.KATAKANA_LETTER;\n  } else if (isHiragana(charCode)) {\n    return CharacterType.HIRAGANA_LETTER;\n  } else if (isHalfwidthKatakana(charCode)) {\n    return CharacterType.HALFWIDTH_KATAKANA_LETTER;\n  }\n  return CharacterType.ALPHA_LETTER;\n}\n\nlet NormalizeWithNFKC;\nfunction getNormalizeWithNFKC() {\n  /* eslint-disable no-irregular-whitespace */\n  NormalizeWithNFKC ||= `---------------------------------------------------------------------------------------------------`;\n\n  if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"TESTING\")) {\n    const ranges = [];\n    const range = [];\n    const diacriticsRegex = /^\\p{M}$/u;\n    // Some chars must be replaced by their NFKC counterpart during a search.\n    for (let i = 0; i < 65536; i++) {\n      const c = String.fromCharCode(i);\n      if (c.normalize(\"NFKC\") !== c && !diacriticsRegex.test(c)) {\n        if (range.length !== 2) {\n          range[0] = range[1] = i;\n          continue;\n        }\n        if (range[1] + 1 !== i) {\n          if (range[0] === range[1]) {\n            ranges.push(String.fromCharCode(range[0]));\n          } else {\n            ranges.push(\n              `${String.fromCharCode(range[0])}-${String.fromCharCode(\n                range[1]\n              )}`\n            );\n          }\n          range[0] = range[1] = i;\n        } else {\n          range[1] = i;\n        }\n      }\n    }\n    if (ranges.join(\"\") !== NormalizeWithNFKC) {\n      throw new Error(\n        \"getNormalizeWithNFKC - update the `NormalizeWithNFKC` string.\"\n      );\n    }\n  }\n  return NormalizeWithNFKC;\n}\n\nexport { CharacterType, getCharacterType, getNormalizeWithNFKC };\n","/* Copyright 2017 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** @typedef {import(\"./event_utils\").EventBus} EventBus */\n/** @typedef {import(\"./interfaces\").IPDFLinkService} IPDFLinkService */\n\nimport { isValidRotation, parseQueryString } from \"./ui_utils.js\";\nimport { waitOnEventOrTimeout } from \"./event_utils.js\";\n\n// Heuristic value used when force-resetting `this._blockHashChange`.\nconst HASH_CHANGE_TIMEOUT = 1000; // milliseconds\n// Heuristic value used when adding the current position to the browser history.\nconst POSITION_UPDATED_THRESHOLD = 50;\n// Heuristic value used when adding a temporary position to the browser history.\nconst UPDATE_VIEWAREA_TIMEOUT = 1000; // milliseconds\n\n/**\n * @typedef {Object} PDFHistoryOptions\n * @property {IPDFLinkService} linkService - The navigation/linking service.\n * @property {EventBus} eventBus - The application event bus.\n */\n\n/**\n * @typedef {Object} InitializeParameters\n * @property {string} fingerprint - The PDF document's unique fingerprint.\n * @property {boolean} [resetHistory] - Reset the browsing history.\n * @property {boolean} [updateUrl] - Attempt to update the document URL, with\n *   the current hash, when pushing/replacing browser history entries.\n */\n\n/**\n * @typedef {Object} PushParameters\n * @property {string} [namedDest] - The named destination. If absent, a\n *   stringified version of `explicitDest` is used.\n * @property {Array} explicitDest - The explicit destination array.\n * @property {number} pageNumber - The page to which the destination points.\n */\n\nfunction getCurrentHash() {\n  return document.location.hash;\n}\n\nclass PDFHistory {\n  /**\n   * @param {PDFHistoryOptions} options\n   */\n  constructor({ linkService, eventBus }) {\n    this.linkService = linkService;\n    this.eventBus = eventBus;\n\n    this._initialized = false;\n    this._fingerprint = \"\";\n    this.reset();\n\n    this._boundEvents = null;\n    // Ensure that we don't miss a \"pagesinit\" event,\n    // by registering the listener immediately.\n    this.eventBus._on(\"pagesinit\", () => {\n      this._isPagesLoaded = false;\n\n      this.eventBus._on(\n        \"pagesloaded\",\n        evt => {\n          this._isPagesLoaded = !!evt.pagesCount;\n        },\n        { once: true }\n      );\n    });\n  }\n\n  /**\n   * Initialize the history for the PDF document, using either the current\n   * browser history entry or the document hash, whichever is present.\n   * @param {InitializeParameters} params\n   */\n  initialize({ fingerprint, resetHistory = false, updateUrl = false }) {\n    if (!fingerprint || typeof fingerprint !== \"string\") {\n      globalThis.ngxConsole.error(\n        'PDFHistory.initialize: The \"fingerprint\" must be a non-empty string.'\n      );\n      return;\n    }\n    // Ensure that any old state is always reset upon initialization.\n    if (this._initialized) {\n      this.reset();\n    }\n    const reInitialized =\n      this._fingerprint !== \"\" && this._fingerprint !== fingerprint;\n    this._fingerprint = fingerprint;\n    this._updateUrl = updateUrl === true;\n\n    this._initialized = true;\n    this._bindEvents();\n    const state = window.history.state;\n\n    this._popStateInProgress = false;\n    this._blockHashChange = 0;\n    this._currentHash = getCurrentHash();\n    this._numPositionUpdates = 0;\n\n    this._uid = this._maxUid = 0;\n    this._destination = null;\n    this._position = null;\n\n    if (!this._isValidState(state, /* checkReload = */ true) || resetHistory) {\n      const { hash, page, rotation } = this._parseCurrentHash(\n        /* checkNameddest = */ true\n      );\n\n      if (!hash || reInitialized || resetHistory) {\n        // Ensure that the browser history is reset on PDF document load.\n        this._pushOrReplaceState(null, /* forceReplace = */ true);\n        return;\n      }\n      // Ensure that the browser history is initialized correctly when\n      // the document hash is present on PDF document load.\n      this._pushOrReplaceState(\n        { hash, page, rotation },\n        /* forceReplace = */ true\n      );\n      return;\n    }\n\n    // The browser history contains a valid entry, ensure that the history is\n    // initialized correctly on PDF document load.\n    const destination = state.destination;\n    this._updateInternalState(\n      destination,\n      state.uid,\n      /* removeTemporary = */ true\n    );\n\n    if (destination.rotation !== undefined) {\n      this._initialRotation = destination.rotation;\n    }\n    if (destination.dest) {\n      this._initialBookmark = JSON.stringify(destination.dest);\n\n      // If the history is updated, e.g. through the user changing the hash,\n      // before the initial destination has become visible, then we do *not*\n      // want to potentially add `this._position` to the browser history.\n      this._destination.page = null;\n    } else if (destination.hash) {\n      this._initialBookmark = destination.hash;\n    } else if (destination.page) {\n      // Fallback case; shouldn't be necessary, but better safe than sorry.\n      this._initialBookmark = `page=${destination.page}`;\n    }\n  }\n\n  /**\n   * Reset the current `PDFHistory` instance, and consequently prevent any\n   * further updates and/or navigation of the browser history.\n   */\n  reset() {\n    if (this._initialized) {\n      this._pageHide(); // Simulate a 'pagehide' event when resetting.\n\n      this._initialized = false;\n      this._unbindEvents();\n    }\n    if (this._updateViewareaTimeout) {\n      clearTimeout(this._updateViewareaTimeout);\n      this._updateViewareaTimeout = null;\n    }\n    this._initialBookmark = null;\n    this._initialRotation = null;\n  }\n\n  /**\n   * Push an internal destination to the browser history.\n   * @param {PushParameters}\n   */\n  push({ namedDest = null, explicitDest, pageNumber }) {\n    if (!this._initialized) {\n      return;\n    }\n    if (namedDest && typeof namedDest !== \"string\") {\n      globalThis.ngxConsole.error(\n        \"PDFHistory.push: \" +\n          `\"${namedDest}\" is not a valid namedDest parameter.`\n      );\n      return;\n    } else if (!Array.isArray(explicitDest)) {\n      globalThis.ngxConsole.error(\n        \"PDFHistory.push: \" +\n          `\"${explicitDest}\" is not a valid explicitDest parameter.`\n      );\n      return;\n    } else if (!this._isValidPage(pageNumber)) {\n      // Allow an unset `pageNumber` if and only if the history is still empty;\n      // please refer to the `this._destination.page = null;` comment above.\n      if (pageNumber !== null || this._destination) {\n        globalThis.ngxConsole.error(\n          \"PDFHistory.push: \" +\n            `\"${pageNumber}\" is not a valid pageNumber parameter.`\n        );\n        return;\n      }\n    }\n\n    const hash = namedDest || JSON.stringify(explicitDest);\n    if (!hash) {\n      // The hash *should* never be undefined, but if that were to occur,\n      // avoid any possible issues by not updating the browser history.\n      return;\n    }\n\n    let forceReplace = false;\n    if (\n      this._destination &&\n      (isDestHashesEqual(this._destination.hash, hash) ||\n        isDestArraysEqual(this._destination.dest, explicitDest))\n    ) {\n      // When the new destination is identical to `this._destination`, and\n      // its `page` is undefined, replace the current browser history entry.\n      // NOTE: This can only occur if `this._destination` was set either:\n      //  - through the document hash being specified on load.\n      //  - through the user changing the hash of the document.\n      if (this._destination.page) {\n        return;\n      }\n      forceReplace = true;\n    }\n    if (this._popStateInProgress && !forceReplace) {\n      return;\n    }\n\n    this._pushOrReplaceState(\n      {\n        dest: explicitDest,\n        hash,\n        page: pageNumber,\n        rotation: this.linkService.rotation,\n      },\n      forceReplace\n    );\n\n    if (!this._popStateInProgress) {\n      // Prevent the browser history from updating while the new destination is\n      // being scrolled into view, to avoid potentially inconsistent state.\n      this._popStateInProgress = true;\n      // We defer the resetting of `this._popStateInProgress`, to account for\n      // e.g. zooming occurring when the new destination is being navigated to.\n      Promise.resolve().then(() => {\n        this._popStateInProgress = false;\n      });\n    }\n  }\n\n  /**\n   * Push a page to the browser history; generally the `push` method should be\n   * used instead.\n   * @param {number} pageNumber\n   */\n  pushPage(pageNumber) {\n    if (!this._initialized) {\n      return;\n    }\n    if (!this._isValidPage(pageNumber)) {\n      globalThis.ngxConsole.error(\n        `PDFHistory.pushPage: \"${pageNumber}\" is not a valid page number.`\n      );\n      return;\n    }\n\n    if (this._destination?.page === pageNumber) {\n      // When the new page is identical to the one in `this._destination`, we\n      // don't want to add a potential duplicate entry in the browser history.\n      return;\n    }\n    if (this._popStateInProgress) {\n      return;\n    }\n\n    this._pushOrReplaceState({\n      // Simulate an internal destination, for `this._tryPushCurrentPosition`:\n      dest: null,\n      hash: `page=${pageNumber}`,\n      page: pageNumber,\n      rotation: this.linkService.rotation,\n    });\n\n    if (!this._popStateInProgress) {\n      // Prevent the browser history from updating while the new page is\n      // being scrolled into view, to avoid potentially inconsistent state.\n      this._popStateInProgress = true;\n      // We defer the resetting of `this._popStateInProgress`, to account for\n      // e.g. zooming occurring when the new page is being navigated to.\n      Promise.resolve().then(() => {\n        this._popStateInProgress = false;\n      });\n    }\n  }\n\n  /**\n   * Push the current position to the browser history.\n   */\n  pushCurrentPosition() {\n    if (!this._initialized || this._popStateInProgress) {\n      return;\n    }\n    this._tryPushCurrentPosition();\n  }\n\n  /**\n   * Go back one step in the browser history.\n   * NOTE: Avoids navigating away from the document, useful for \"named actions\".\n   */\n  back() {\n    if (!this._initialized || this._popStateInProgress) {\n      return;\n    }\n    const state = window.history.state;\n    if (this._isValidState(state) && state.uid > 0) {\n      window.history.back();\n    }\n  }\n\n  /**\n   * Go forward one step in the browser history.\n   * NOTE: Avoids navigating away from the document, useful for \"named actions\".\n   */\n  forward() {\n    if (!this._initialized || this._popStateInProgress) {\n      return;\n    }\n    const state = window.history.state;\n    if (this._isValidState(state) && state.uid < this._maxUid) {\n      window.history.forward();\n    }\n  }\n\n  /**\n   * @type {boolean} Indicating if the user is currently moving through the\n   *   browser history, useful e.g. for skipping the next 'hashchange' event.\n   */\n  get popStateInProgress() {\n    return (\n      this._initialized &&\n      (this._popStateInProgress || this._blockHashChange > 0)\n    );\n  }\n\n  get initialBookmark() {\n    return this._initialized ? this._initialBookmark : null;\n  }\n\n  get initialRotation() {\n    return this._initialized ? this._initialRotation : null;\n  }\n\n  /**\n   * @private\n   */\n  _pushOrReplaceState(destination, forceReplace = false) {\n    const shouldReplace = forceReplace || !this._destination;\n    const newState = {\n      fingerprint: this._fingerprint,\n      uid: shouldReplace ? this._uid : this._uid + 1,\n      destination,\n    };\n\n    if (\n      typeof PDFJSDev !== \"undefined\" &&\n      PDFJSDev.test(\"CHROME\") &&\n      window.history.state?.chromecomState\n    ) {\n      // history.state.chromecomState is managed by chromecom.js.\n      newState.chromecomState = window.history.state.chromecomState;\n    }\n    this._updateInternalState(destination, newState.uid);\n\n    let newUrl;\n    if (this._updateUrl && destination?.hash) {\n      const baseUrl = document.location.href.split(\"#\")[0];\n      // Prevent errors in Firefox.\n      if (!baseUrl.startsWith(\"file://\")) {\n        newUrl = `${baseUrl}#${destination.hash}`;\n      }\n    }\n    if (shouldReplace) {\n      window.history.replaceState(newState, \"\", newUrl);\n    } else {\n      window.history.pushState(newState, \"\", newUrl);\n    }\n\n    if (\n      typeof PDFJSDev !== \"undefined\" &&\n      PDFJSDev.test(\"CHROME\") &&\n      top === window\n    ) {\n      // eslint-disable-next-line no-undef\n      chrome.runtime.sendMessage(\"showPageAction\");\n    }\n  }\n\n  /**\n   * @private\n   */\n  _tryPushCurrentPosition(temporary = false) {\n    if (!this._position) {\n      return;\n    }\n    let position = this._position;\n    if (temporary) {\n      position = Object.assign(Object.create(null), this._position);\n      position.temporary = true;\n    }\n\n    if (!this._destination) {\n      this._pushOrReplaceState(position);\n      return;\n    }\n    if (this._destination.temporary) {\n      // Always replace a previous *temporary* position.\n      this._pushOrReplaceState(position, /* forceReplace = */ true);\n      return;\n    }\n    if (this._destination.hash === position.hash) {\n      return; // The current document position has not changed.\n    }\n    if (\n      !this._destination.page &&\n      (POSITION_UPDATED_THRESHOLD <= 0 ||\n        this._numPositionUpdates <= POSITION_UPDATED_THRESHOLD)\n    ) {\n      // `this._destination` was set through the user changing the hash of\n      // the document. Do not add `this._position` to the browser history,\n      // to avoid \"flooding\" it with lots of (nearly) identical entries,\n      // since we cannot ensure that the document position has changed.\n      return;\n    }\n\n    let forceReplace = false;\n    if (\n      this._destination.page >= position.first &&\n      this._destination.page <= position.page\n    ) {\n      // When the `page` of `this._destination` is still visible, do not\n      // update the browsing history when `this._destination` either:\n      //  - contains an internal destination, since in this case we\n      //    cannot ensure that the document position has actually changed.\n      //  - was set through the user changing the hash of the document.\n      if (this._destination.dest !== undefined || !this._destination.first) {\n        return;\n      }\n      // To avoid \"flooding\" the browser history, replace the current entry.\n      forceReplace = true;\n    }\n    this._pushOrReplaceState(position, forceReplace);\n  }\n\n  /**\n   * @private\n   */\n  _isValidPage(val) {\n    return (\n      Number.isInteger(val) && val > 0 && val <= this.linkService.pagesCount\n    );\n  }\n\n  /**\n   * @private\n   */\n  _isValidState(state, checkReload = false) {\n    if (!state) {\n      return false;\n    }\n    if (state.fingerprint !== this._fingerprint) {\n      if (checkReload) {\n        // Potentially accept the history entry, even if the fingerprints don't\n        // match, when the viewer was reloaded (see issue 6847).\n        if (\n          typeof state.fingerprint !== \"string\" ||\n          state.fingerprint.length !== this._fingerprint.length\n        ) {\n          return false;\n        }\n        const [perfEntry] = performance.getEntriesByType(\"navigation\");\n        if (perfEntry?.type !== \"reload\") {\n          return false;\n        }\n      } else {\n        // This should only occur in viewers with support for opening more than\n        // one PDF document, e.g. the GENERIC viewer.\n        return false;\n      }\n    }\n    if (!Number.isInteger(state.uid) || state.uid < 0) {\n      return false;\n    }\n    if (state.destination === null || typeof state.destination !== \"object\") {\n      return false;\n    }\n    return true;\n  }\n\n  /**\n   * @private\n   */\n  _updateInternalState(destination, uid, removeTemporary = false) {\n    if (this._updateViewareaTimeout) {\n      // When updating `this._destination`, make sure that we always wait for\n      // the next 'updateviewarea' event before (potentially) attempting to\n      // push the current position to the browser history.\n      clearTimeout(this._updateViewareaTimeout);\n      this._updateViewareaTimeout = null;\n    }\n    if (removeTemporary && destination?.temporary) {\n      // When the `destination` comes from the browser history,\n      // we no longer treat it as a *temporary* position.\n      delete destination.temporary;\n    }\n    this._destination = destination;\n    this._uid = uid;\n    this._maxUid = Math.max(this._maxUid, uid);\n    // This should always be reset when `this._destination` is updated.\n    this._numPositionUpdates = 0;\n  }\n\n  /**\n   * @private\n   */\n  _parseCurrentHash(checkNameddest = false) {\n    const hash = unescape(getCurrentHash()).substring(1);\n    const params = parseQueryString(hash);\n\n    const nameddest = params.get(\"nameddest\") || \"\";\n    let page = params.get(\"page\") | 0;\n\n    if (!this._isValidPage(page) || (checkNameddest && nameddest.length > 0)) {\n      page = null;\n    }\n    return { hash, page, rotation: this.linkService.rotation };\n  }\n\n  /**\n   * @private\n   */\n  _updateViewarea({ location }) {\n    if (this._updateViewareaTimeout) {\n      clearTimeout(this._updateViewareaTimeout);\n      this._updateViewareaTimeout = null;\n    }\n\n    this._position = {\n      hash: location.pdfOpenParams.substring(1),\n      page: this.linkService.page,\n      first: location.pageNumber,\n      rotation: location.rotation,\n    };\n\n    if (this._popStateInProgress) {\n      return;\n    }\n\n    if (\n      POSITION_UPDATED_THRESHOLD > 0 &&\n      this._isPagesLoaded &&\n      this._destination &&\n      !this._destination.page\n    ) {\n      // If the current destination was set through the user changing the hash\n      // of the document, we will usually not try to push the current position\n      // to the browser history; see `this._tryPushCurrentPosition()`.\n      //\n      // To prevent `this._tryPushCurrentPosition()` from effectively being\n      // reduced to a no-op in this case, we will assume that the position\n      // *did* in fact change if the 'updateviewarea' event was dispatched\n      // more than `POSITION_UPDATED_THRESHOLD` times.\n      this._numPositionUpdates++;\n    }\n\n    if (UPDATE_VIEWAREA_TIMEOUT > 0) {\n      // When closing the browser, a 'pagehide' event will be dispatched which\n      // *should* allow us to push the current position to the browser history.\n      // In practice, it seems that the event is arriving too late in order for\n      // the session history to be successfully updated.\n      // (For additional details, please refer to the discussion in\n      //  https://bugzilla.mozilla.org/show_bug.cgi?id=1153393.)\n      //\n      // To workaround this we attempt to *temporarily* add the current position\n      // to the browser history only when the viewer is *idle*,\n      // i.e. when scrolling and/or zooming does not occur.\n      //\n      // PLEASE NOTE: It's absolutely imperative that the browser history is\n      // *not* updated too often, since that would render the viewer more or\n      // less unusable. Hence the use of a timeout to delay the update until\n      // the viewer has been idle for `UPDATE_VIEWAREA_TIMEOUT` milliseconds.\n      this._updateViewareaTimeout = setTimeout(() => {\n        if (!this._popStateInProgress) {\n          this._tryPushCurrentPosition(/* temporary = */ true);\n        }\n        this._updateViewareaTimeout = null;\n      }, UPDATE_VIEWAREA_TIMEOUT);\n    }\n  }\n\n  /**\n   * @private\n   */\n  _popState({ state }) {\n    const newHash = getCurrentHash(),\n      hashChanged = this._currentHash !== newHash;\n    this._currentHash = newHash;\n\n    if (\n      (typeof PDFJSDev !== \"undefined\" &&\n        PDFJSDev.test(\"CHROME\") &&\n        state?.chromecomState &&\n        !this._isValidState(state)) ||\n      !state\n    ) {\n      // This case corresponds to the user changing the hash of the document.\n      this._uid++;\n\n      const { hash, page, rotation } = this._parseCurrentHash();\n      this._pushOrReplaceState(\n        { hash, page, rotation },\n        /* forceReplace = */ true\n      );\n      return;\n    }\n    if (!this._isValidState(state)) {\n      // This should only occur in viewers with support for opening more than\n      // one PDF document, e.g. the GENERIC viewer.\n      return;\n    }\n\n    // Prevent the browser history from updating until the new destination,\n    // as stored in the browser history, has been scrolled into view.\n    this._popStateInProgress = true;\n\n    if (hashChanged) {\n      // When the hash changed, implying that the 'popstate' event will be\n      // followed by a 'hashchange' event, then we do *not* want to update the\n      // browser history when handling the 'hashchange' event (in web/app.js)\n      // since that would *overwrite* the new destination navigated to below.\n      //\n      // To avoid accidentally disabling all future user-initiated hash changes,\n      // if there's e.g. another 'hashchange' listener that stops the event\n      // propagation, we make sure to always force-reset `this._blockHashChange`\n      // after `HASH_CHANGE_TIMEOUT` milliseconds have passed.\n      this._blockHashChange++;\n      waitOnEventOrTimeout({\n        target: window,\n        name: \"hashchange\",\n        delay: HASH_CHANGE_TIMEOUT,\n      }).then(() => {\n        this._blockHashChange--;\n      });\n    }\n\n    // Navigate to the new destination.\n    const destination = state.destination;\n    this._updateInternalState(\n      destination,\n      state.uid,\n      /* removeTemporary = */ true\n    );\n\n    if (isValidRotation(destination.rotation)) {\n      this.linkService.rotation = destination.rotation;\n    }\n    if (destination.dest) {\n      this.linkService.goToDestination(destination.dest);\n    } else if (destination.hash) {\n      this.linkService.setHash(destination.hash);\n    } else if (destination.page) {\n      // Fallback case; shouldn't be necessary, but better safe than sorry.\n      this.linkService.page = destination.page;\n    }\n\n    // Since `PDFLinkService.goToDestination` is asynchronous, we thus defer the\n    // resetting of `this._popStateInProgress` slightly.\n    Promise.resolve().then(() => {\n      this._popStateInProgress = false;\n    });\n  }\n\n  /**\n   * @private\n   */\n  _pageHide() {\n    // Attempt to push the `this._position` into the browser history when\n    // navigating away from the document. This is *only* done if the history\n    // is empty/temporary, since otherwise an existing browser history entry\n    // will end up being overwritten (given that new entries cannot be pushed\n    // into the browser history when the 'unload' event has already fired).\n    if (!this._destination || this._destination.temporary) {\n      this._tryPushCurrentPosition();\n    }\n  }\n\n  /**\n   * @private\n   */\n  _bindEvents() {\n    if (this._boundEvents) {\n      return; // The event listeners were already added.\n    }\n    this._boundEvents = {\n      updateViewarea: this._updateViewarea.bind(this),\n      popState: this._popState.bind(this),\n      pageHide: this._pageHide.bind(this),\n    };\n\n    this.eventBus._on(\"updateviewarea\", this._boundEvents.updateViewarea);\n    window.addEventListener(\"popstate\", this._boundEvents.popState);\n    window.addEventListener(\"pagehide\", this._boundEvents.pageHide);\n  }\n\n  /**\n   * @private\n   */\n  _unbindEvents() {\n    if (!this._boundEvents) {\n      return; // The event listeners were already removed.\n    }\n    this.eventBus._off(\"updateviewarea\", this._boundEvents.updateViewarea);\n    window.removeEventListener(\"popstate\", this._boundEvents.popState);\n    window.removeEventListener(\"pagehide\", this._boundEvents.pageHide);\n\n    this._boundEvents = null;\n  }\n}\n\nfunction isDestHashesEqual(destHash, pushHash) {\n  if (typeof destHash !== \"string\" || typeof pushHash !== \"string\") {\n    return false;\n  }\n  if (destHash === pushHash) {\n    return true;\n  }\n  const nameddest = parseQueryString(destHash).get(\"nameddest\");\n  if (nameddest === pushHash) {\n    return true;\n  }\n  return false;\n}\n\nfunction isDestArraysEqual(firstDest, secondDest) {\n  function isEntryEqual(first, second) {\n    if (typeof first !== typeof second) {\n      return false;\n    }\n    if (Array.isArray(first) || Array.isArray(second)) {\n      return false;\n    }\n    if (first !== null && typeof first === \"object\" && second !== null) {\n      if (Object.keys(first).length !== Object.keys(second).length) {\n        return false;\n      }\n      for (const key in first) {\n        if (!isEntryEqual(first[key], second[key])) {\n          return false;\n        }\n      }\n      return true;\n    }\n    return first === second || (Number.isNaN(first) && Number.isNaN(second));\n  }\n\n  if (!(Array.isArray(firstDest) && Array.isArray(secondDest))) {\n    return false;\n  }\n  if (firstDest.length !== secondDest.length) {\n    return false;\n  }\n  for (let i = 0, ii = firstDest.length; i < ii; i++) {\n    if (!isEntryEqual(firstDest[i], secondDest[i])) {\n      return false;\n    }\n  }\n  return true;\n}\n\nexport { isDestArraysEqual, isDestHashesEqual, PDFHistory };\n","/* Copyright 2015 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** @typedef {import(\"./event_utils\").EventBus} EventBus */\n/** @typedef {import(\"./interfaces\").IPDFLinkService} IPDFLinkService */\n\nimport { parseQueryString } from \"./ui_utils.js\";\n\nconst DEFAULT_LINK_REL = \"noopener noreferrer nofollow\";\n\nconst LinkTarget = {\n  NONE: 0, // Default value.\n  SELF: 1,\n  BLANK: 2,\n  PARENT: 3,\n  TOP: 4,\n};\n\n/**\n * @typedef {Object} ExternalLinkParameters\n * @property {string} url - An absolute URL.\n * @property {LinkTarget} [target] - The link target. The default value is\n *   `LinkTarget.NONE`.\n * @property {string} [rel] - The link relationship. The default value is\n *   `DEFAULT_LINK_REL`.\n * @property {boolean} [enabled] - Whether the link should be enabled. The\n *   default value is true.\n */\n\n/**\n * Adds various attributes (href, title, target, rel) to hyperlinks.\n * @param {HTMLAnchorElement} link - The link element.\n * @param {ExternalLinkParameters} params\n */\nfunction addLinkAttributes(link, { url, target, rel, enabled = true } = {}) {\n  if (!url || typeof url !== \"string\") {\n    throw new Error('A valid \"url\" parameter must provided.');\n  }\n\n  if (enabled) {\n    link.href = link.title = url;\n  } else {\n    link.href = \"\";\n    link.title = `Disabled: ${url}`;\n    link.onclick = () => {\n      return false;\n    };\n  }\n\n  let targetStr = \"\"; // LinkTarget.NONE\n  switch (target) {\n    case LinkTarget.NONE:\n      break;\n    case LinkTarget.SELF:\n      targetStr = \"_self\";\n      break;\n    case LinkTarget.BLANK:\n      targetStr = \"_blank\";\n      break;\n    case LinkTarget.PARENT:\n      targetStr = \"_parent\";\n      break;\n    case LinkTarget.TOP:\n      targetStr = \"_top\";\n      break;\n  }\n  link.target = targetStr;\n\n  link.rel = typeof rel === \"string\" ? rel : DEFAULT_LINK_REL;\n}\n\n/**\n * @typedef {Object} PDFLinkServiceOptions\n * @property {EventBus} eventBus - The application event bus.\n * @property {number} [externalLinkTarget] - Specifies the `target` attribute\n *   for external links. Must use one of the values from {LinkTarget}.\n *   Defaults to using no target.\n * @property {string} [externalLinkRel] - Specifies the `rel` attribute for\n *   external links. Defaults to stripping the referrer.\n * @property {boolean} [ignoreDestinationZoom] - Ignores the zoom argument,\n *   thus preserving the current zoom level in the viewer, when navigating\n *   to internal destinations. The default value is `false`.\n */\n\n/**\n * Performs navigation functions inside PDF, such as opening specified page,\n * or destination.\n * @implements {IPDFLinkService}\n */\nclass PDFLinkService {\n  #pagesRefCache = new Map();\n\n  /**\n   * @param {PDFLinkServiceOptions} options\n   */\n  constructor({\n    eventBus,\n    externalLinkTarget = null,\n    externalLinkRel = null,\n    ignoreDestinationZoom = false,\n  } = {}) {\n    this.eventBus = eventBus;\n    this.externalLinkTarget = externalLinkTarget;\n    this.externalLinkRel = externalLinkRel;\n    this.externalLinkEnabled = true;\n    this._ignoreDestinationZoom = ignoreDestinationZoom;\n\n    this.baseUrl = null;\n    this.pdfDocument = null;\n    this.pdfViewer = null;\n    this.pdfHistory = null;\n  }\n\n  setDocument(pdfDocument, baseUrl = null) {\n    this.baseUrl = baseUrl;\n    this.pdfDocument = pdfDocument;\n    this.#pagesRefCache.clear();\n  }\n\n  setViewer(pdfViewer) {\n    this.pdfViewer = pdfViewer;\n  }\n\n  setHistory(pdfHistory) {\n    this.pdfHistory = pdfHistory;\n  }\n\n  /**\n   * @type {number}\n   */\n  get pagesCount() {\n    return this.pdfDocument ? this.pdfDocument.numPages : 0;\n  }\n\n  /**\n   * @type {number}\n   */\n  get page() {\n    return this.pdfViewer.currentPageNumber;\n  }\n\n  /**\n   * @param {number} value\n   */\n  set page(value) {\n    this.pdfViewer.currentPageNumber = value;\n  }\n\n  /**\n   * @type {number}\n   */\n  get rotation() {\n    return this.pdfViewer.pagesRotation;\n  }\n\n  /**\n   * @param {number} value\n   */\n  set rotation(value) {\n    this.pdfViewer.pagesRotation = value;\n  }\n\n  /**\n   * @type {boolean}\n   */\n  get isInPresentationMode() {\n    return this.pdfViewer.isInPresentationMode;\n  }\n\n  #goToDestinationHelper(rawDest, namedDest = null, explicitDest) {\n    // Dest array looks like that: <page-ref> </XYZ|/FitXXX> <args..>\n    const destRef = explicitDest[0];\n    let pageNumber;\n\n    if (typeof destRef === \"object\" && destRef !== null) {\n      pageNumber = this._cachedPageNumber(destRef);\n\n      if (!pageNumber) {\n        // Fetch the page reference if it's not yet available. This could\n        // only occur during loading, before all pages have been resolved.\n        this.pdfDocument\n          .getPageIndex(destRef)\n          .then(pageIndex => {\n            this.cachePageRef(pageIndex + 1, destRef);\n            this.#goToDestinationHelper(rawDest, namedDest, explicitDest);\n          })\n          .catch(() => {\n            globalThis.ngxConsole.error(\n              `PDFLinkService.#goToDestinationHelper: \"${destRef}\" is not ` +\n                `a valid page reference, for dest=\"${rawDest}\".`\n            );\n          });\n        return;\n      }\n    } else if (Number.isInteger(destRef)) {\n      pageNumber = destRef + 1;\n    } else {\n      globalThis.ngxConsole.error(\n        `PDFLinkService.#goToDestinationHelper: \"${destRef}\" is not ` +\n          `a valid destination reference, for dest=\"${rawDest}\".`\n      );\n      return;\n    }\n    if (!pageNumber || pageNumber < 1 || pageNumber > this.pagesCount) {\n      globalThis.ngxConsole.error(\n        `PDFLinkService.#goToDestinationHelper: \"${pageNumber}\" is not ` +\n          `a valid page number, for dest=\"${rawDest}\".`\n      );\n      return;\n    }\n\n    if (this.pdfHistory) {\n      // Update the browser history before scrolling the new destination into\n      // view, to be able to accurately capture the current document position.\n      this.pdfHistory.pushCurrentPosition();\n      this.pdfHistory.push({ namedDest, explicitDest, pageNumber });\n    }\n\n    this.pdfViewer.scrollPageIntoView({\n      pageNumber,\n      destArray: explicitDest,\n      ignoreDestinationZoom: this._ignoreDestinationZoom,\n    });\n  }\n\n  /**\n   * This method will, when available, also update the browser history.\n   *\n   * @param {string|Array} dest - The named, or explicit, PDF destination.\n   */\n  async goToDestination(dest) {\n    if (!this.pdfDocument) {\n      return;\n    }\n    let namedDest, explicitDest;\n    if (typeof dest === \"string\") {\n      namedDest = dest;\n      explicitDest = await this.pdfDocument.getDestination(dest);\n    } else {\n      namedDest = null;\n      explicitDest = await dest;\n    }\n    if (!Array.isArray(explicitDest)) {\n      globalThis.ngxConsole.error(\n        `PDFLinkService.goToDestination: \"${explicitDest}\" is not ` +\n          `a valid destination array, for dest=\"${dest}\".`\n      );\n      return;\n    }\n    this.#goToDestinationHelper(dest, namedDest, explicitDest);\n  }\n\n  /**\n   * This method will, when available, also update the browser history.\n   *\n   * @param {number|string} val - The page number, or page label.\n   */\n  goToPage(val) {\n    if (!this.pdfDocument) {\n      return;\n    }\n    const pageNumber =\n      (typeof val === \"string\" && this.pdfViewer.pageLabelToPageNumber(val)) ||\n      val | 0;\n    if (\n      !(\n        Number.isInteger(pageNumber) &&\n        pageNumber > 0 &&\n        pageNumber <= this.pagesCount\n      )\n    ) {\n      globalThis.ngxConsole.error(`PDFLinkService.goToPage: \"${val}\" is not a valid page.`);\n      return;\n    }\n\n    if (this.pdfHistory) {\n      // Update the browser history before scrolling the new page into view,\n      // to be able to accurately capture the current document position.\n      this.pdfHistory.pushCurrentPosition();\n      this.pdfHistory.pushPage(pageNumber);\n    }\n\n    if (this.pdfViewer.pageViewMode === \"book\") {\n      if (this.pdfViewer.pageFlip) {\n        this.pdfViewer.ensureAdjecentPagesAreLoaded();\n        const evenPage = this.pdfViewer.currentPageNumber - (this.pdfViewer.currentPageNumber % 2);\n        const evenTargetPage = pageNumber - (pageNumber % 2);\n        if (evenPage === evenTargetPage - 2) {\n          this.pdfViewer.pageFlip.flipNext();\n        } else if (evenPage === evenTargetPage + 2) {\n          this.pdfViewer.pageFlip.flipPrev();\n        } else {\n          this.pdfViewer.pageFlip.turnToPage(pageNumber - 1);\n        }\n      }\n    } else {\n      this.pdfViewer.scrollPageIntoView({ pageNumber });\n    }\n  }\n\n  /**\n   * Wrapper around the `addLinkAttributes` helper function.\n   * @param {HTMLAnchorElement} link\n   * @param {string} url\n   * @param {boolean} [newWindow]\n   */\n  addLinkAttributes(link, url, newWindow = false) {\n    addLinkAttributes(link, {\n      url,\n      target: newWindow ? LinkTarget.BLANK : this.externalLinkTarget,\n      rel: this.externalLinkRel,\n      enabled: this.externalLinkEnabled,\n    });\n  }\n\n  /**\n   * @param {string|Array} dest - The PDF destination object.\n   * @returns {string} The hyperlink to the PDF object.\n   */\n  getDestinationHash(dest) {\n    if (typeof dest === \"string\") {\n      if (dest.length > 0) {\n        return this.getAnchorUrl(\"#\" + escape(dest));\n      }\n    } else if (Array.isArray(dest)) {\n      const str = JSON.stringify(dest);\n      if (str.length > 0) {\n        return this.getAnchorUrl(\"#\" + escape(str));\n      }\n    }\n    return this.getAnchorUrl(\"\");\n  }\n\n  /**\n   * Prefix the full url on anchor links to make sure that links are resolved\n   * relative to the current URL instead of the one defined in <base href>.\n   * @param {string} anchor - The anchor hash, including the #.\n   * @returns {string} The hyperlink to the PDF object.\n   */\n  getAnchorUrl(anchor) {\n    return this.baseUrl ? this.baseUrl + anchor : anchor;\n  }\n\n  /**\n   * @param {string} hash\n   */\n  setHash(hash) {\n    if (!this.pdfDocument) {\n      return;\n    }\n    let pageNumber, dest;\n    if (hash.includes(\"=\")) {\n      const params = parseQueryString(hash);\n      if (params.has(\"search\")) {\n        const query = params.get(\"search\").replaceAll('\"', \"\"),\n          phrase = params.get(\"phrase\") === \"true\";\n\n        this.eventBus.dispatch(\"findfromurlhash\", {\n          source: this,\n          query: phrase ? query : query.match(/\\S+/g),\n        });\n      }\n      // borrowing syntax from \"Parameters for Opening PDF Files\"\n      if (params.has(\"page\")) {\n        pageNumber = params.get(\"page\") | 0 || 1;\n      }\n      if (params.has(\"zoom\")) {\n        // Build the destination array.\n        const zoomArgs = params.get(\"zoom\").split(\",\"); // scale,left,top\n        const zoomArg = zoomArgs[0];\n        const zoomArgNumber = parseFloat(zoomArg);\n\n        if (!zoomArg.includes(\"Fit\")) {\n          // If the zoomArg is a number, it has to get divided by 100. If it's\n          // a string, it should stay as it is.\n          dest = [\n            null,\n            { name: \"XYZ\" },\n            zoomArgs.length > 1 ? zoomArgs[1] | 0 : null,\n            zoomArgs.length > 2 ? zoomArgs[2] | 0 : null,\n            zoomArgNumber ? zoomArgNumber / 100 : zoomArg,\n          ];\n        } else if (zoomArg === \"Fit\" || zoomArg === \"FitB\") {\n          dest = [null, { name: zoomArg }];\n        } else if (\n          zoomArg === \"FitH\" ||\n          zoomArg === \"FitBH\" ||\n          zoomArg === \"FitV\" ||\n          zoomArg === \"FitBV\"\n        ) {\n          dest = [\n            null,\n            { name: zoomArg },\n            zoomArgs.length > 1 ? zoomArgs[1] | 0 : null,\n          ];\n        } else if (zoomArg === \"FitR\") {\n          if (zoomArgs.length !== 5) {\n            globalThis.ngxConsole.error(\n              'PDFLinkService.setHash: Not enough parameters for \"FitR\".'\n            );\n          } else {\n            dest = [\n              null,\n              { name: zoomArg },\n              zoomArgs[1] | 0,\n              zoomArgs[2] | 0,\n              zoomArgs[3] | 0,\n              zoomArgs[4] | 0,\n            ];\n          }\n        } else {\n          globalThis.ngxConsole.error(\n            `PDFLinkService.setHash: \"${zoomArg}\" is not a valid zoom value.`\n          );\n        }\n      }\n      if (dest) {\n        this.pdfViewer.scrollPageIntoView({\n          pageNumber: pageNumber || this.page,\n          destArray: dest,\n          allowNegativeOffset: true,\n        });\n      } else if (pageNumber) {\n        this.page = pageNumber; // simple page\n      }\n      if (params.has(\"pagemode\")) {\n        this.eventBus.dispatch(\"pagemode\", {\n          source: this,\n          mode: params.get(\"pagemode\"),\n        });\n      }\n      // Ensure that this parameter is *always* handled last, in order to\n      // guarantee that it won't be overridden (e.g. by the \"page\" parameter).\n      if (params.has(\"nameddest\")) {\n        this.goToDestination(params.get(\"nameddest\"));\n      }\n    } else {\n      // Named (or explicit) destination.\n      dest = unescape(hash);\n      try {\n        dest = JSON.parse(dest);\n\n        if (!Array.isArray(dest)) {\n          // Avoid incorrectly rejecting a valid named destination, such as\n          // e.g. \"4.3\" or \"true\", because `JSON.parse` converted its type.\n          dest = dest.toString();\n        }\n      } catch {}\n\n      if (\n        typeof dest === \"string\" ||\n        PDFLinkService.#isValidExplicitDestination(dest)\n      ) {\n        this.goToDestination(dest);\n        return;\n      }\n      globalThis.ngxConsole.error(\n        `PDFLinkService.setHash: \"${unescape(\n          hash\n        )}\" is not a valid destination.`\n      );\n    }\n  }\n\n  /**\n   * @param {string} action\n   */\n  executeNamedAction(action) {\n    // See PDF reference, table 8.45 - Named action\n    switch (action) {\n      case \"GoBack\":\n        this.pdfHistory?.back();\n        break;\n\n      case \"GoForward\":\n        this.pdfHistory?.forward();\n        break;\n\n      case \"NextPage\":\n        this.pdfViewer.nextPage();\n        break;\n\n      case \"PrevPage\":\n        this.pdfViewer.previousPage();\n        break;\n\n      case \"LastPage\":\n        this.page = this.pagesCount;\n        break;\n\n      case \"FirstPage\":\n        this.page = 1;\n        break;\n\n      default:\n        break; // No action according to spec\n    }\n\n    this.eventBus.dispatch(\"namedaction\", {\n      source: this,\n      action,\n    });\n  }\n\n  /**\n   * @param {Object} action\n   */\n  async executeSetOCGState(action) {\n    const pdfDocument = this.pdfDocument;\n    const optionalContentConfig =\n      await this.pdfViewer.optionalContentConfigPromise;\n\n    if (pdfDocument !== this.pdfDocument) {\n      return; // The document was closed while the optional content resolved.\n    }\n    let operator;\n\n    for (const elem of action.state) {\n      switch (elem) {\n        case \"ON\":\n        case \"OFF\":\n        case \"Toggle\":\n          operator = elem;\n          continue;\n      }\n      switch (operator) {\n        case \"ON\":\n          optionalContentConfig.setVisibility(elem, true);\n          break;\n        case \"OFF\":\n          optionalContentConfig.setVisibility(elem, false);\n          break;\n        case \"Toggle\":\n          const group = optionalContentConfig.getGroup(elem);\n          if (group) {\n            optionalContentConfig.setVisibility(elem, !group.visible);\n          }\n          break;\n      }\n    }\n\n    this.pdfViewer.optionalContentConfigPromise = Promise.resolve(\n      optionalContentConfig\n    );\n  }\n\n  /**\n   * @param {number} pageNum - page number.\n   * @param {Object} pageRef - reference to the page.\n   */\n  cachePageRef(pageNum, pageRef) {\n    if (!pageRef) {\n      return;\n    }\n    const refStr =\n      pageRef.gen === 0 ? `${pageRef.num}R` : `${pageRef.num}R${pageRef.gen}`;\n    this.#pagesRefCache.set(refStr, pageNum);\n  }\n\n  /**\n   * @ignore\n   */\n  _cachedPageNumber(pageRef) {\n    if (!pageRef) {\n      return null;\n    }\n    const refStr =\n      pageRef.gen === 0 ? `${pageRef.num}R` : `${pageRef.num}R${pageRef.gen}`;\n    return this.#pagesRefCache.get(refStr) || null;\n  }\n\n  static #isValidExplicitDestination(dest) {\n    if (!Array.isArray(dest)) {\n      return false;\n    }\n    const destLength = dest.length;\n    if (destLength < 2) {\n      return false;\n    }\n    const page = dest[0];\n    if (\n      !(\n        typeof page === \"object\" &&\n        Number.isInteger(page.num) &&\n        Number.isInteger(page.gen)\n      ) &&\n      !(Number.isInteger(page) && page >= 0)\n    ) {\n      return false;\n    }\n    const zoom = dest[1];\n    if (!(typeof zoom === \"object\" && typeof zoom.name === \"string\")) {\n      return false;\n    }\n    let allowNull = true;\n    switch (zoom.name) {\n      case \"XYZ\":\n        if (destLength !== 5) {\n          return false;\n        }\n        break;\n      case \"Fit\":\n      case \"FitB\":\n        return destLength === 2;\n      case \"FitH\":\n      case \"FitBH\":\n      case \"FitV\":\n      case \"FitBV\":\n        if (destLength !== 3) {\n          return false;\n        }\n        break;\n      case \"FitR\":\n        if (destLength !== 6) {\n          return false;\n        }\n        allowNull = false;\n        break;\n      default:\n        return false;\n    }\n    for (let i = 2; i < destLength; i++) {\n      const param = dest[i];\n      if (!(typeof param === \"number\" || (allowNull && param === null))) {\n        return false;\n      }\n    }\n    return true;\n  }\n}\n\n/**\n * @implements {IPDFLinkService}\n */\nclass SimpleLinkService {\n  constructor() {\n    this.externalLinkEnabled = true;\n  }\n\n  /**\n   * @type {number}\n   */\n  get pagesCount() {\n    return 0;\n  }\n\n  /**\n   * @type {number}\n   */\n  get page() {\n    return 0;\n  }\n\n  /**\n   * @param {number} value\n   */\n  set page(value) {}\n\n  /**\n   * @type {number}\n   */\n  get rotation() {\n    return 0;\n  }\n\n  /**\n   * @param {number} value\n   */\n  set rotation(value) {}\n\n  /**\n   * @type {boolean}\n   */\n  get isInPresentationMode() {\n    return false;\n  }\n\n  /**\n   * @param {string|Array} dest - The named, or explicit, PDF destination.\n   */\n  async goToDestination(dest) {}\n\n  /**\n   * @param {number|string} val - The page number, or page label.\n   */\n  goToPage(val) {}\n\n  /**\n   * @param {HTMLAnchorElement} link\n   * @param {string} url\n   * @param {boolean} [newWindow]\n   */\n  addLinkAttributes(link, url, newWindow = false) {\n    addLinkAttributes(link, { url, enabled: this.externalLinkEnabled });\n  }\n\n  /**\n   * @param dest - The PDF destination object.\n   * @returns {string} The hyperlink to the PDF object.\n   */\n  getDestinationHash(dest) {\n    return \"#\";\n  }\n\n  /**\n   * @param hash - The PDF parameters/hash.\n   * @returns {string} The hyperlink to the PDF object.\n   */\n  getAnchorUrl(hash) {\n    return \"#\";\n  }\n\n  /**\n   * @param {string} hash\n   */\n  setHash(hash) {}\n\n  /**\n   * @param {string} action\n   */\n  executeNamedAction(action) {}\n\n  /**\n   * @param {Object} action\n   */\n  executeSetOCGState(action) {}\n\n  /**\n   * @param {number} pageNum - page number.\n   * @param {Object} pageRef - reference to the page.\n   */\n  cachePageRef(pageNum, pageRef) {}\n}\n\nexport { LinkTarget, PDFLinkService, SimpleLinkService };\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// eslint-disable-next-line max-len\n/** @typedef {import(\"../src/display/display_utils\").PageViewport} PageViewport */\n// eslint-disable-next-line max-len\n/** @typedef {import(\"../src/display/optional_content_config\").OptionalContentConfig} OptionalContentConfig */\n/** @typedef {import(\"./event_utils\").EventBus} EventBus */\n/** @typedef {import(\"./interfaces\").IL10n} IL10n */\n/** @typedef {import(\"./interfaces\").IRenderableView} IRenderableView */\n// eslint-disable-next-line max-len\n/** @typedef {import(\"./pdf_rendering_queue\").PDFRenderingQueue} PDFRenderingQueue */\n\nimport {\n  AbortException,\n  AnnotationMode,\n  PixelsPerInch,\n  RenderingCancelledException,\n  setLayerDimensions,\n  shadow,\n} from \"pdfjs-lib\";\nimport {\n  approximateFraction,\n  DEFAULT_SCALE,\n  OutputScale,\n  RenderingStates,\n  roundToDivide,\n  TextLayerMode,\n} from \"./ui_utils.js\";\nimport { AnnotationEditorLayerBuilder } from \"./annotation_editor_layer_builder.js\";\nimport { AnnotationLayerBuilder } from \"./annotation_layer_builder.js\";\nimport { compatibilityParams } from \"./app_options.js\";\nimport { NullL10n } from \"web-l10n_utils\";\nimport { SimpleLinkService } from \"./pdf_link_service.js\";\nimport { StructTreeLayerBuilder } from \"./struct_tree_layer_builder.js\";\nimport { TextAccessibilityManager } from \"./text_accessibility.js\";\nimport canvasSize from \"canvas-size\";\nimport { warn } from \"../src/shared/util.js\";\nimport { TextHighlighter } from \"./text_highlighter.js\";\nimport { TextLayerBuilder } from \"./text_layer_builder.js\";\nimport { XfaLayerBuilder } from \"./xfa_layer_builder.js\";\n\n/**\n * @typedef {Object} PDFPageViewOptions\n * @property {HTMLDivElement} [container] - The viewer element.\n * @property {EventBus} eventBus - The application event bus.\n * @property {number} id - The page unique ID (normally its number).\n * @property {number} [scale] - The page scale display.\n * @property {PageViewport} defaultViewport - The page viewport.\n * @property {Promise<OptionalContentConfig>} [optionalContentConfigPromise] -\n *   A promise that is resolved with an {@link OptionalContentConfig} instance.\n *   The default value is `null`.\n * @property {PDFRenderingQueue} [renderingQueue] - The rendering queue object.\n * @property {number} [textLayerMode] - Controls if the text layer used for\n *   selection and searching is created. The constants from {TextLayerMode}\n *   should be used. The default value is `TextLayerMode.ENABLE`.\n * @property {number} [annotationMode] - Controls if the annotation layer is\n *   created, and if interactive form elements or `AnnotationStorage`-data are\n *   being rendered. The constants from {@link AnnotationMode} should be used;\n *   see also {@link RenderParameters} and {@link GetOperatorListParameters}.\n *   The default value is `AnnotationMode.ENABLE_FORMS`.\n * @property {string} [imageResourcesPath] - Path for image resources, mainly\n *   for annotation icons. Include trailing slash.\n * @property {boolean} [isOffscreenCanvasSupported] - Allows to use an\n *   OffscreenCanvas if needed.\n * @property {number} [maxCanvasPixels] - The maximum supported canvas size in\n *   total pixels, i.e. width * height. Use `-1` for no limit, or `0` for\n *   CSS-only zooming. The default value is 4096 * 4096 (16 mega-pixels).\n * @property {Object} [pageColors] - Overwrites background and foreground colors\n *   with user defined ones in order to improve readability in high contrast\n *   mode.\n * @property {IL10n} [l10n] - Localization service.\n * @property {Object} [layerProperties] - The object that is used to lookup\n *   the necessary layer-properties.\n */\n\nconst MAX_CANVAS_PIXELS = compatibilityParams.maxCanvasPixels || 16777216;\n\nconst DEFAULT_LAYER_PROPERTIES =\n  typeof PDFJSDev === \"undefined\" || !PDFJSDev.test(\"COMPONENTS\")\n    ? null\n    : {\n        annotationEditorUIManager: null,\n        annotationStorage: null,\n        downloadManager: null,\n        enableScripting: false,\n        fieldObjectsPromise: null,\n        findController: null,\n        hasJSActionsPromise: null,\n        get linkService() {\n          return new SimpleLinkService();\n        },\n      };\n\n/**\n * @implements {IRenderableView}\n */\nclass PDFPageView {\n  #annotationMode = AnnotationMode.ENABLE_FORMS;\n\n  #hasRestrictedScaling = false;\n\n  #layerProperties = null;\n\n  #loadingId = null;\n\n  #previousRotation = null;\n\n  #renderError = null;\n\n  #renderingState = RenderingStates.INITIAL;\n\n  #textLayerMode = TextLayerMode.ENABLE;\n\n  #useThumbnailCanvas = {\n    directDrawing: true,\n    initialOptionalContent: true,\n    regularAnnotations: true,\n  };\n\n  #viewportMap = new WeakMap();\n\n  /**\n   * @param {PDFPageViewOptions} options\n   */\n  constructor(options) {\n    const container = options.container;\n    const defaultViewport = options.defaultViewport;\n\n    this.id = options.id;\n    this.renderingId = \"page\" + this.id;\n    this.#layerProperties = options.layerProperties || DEFAULT_LAYER_PROPERTIES;\n\n    this.pdfPage = null;\n    this.pageLabel = null;\n    this.rotation = 0;\n    this.scale = options.scale || DEFAULT_SCALE;\n    this.viewport = defaultViewport;\n    this.pdfPageRotate = defaultViewport.rotation;\n    this._optionalContentConfigPromise =\n      options.optionalContentConfigPromise || null;\n    this.#textLayerMode = options.textLayerMode ?? TextLayerMode.ENABLE;\n    this.#annotationMode =\n      options.annotationMode ?? AnnotationMode.ENABLE_FORMS;\n    this.imageResourcesPath = options.imageResourcesPath || \"\";\n    this.isOffscreenCanvasSupported =\n      options.isOffscreenCanvasSupported ?? true;\n    this.maxCanvasPixels = options.maxCanvasPixels ?? MAX_CANVAS_PIXELS;\n    this.pageColors = options.pageColors || null;\n\n    this.eventBus = options.eventBus;\n    this.renderingQueue = options.renderingQueue;\n    this.l10n = options.l10n || NullL10n;\n\n    this.renderTask = null;\n    this.resume = null;\n    if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"GENERIC\")) {\n      this._isStandalone = !this.renderingQueue?.hasViewer();\n      this._container = container;\n    }\n\n    this._annotationCanvasMap = null;\n\n    this.annotationLayer = null;\n    this.annotationEditorLayer = null;\n    this.textLayer = null;\n    this.zoomLayer = null;\n    this.xfaLayer = null;\n    this.structTreeLayer = null;\n\n    const div = document.createElement(\"div\");\n    div.className = \"page\";\n    div.setAttribute(\"data-page-number\", this.id);\n    div.setAttribute(\"role\", \"region\");\n    div.setAttribute(\"data-l10n-id\", \"pdfjs-page-landmark\");\n    div.setAttribute(\"data-l10n-args\", JSON.stringify({ page: this.id }));\n    this.div = div;\n\n    this.#setDimensions();\n    container?.append(div);\n\n    if (\n      (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"GENERIC\")) &&\n      this._isStandalone\n    ) {\n      // Ensure that the various layers always get the correct initial size,\n      // see issue 15795.\n      container?.style.setProperty(\n        \"--scale-factor\",\n        this.scale * PixelsPerInch.PDF_TO_CSS_UNITS\n      );\n\n      const { optionalContentConfigPromise } = options;\n      if (optionalContentConfigPromise) {\n        // Ensure that the thumbnails always display the *initial* document\n        // state, for documents with optional content.\n        optionalContentConfigPromise.then(optionalContentConfig => {\n          if (\n            optionalContentConfigPromise !== this._optionalContentConfigPromise\n          ) {\n            return;\n          }\n          this.#useThumbnailCanvas.initialOptionalContent =\n            optionalContentConfig.hasInitialVisibility;\n        });\n      }\n\n      // Ensure that Fluent is connected in e.g. the COMPONENTS build.\n      if (this.l10n === NullL10n) {\n        this.l10n.translate(this.div);\n      }\n    }\n  }\n\n  get renderingState() {\n    return this.#renderingState;\n  }\n\n  set renderingState(state) {\n    if (state === this.#renderingState) {\n      return;\n    }\n    this.#renderingState = state;\n\n    if (this.#loadingId) {\n      clearTimeout(this.#loadingId);\n      this.#loadingId = null;\n    }\n\n    switch (state) {\n      case RenderingStates.PAUSED:\n        this.div.classList.remove(\"loading\");\n        break;\n      case RenderingStates.RUNNING:\n        this.div.classList.add(\"loadingIcon\");\n        this.#loadingId = setTimeout(() => {\n          // Adding the loading class is slightly postponed in order to not have\n          // it with loadingIcon.\n          // If we don't do that the visibility of the background is changed but\n          // the transition isn't triggered.\n          this.div.classList.add(\"loading\");\n          this.#loadingId = null;\n        }, 0);\n        break;\n      case RenderingStates.INITIAL:\n      case RenderingStates.FINISHED:\n        this.div.classList.remove(\"loadingIcon\", \"loading\");\n        break;\n    }\n  }\n\n  #setDimensions() {\n    const { viewport } = this;\n    if (this.pdfPage) {\n      if (this.#previousRotation === viewport.rotation) {\n        return;\n      }\n      this.#previousRotation = viewport.rotation;\n    }\n\n    setLayerDimensions(\n      this.div,\n      viewport,\n      /* mustFlip = */ true,\n      /* mustRotate = */ false\n    );\n  }\n\n  setPdfPage(pdfPage) {\n    if (\n      (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"GENERIC\")) &&\n      this._isStandalone &&\n      (this.pageColors?.foreground === \"CanvasText\" ||\n        this.pageColors?.background === \"Canvas\")\n    ) {\n      this._container?.style.setProperty(\n        \"--hcm-highlight-filter\",\n        pdfPage.filterFactory.addHighlightHCMFilter(\n          \"CanvasText\",\n          \"Canvas\",\n          \"HighlightText\",\n          \"Highlight\"\n        )\n      );\n    }\n    this.pdfPage = pdfPage;\n    this.pdfPageRotate = pdfPage.rotate;\n\n    const totalRotation = (this.rotation + this.pdfPageRotate) % 360;\n    this.viewport = pdfPage.getViewport({\n      scale: this.scale * PixelsPerInch.PDF_TO_CSS_UNITS,\n      rotation: totalRotation,\n    });\n    this.#setDimensions();\n    this.reset();\n  }\n\n  destroy() {\n    this.reset();\n    this.pdfPage?.cleanup();\n  }\n\n  get _textHighlighter() {\n    return shadow(\n      this,\n      \"_textHighlighter\",\n      new TextHighlighter({\n        pageIndex: this.id - 1,\n        eventBus: this.eventBus,\n        findController: this.#layerProperties.findController,\n      })\n    );\n  }\n\n  async #renderAnnotationLayer() {\n    let error = null;\n    try {\n      await this.annotationLayer.render(this.viewport, \"display\");\n    } catch (ex) {\n      console.error(`#renderAnnotationLayer: \"${ex}\".`);\n      error = ex;\n    } finally {\n      this.eventBus.dispatch(\"annotationlayerrendered\", {\n        source: this,\n        pageNumber: this.id,\n        error,\n      });\n    }\n  }\n\n  async #renderAnnotationEditorLayer() {\n    let error = null;\n    try {\n      await this.annotationEditorLayer.render(this.viewport, \"display\");\n    } catch (ex) {\n      console.error(`#renderAnnotationEditorLayer: \"${ex}\".`);\n      error = ex;\n    } finally {\n      this.eventBus.dispatch(\"annotationeditorlayerrendered\", {\n        source: this,\n        pageNumber: this.id,\n        error,\n      });\n    }\n  }\n\n  async #renderXfaLayer() {\n    let error = null;\n    try {\n      const result = await this.xfaLayer.render(this.viewport, \"display\");\n      if (result?.textDivs && this._textHighlighter) {\n        // Given that the following method fetches the text asynchronously we\n        // can invoke it *before* appending the xfaLayer to the DOM (below),\n        // since a pending search-highlight/scroll operation thus won't run\n        // until after the xfaLayer is available in the viewer.\n        this.#buildXfaTextContentItems(result.textDivs);\n      }\n    } catch (ex) {\n      console.error(`#renderXfaLayer: \"${ex}\".`);\n      error = ex;\n    } finally {\n      if (this.xfaLayer?.div) {\n        // Pause translation when inserting the xfaLayer in the DOM.\n        this.l10n.pause();\n        this.div.append(this.xfaLayer.div);\n        this.l10n.resume();\n      }\n\n      this.eventBus.dispatch(\"xfalayerrendered\", {\n        source: this,\n        pageNumber: this.id,\n        error,\n      });\n    }\n  }\n\n  async #renderTextLayer() {\n    const { pdfPage, textLayer, viewport } = this;\n    if (!textLayer) {\n      return;\n    }\n\n    let error = null;\n    try {\n      if (!textLayer.renderingDone) {\n        const readableStream = pdfPage.streamTextContent({\n          includeMarkedContent: true,\n          disableNormalization: true,\n        });\n        textLayer.setTextContentSource(readableStream);\n      }\n      await textLayer.render(viewport);\n    } catch (ex) {\n      if (ex instanceof AbortException) {\n        return;\n      }\n      console.error(`#renderTextLayer: \"${ex}\".`);\n      error = ex;\n    }\n\n    this.eventBus.dispatch(\"textlayerrendered\", {\n      source: this,\n      pageNumber: this.id,\n      numTextDivs: textLayer.numTextDivs,\n      error,\n    });\n\n    this.#renderStructTreeLayer();\n  }\n\n  /**\n   * The structure tree is currently only supported when the text layer is\n   * enabled and a canvas is used for rendering.\n   *\n   * The structure tree must be generated after the text layer for the\n   * aria-owns to work.\n   */\n  async #renderStructTreeLayer() {\n    if (!this.textLayer) {\n      return;\n    }\n    this.structTreeLayer ||= new StructTreeLayerBuilder();\n\n    const tree = await (!this.structTreeLayer.renderingDone\n      ? this.pdfPage.getStructTree()\n      : null);\n    const treeDom = this.structTreeLayer?.render(tree);\n    if (treeDom) {\n      // Pause translation when inserting the structTree in the DOM.\n      this.l10n.pause();\n      this.canvas?.append(treeDom);\n      this.l10n.resume();\n    }\n    this.structTreeLayer?.show();\n  }\n\n  async #buildXfaTextContentItems(textDivs) {\n    const text = await this.pdfPage.getTextContent();\n    const items = [];\n    for (const item of text.items) {\n      items.push(item.str);\n    }\n    this._textHighlighter.setTextMapping(textDivs, items);\n    this._textHighlighter.enable();\n  }\n\n  /**\n   * @private\n   */\n  _resetZoomLayer(removeFromDOM = false) {\n    if (!this.zoomLayer) {\n      return;\n    }\n    const zoomLayerCanvas = this.zoomLayer.firstChild;\n    this.#viewportMap.delete(zoomLayerCanvas);\n    // Zeroing the width and height causes Firefox to release graphics\n    // resources immediately, which can greatly reduce memory consumption.\n    zoomLayerCanvas.width = 0;\n    zoomLayerCanvas.height = 0;\n\n    if (removeFromDOM) {\n      // Note: `ChildNode.remove` doesn't throw if the parent node is undefined.\n      this.zoomLayer.remove();\n    }\n    this.zoomLayer = null;\n  }\n\n  reset({\n    keepZoomLayer = false,\n    keepAnnotationLayer = false,\n    keepAnnotationEditorLayer = false,\n    keepXfaLayer = false,\n    keepTextLayer = false,\n  } = {}) {\n    this.cancelRendering({\n      keepAnnotationLayer,\n      keepAnnotationEditorLayer,\n      keepXfaLayer,\n      keepTextLayer,\n    });\n    this.renderingState = RenderingStates.INITIAL;\n\n    const div = this.div;\n\n    const childNodes = div.childNodes,\n      zoomLayerNode = (keepZoomLayer && this.zoomLayer) || null,\n      annotationLayerNode =\n        (keepAnnotationLayer && this.annotationLayer?.div) || null,\n      annotationEditorLayerNode =\n        (keepAnnotationEditorLayer && this.annotationEditorLayer?.div) || null,\n      xfaLayerNode = (keepXfaLayer && this.xfaLayer?.div) || null,\n      textLayerNode = (keepTextLayer && this.textLayer?.div) || null;\n    for (let i = childNodes.length - 1; i >= 0; i--) {\n      const node = childNodes[i];\n      switch (node) {\n        case zoomLayerNode:\n        case annotationLayerNode:\n        case annotationEditorLayerNode:\n        case xfaLayerNode:\n        case textLayerNode:\n          continue;\n      }\n      node.remove();\n    }\n    div.removeAttribute(\"data-loaded\");\n\n    if (annotationLayerNode) {\n      // Hide the annotation layer until all elements are resized\n      // so they are not displayed on the already resized page.\n      this.annotationLayer.hide();\n    }\n    if (annotationEditorLayerNode) {\n      this.annotationEditorLayer.hide();\n    }\n    if (xfaLayerNode) {\n      // Hide the XFA layer until all elements are resized\n      // so they are not displayed on the already resized page.\n      this.xfaLayer.hide();\n    }\n    if (textLayerNode) {\n      this.textLayer.hide();\n    }\n    this.structTreeLayer?.hide();\n\n    if (!zoomLayerNode) {\n      if (this.canvas) {\n        this.#viewportMap.delete(this.canvas);\n        // Zeroing the width and height causes Firefox to release graphics\n        // resources immediately, which can greatly reduce memory consumption.\n        this.canvas.width = 0;\n        this.canvas.height = 0;\n        delete this.canvas;\n      }\n      this._resetZoomLayer();\n    }\n  }\n\n  /**\n   * @typedef {Object} PDFPageViewUpdateParameters\n   * @property {number} [scale] The new scale, if specified.\n   * @property {number} [rotation] The new rotation, if specified.\n   * @property {Promise<OptionalContentConfig>} [optionalContentConfigPromise]\n   *   A promise that is resolved with an {@link OptionalContentConfig}\n   *   instance. The default value is `null`.\n   * @property {number} [drawingDelay]\n   */\n\n  /**\n   * Update e.g. the scale and/or rotation of the page.\n   * @param {PDFPageViewUpdateParameters} params\n   */\n  update({\n    scale = 0,\n    rotation = null,\n    optionalContentConfigPromise = null,\n    drawingDelay = -1,\n  }) {\n    this.scale = scale || this.scale;\n    if (typeof rotation === \"number\") {\n      this.rotation = rotation; // The rotation may be zero.\n    }\n    if (optionalContentConfigPromise instanceof Promise) {\n      this._optionalContentConfigPromise = optionalContentConfigPromise;\n\n      // Ensure that the thumbnails always display the *initial* document state,\n      // for documents with optional content.\n      optionalContentConfigPromise.then(optionalContentConfig => {\n        if (\n          optionalContentConfigPromise !== this._optionalContentConfigPromise\n        ) {\n          return;\n        }\n        this.#useThumbnailCanvas.initialOptionalContent =\n          optionalContentConfig.hasInitialVisibility;\n      });\n    }\n    this.#useThumbnailCanvas.directDrawing = true;\n\n    const totalRotation = (this.rotation + this.pdfPageRotate) % 360;\n    this.viewport = this.viewport.clone({\n      scale: this.scale * PixelsPerInch.PDF_TO_CSS_UNITS,\n      rotation: totalRotation,\n    });\n    this.#setDimensions();\n\n    if (\n      (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"GENERIC\")) &&\n      this._isStandalone\n    ) {\n      this._container?.style.setProperty(\"--scale-factor\", this.viewport.scale);\n    }\n\n    if (this.canvas) {\n      let onlyCssZoom = false;\n      if (this.#hasRestrictedScaling) {\n        if (\n          (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"GENERIC\")) &&\n          this.maxCanvasPixels === 0\n        ) {\n          onlyCssZoom = true;\n        } else if (this.maxCanvasPixels > 0) {\n          const { width, height } = this.viewport;\n          const { sx, sy } = this.outputScale;\n          onlyCssZoom =\n            ((Math.floor(width) * sx) | 0) * ((Math.floor(height) * sy) | 0) >\n            this.maxCanvasPixels;\n        }\n      }\n      const postponeDrawing =\n        !onlyCssZoom && drawingDelay >= 0 && drawingDelay < 1000;\n\n      if (postponeDrawing || onlyCssZoom) {\n        if (\n          postponeDrawing &&\n          this.renderingState !== RenderingStates.FINISHED\n        ) {\n          this.cancelRendering({\n            keepZoomLayer: true,\n            keepAnnotationLayer: true,\n            keepAnnotationEditorLayer: true,\n            keepXfaLayer: true,\n            keepTextLayer: true,\n            cancelExtraDelay: drawingDelay,\n          });\n          // It isn't really finished, but once we have finished\n          // to postpone, we'll call this.reset(...) which will set\n          // the rendering state to INITIAL, hence the next call to\n          // PDFViewer.update() will trigger a redraw (if it's mandatory).\n          this.renderingState = RenderingStates.FINISHED;\n          // Ensure that the thumbnails won't become partially (or fully) blank,\n          // if the sidebar is opened before the actual rendering is done.\n          this.#useThumbnailCanvas.directDrawing = false;\n        }\n\n        this.cssTransform({\n          target: this.canvas,\n          redrawAnnotationLayer: true,\n          redrawAnnotationEditorLayer: true,\n          redrawXfaLayer: true,\n          redrawTextLayer: !postponeDrawing,\n          hideTextLayer: postponeDrawing,\n        });\n\n        if (postponeDrawing) {\n          // The \"pagerendered\"-event will be dispatched once the actual\n          // rendering is done, hence don't dispatch it here as well.\n          return;\n        }\n        this.eventBus.dispatch(\"pagerendered\", {\n          source: this,\n          pageNumber: this.id,\n          cssTransform: true,\n          timestamp: performance.now(),\n          error: this.#renderError,\n        });\n        return;\n      }\n      if (!this.zoomLayer && !this.canvas.hidden) {\n        this.zoomLayer = this.canvas.parentNode;\n        this.zoomLayer.style.position = \"absolute\";\n      }\n    }\n    if (this.zoomLayer) {\n      this.cssTransform({ target: this.zoomLayer.firstChild });\n    }\n    this.reset({\n      keepZoomLayer: true,\n      keepAnnotationLayer: true,\n      keepAnnotationEditorLayer: true,\n      keepXfaLayer: true,\n      keepTextLayer: true,\n    });\n  }\n\n  /**\n   * PLEASE NOTE: Most likely you want to use the `this.reset()` method,\n   *              rather than calling this one directly.\n   */\n  cancelRendering({\n    keepAnnotationLayer = false,\n    keepAnnotationEditorLayer = false,\n    keepXfaLayer = false,\n    keepTextLayer = false,\n    cancelExtraDelay = 0,\n  } = {}) {\n    if (this.renderTask) {\n      this.renderTask.cancel(cancelExtraDelay);\n      this.renderTask = null;\n    }\n    this.resume = null;\n\n    if (this.textLayer && (!keepTextLayer || !this.textLayer.div)) {\n      this.textLayer.cancel();\n      this.textLayer = null;\n    }\n    if (this.structTreeLayer && !this.textLayer) {\n      this.structTreeLayer = null;\n    }\n    if (\n      this.annotationLayer &&\n      (!keepAnnotationLayer || !this.annotationLayer.div)\n    ) {\n      this.annotationLayer.cancel();\n      this.annotationLayer = null;\n      this._annotationCanvasMap = null;\n    }\n    if (\n      this.annotationEditorLayer &&\n      (!keepAnnotationEditorLayer || !this.annotationEditorLayer.div)\n    ) {\n      this.annotationEditorLayer.cancel();\n      this.annotationEditorLayer = null;\n    }\n    if (this.xfaLayer && (!keepXfaLayer || !this.xfaLayer.div)) {\n      this.xfaLayer.cancel();\n      this.xfaLayer = null;\n      this._textHighlighter?.disable();\n    }\n  }\n\n  cssTransform({\n    target,\n    redrawAnnotationLayer = false,\n    redrawAnnotationEditorLayer = false,\n    redrawXfaLayer = false,\n    redrawTextLayer = false,\n    hideTextLayer = false,\n  }) {\n    // Scale target (canvas), its wrapper and page container.\n    if (\n      (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"TESTING\")) &&\n      !(target instanceof HTMLCanvasElement)\n    ) {\n      throw new Error(\"Expected `target` to be a canvas.\");\n    }\n    if (!target.hasAttribute(\"zooming\")) {\n      target.setAttribute(\"zooming\", true);\n      const { style } = target;\n      style.width = style.height = \"\";\n    }\n\n    const originalViewport = this.#viewportMap.get(target);\n    if (this.viewport !== originalViewport) {\n      // The canvas may have been originally rotated; rotate relative to that.\n      const relativeRotation =\n        this.viewport.rotation - originalViewport.rotation;\n      const absRotation = Math.abs(relativeRotation);\n      let scaleX = 1,\n        scaleY = 1;\n      if (absRotation === 90 || absRotation === 270) {\n        const { width, height } = this.viewport;\n        // Scale x and y because of the rotation.\n        scaleX = height / width;\n        scaleY = width / height;\n      }\n      target.style.transform = `rotate(${relativeRotation}deg) scale(${scaleX}, ${scaleY})`;\n    }\n\n    if (redrawAnnotationLayer && this.annotationLayer) {\n      this.#renderAnnotationLayer();\n    }\n    if (redrawAnnotationEditorLayer && this.annotationEditorLayer) {\n      this.#renderAnnotationEditorLayer();\n    }\n    if (redrawXfaLayer && this.xfaLayer) {\n      this.#renderXfaLayer();\n    }\n\n    if (this.textLayer) {\n      if (hideTextLayer) {\n        this.textLayer.hide();\n        this.structTreeLayer?.hide();\n      } else if (redrawTextLayer) {\n        this.#renderTextLayer();\n      }\n    }\n  }\n\n  get width() {\n    return this.viewport.width;\n  }\n\n  get height() {\n    return this.viewport.height;\n  }\n\n  getPagePoint(x, y) {\n    return this.viewport.convertToPdfPoint(x, y);\n  }\n\n  async #finishRenderTask(renderTask, error = null) {\n    // The renderTask may have been replaced by a new one, so only remove\n    // the reference to the renderTask if it matches the one that is\n    // triggering this callback.\n    if (renderTask === this.renderTask) {\n      this.renderTask = null;\n    }\n\n    if (error instanceof RenderingCancelledException) {\n      this.#renderError = null;\n      return;\n    }\n    this.#renderError = error;\n\n    this.renderingState = RenderingStates.FINISHED;\n    this._resetZoomLayer(/* removeFromDOM = */ true);\n\n    // Ensure that the thumbnails won't become partially (or fully) blank,\n    // for documents that contain interactive form elements.\n    this.#useThumbnailCanvas.regularAnnotations = !renderTask.separateAnnots;\n\n    this.eventBus.dispatch(\"pagerendered\", {\n      source: this,\n      pageNumber: this.id,\n      cssTransform: false,\n      timestamp: performance.now(),\n      error: this.#renderError,\n    });\n\n    if (error) {\n      throw error;\n    }\n  }\n\n  async draw() {\n    if (this.renderingState !== RenderingStates.INITIAL) {\n      globalThis.ngxConsole.error(\"Must be in new state before drawing\");\n      this.reset(); // Ensure that we reset all state to prevent issues.\n    }\n    const { div, l10n, pageColors, pdfPage, viewport } = this;\n\n    if (!pdfPage) {\n      this.renderingState = RenderingStates.FINISHED;\n      throw new Error(\"pdfPage is not loaded\");\n    }\n\n    this.renderingState = RenderingStates.RUNNING;\n\n    // Wrap the canvas so that if it has a CSS transform for high DPI the\n    // overflow will be hidden in Firefox.\n    const canvasWrapper = document.createElement(\"div\");\n    canvasWrapper.classList.add(\"canvasWrapper\");\n    div.append(canvasWrapper);\n\n    if (\n      !this.textLayer &&\n      this.#textLayerMode !== TextLayerMode.DISABLE &&\n      !pdfPage.isPureXfa\n    ) {\n      this._accessibilityManager ||= new TextAccessibilityManager();\n\n      this.textLayer = new TextLayerBuilder({\n        highlighter: this._textHighlighter,\n        accessibilityManager: this._accessibilityManager,\n        isOffscreenCanvasSupported: this.isOffscreenCanvasSupported,\n        enablePermissions:\n          this.#textLayerMode === TextLayerMode.ENABLE_PERMISSIONS,\n      });\n      this.textLayer.onAppend = textLayerDiv => {\n        // Pause translation when inserting the textLayer in the DOM.\n        this.l10n.pause();\n        this.div.append(textLayerDiv);\n        this.l10n.resume();\n      };\n    }\n\n    if (\n      !this.annotationLayer &&\n      this.#annotationMode !== AnnotationMode.DISABLE\n    ) {\n      const {\n        annotationStorage,\n        downloadManager,\n        enableScripting,\n        fieldObjectsPromise,\n        hasJSActionsPromise,\n        linkService,\n      } = this.#layerProperties;\n\n      this._annotationCanvasMap ||= new Map();\n      this.annotationLayer = new AnnotationLayerBuilder({\n        pageDiv: div,\n        pdfPage,\n        annotationStorage,\n        imageResourcesPath: this.imageResourcesPath,\n        renderForms: this.#annotationMode === AnnotationMode.ENABLE_FORMS,\n        linkService,\n        downloadManager,\n        enableScripting,\n        hasJSActionsPromise,\n        fieldObjectsPromise,\n        annotationCanvasMap: this._annotationCanvasMap,\n        accessibilityManager: this._accessibilityManager,\n      });\n    }\n\n    const renderContinueCallback = cont => {\n      showCanvas?.(false);\n      if (this.renderingQueue && !this.renderingQueue.isHighestPriority(this)) {\n        this.renderingState = RenderingStates.PAUSED;\n        this.resume = () => {\n          this.renderingState = RenderingStates.RUNNING;\n          cont();\n        };\n        return;\n      }\n      cont();\n    };\n\n    let { width, height } = viewport;\n    const canvas = document.createElement(\"canvas\");\n    canvas.setAttribute(\"role\", \"presentation\");\n\n    // Keep the canvas hidden until the first draw callback, or until drawing\n    // is complete when `!this.renderingQueue`, to prevent black flickering.\n    canvas.hidden = true;\n    const hasHCM = !!(pageColors?.background && pageColors?.foreground);\n\n    let showCanvas = isLastShow => {\n      // In HCM, a final filter is applied on the canvas which means that\n      // before it's applied we've normal colors. Consequently, to avoid to have\n      // a final flash we just display it once all the drawing is done.\n      if (!hasHCM || isLastShow) {\n        canvas.hidden = false;\n        showCanvas = null; // Only invoke the function once.\n      }\n    };\n    canvasWrapper.append(canvas);\n    this.canvas = canvas;\n\n    // #1659 modified by ngx-extended-pdf-viewer\n    const options = window.pdfDefaultOptions.activateWillReadFrequentlyFlag ? { willReadFrequently: true, alpha: false } : { alpha: false };\n    const ctx = canvas.getContext(\"2d\", options);\n    // #1659 end of modification by ngx-extended-pdf-viewer\n    const outputScale = (this.outputScale = new OutputScale());\n\n    if (\n      (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"GENERIC\")) &&\n      this.maxCanvasPixels === 0\n    ) {\n      const invScale = 1 / this.scale;\n      // Use a scale that makes the canvas have the originally intended size\n      // of the page.\n      outputScale.sx *= invScale;\n      outputScale.sy *= invScale;\n      this.#hasRestrictedScaling = true;\n    } else if (this.maxCanvasPixels > 0) {\n      const pixelsInViewport = width * height;\n      const maxScale = Math.sqrt(this.maxCanvasPixels / pixelsInViewport);\n      if (outputScale.sx > maxScale || outputScale.sy > maxScale) {\n        outputScale.sx = maxScale;\n        outputScale.sy = maxScale;\n        this.#hasRestrictedScaling = true;\n      } else {\n        this.#hasRestrictedScaling = false;\n      }\n    }\n    const sfx = approximateFraction(outputScale.sx);\n    const sfy = approximateFraction(outputScale.sy);\n\n    // modified by ngx-extended-pdf-viewer #387, #1095\n    width = roundToDivide(width * outputScale.sx, sfx[0]);\n    height = roundToDivide(height * outputScale.sy, sfy[0]);\n    let divisor = 1;\n    if (width >= 4096 || height >= 4096) {\n      if (!!this.maxWidth || !canvasSize.test({ width, height })) {\n        const max = this.determineMaxDimensions();\n        divisor = Math.max(width / max, height / max);\n        if (divisor > 1) {\n          const newScale = Math.floor((100 * this.scale) / divisor) / 100; // round to integer percentages\n          divisor = this.scale / newScale; // re-calculate the divisor to reflect the rounding to percentages\n\n          viewport.width /= divisor;\n          viewport.height /= divisor;\n          warn(`Page ${this.id}: Reduced the maximum zoom to ${newScale} because the browser can't render larger canvases.`);\n        } else {\n          divisor = 1;\n        }\n      }\n    }\n    // end of modification\n    canvas.width = roundToDivide(viewport.width * outputScale.sx, sfx[0]);\n    canvas.height = roundToDivide(viewport.height * outputScale.sy, sfy[0]);\n    const { style } = canvas;\n    style.width = roundToDivide(viewport.width, sfx[1]) + \"px\";\n    style.height = roundToDivide(viewport.height, sfy[1]) + \"px\";\n\n    // Add the viewport so it's known what it was originally drawn with.\n    this.#viewportMap.set(canvas, viewport);\n\n    // Rendering area\n    const transform = outputScale.scaled\n      ? [outputScale.sx, 0, 0, outputScale.sy, 0, 0]\n      : null;\n    const renderContext = {\n      canvasContext: ctx,\n      transform,\n      viewport,\n      annotationMode: this.#annotationMode,\n      optionalContentConfigPromise: this._optionalContentConfigPromise,\n      annotationCanvasMap: this._annotationCanvasMap,\n      pageColors,\n    };\n    const renderTask = (this.renderTask = this.pdfPage.render(renderContext));\n    renderTask.onContinue = renderContinueCallback;\n\n    const resultPromise = renderTask.promise.then(\n      async () => {\n        showCanvas?.(true);\n        await this.#finishRenderTask(renderTask);\n\n        this.#renderTextLayer();\n\n        if (this.annotationLayer) {\n          await this.#renderAnnotationLayer();\n        }\n\n        if (!this.annotationEditorLayer) {\n          const { annotationEditorUIManager } = this.#layerProperties;\n\n          if (!annotationEditorUIManager) {\n            return;\n          }\n          this.annotationEditorLayer = new AnnotationEditorLayerBuilder({\n            uiManager: annotationEditorUIManager,\n            pageDiv: div,\n            pdfPage,\n            l10n,\n            accessibilityManager: this._accessibilityManager,\n            annotationLayer: this.annotationLayer?.annotationLayer,\n          });\n        }\n        this.#renderAnnotationEditorLayer();\n      },\n      error => {\n        // When zooming with a `drawingDelay` set, avoid temporarily showing\n        // a black canvas if rendering was cancelled before the `onContinue`-\n        // callback had been invoked at least once.\n        if (!(error instanceof RenderingCancelledException)) {\n          showCanvas?.(true);\n        }\n        return this.#finishRenderTask(renderTask, error);\n      }\n    );\n\n    if (pdfPage.isPureXfa) {\n      if (!this.xfaLayer) {\n        const { annotationStorage, linkService } = this.#layerProperties;\n\n        this.xfaLayer = new XfaLayerBuilder({\n          pdfPage,\n          annotationStorage,\n          linkService,\n        });\n      }\n      this.#renderXfaLayer();\n    }\n\n    div.setAttribute(\"data-loaded\", true);\n\n    this.eventBus.dispatch(\"pagerender\", {\n      source: this,\n      pageNumber: this.id,\n    });\n    return resultPromise;\n  }\n\n  /**\n   * @param {string|null} label\n   */\n  setPageLabel(label) {\n    this.pageLabel = typeof label === \"string\" ? label : null;\n\n    this.div.setAttribute(\n      \"data-l10n-args\",\n      JSON.stringify({ page: this.pageLabel ?? this.id })\n    );\n\n    if (this.pageLabel !== null) {\n      this.div.setAttribute(\"data-page-label\", this.pageLabel);\n    } else {\n      this.div.removeAttribute(\"data-page-label\");\n    }\n  }\n\n  // modified (added) by ngx-extended-pdf-viewer #387\n  determineMaxDimensions() {\n    if (this.maxWidth) {\n      return this.maxWidth;\n    }\n    const checklist = [\n      4096, // iOS\n      8192, // IE 9-10\n      10836, // Android\n      11180, // Firefox\n      11402, // Android,\n      14188,\n      16384,\n    ];\n    for (const width of checklist) {\n      if (!canvasSize.test({width: width+1, height: width+1})) {\n        this.maxWidth = width;\n        return this.maxWidth;\n      }\n    }\n    return 16384;\n  }\n  // end of modification\n\n  /**\n   * For use by the `PDFThumbnailView.setImage`-method.\n   * @ignore\n   */\n  get thumbnailCanvas() {\n    const { directDrawing, initialOptionalContent, regularAnnotations } =\n      this.#useThumbnailCanvas;\n    return directDrawing && initialOptionalContent && regularAnnotations\n      ? this.canvas\n      : null;\n  }\n}\n\nexport { PDFPageView };\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** @typedef {import(\"./interfaces\").IRenderableView} IRenderableView */\n/** @typedef {import(\"./pdf_viewer\").PDFViewer} PDFViewer */\n// eslint-disable-next-line max-len\n/** @typedef {import(\"./pdf_thumbnail_viewer\").PDFThumbnailViewer} PDFThumbnailViewer */\n\nimport { RenderingCancelledException } from \"pdfjs-lib\";\nimport { RenderingStates } from \"./ui_utils.js\";\n\nconst CLEANUP_TIMEOUT = 30000;\n\n/**\n * Controls rendering of the views for pages and thumbnails.\n */\nclass PDFRenderingQueue {\n  constructor() {\n    this.pdfViewer = null;\n    this.pdfThumbnailViewer = null;\n    this.onIdle = null;\n    this.highestPriorityPage = null;\n    /** @type {number} */\n    this.idleTimeout = null;\n    this.printing = false;\n    this.isThumbnailViewEnabled = false;\n\n    if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"GENERIC\")) {\n      Object.defineProperty(this, \"hasViewer\", {\n        value: () => !!this.pdfViewer,\n      });\n    }\n  }\n\n  /**\n   * @param {PDFViewer} pdfViewer\n   */\n  setViewer(pdfViewer) {\n    this.pdfViewer = pdfViewer;\n  }\n\n  /**\n   * @param {PDFThumbnailViewer} pdfThumbnailViewer\n   */\n  setThumbnailViewer(pdfThumbnailViewer) {\n    this.pdfThumbnailViewer = pdfThumbnailViewer;\n  }\n\n  /**\n   * @param {IRenderableView} view\n   * @returns {boolean}\n   */\n  isHighestPriority(view) {\n    return this.highestPriorityPage === view.renderingId;\n  }\n\n  /**\n   * @param {Object} currentlyVisiblePages\n   */\n  renderHighestPriority(currentlyVisiblePages) {\n    if (this.idleTimeout) {\n      clearTimeout(this.idleTimeout);\n      this.idleTimeout = null;\n    }\n\n    // Pages have a higher priority than thumbnails, so check them first.\n    if (this.pdfViewer.forceRendering(currentlyVisiblePages)) {\n      return;\n    }\n    // No pages needed rendering, so check thumbnails.\n    if (\n      this.isThumbnailViewEnabled &&\n      this.pdfThumbnailViewer?.forceRendering()\n    ) {\n      return;\n    }\n\n    if (this.printing) {\n      // If printing is currently ongoing do not reschedule cleanup.\n      return;\n    }\n\n    if (this.onIdle) {\n      this.idleTimeout = setTimeout(this.onIdle.bind(this), CLEANUP_TIMEOUT);\n    }\n  }\n\n  /**\n   * @param {Object} visible\n   * @param {Array} views\n   * @param {boolean} scrolledDown\n   * @param {boolean} [preRenderExtra]\n   */\n  getHighestPriority(visible, views, scrolledDown, preRenderExtra = false) {\n    /**\n     * The state has changed. Figure out which page has the highest priority to\n     * render next (if any).\n     *\n     * Priority:\n     * 1. visible pages\n     * 2. if last scrolled down, the page after the visible pages, or\n     *    if last scrolled up, the page before the visible pages\n     */\n    const visibleViews = visible.views,\n      numVisible = visibleViews.length;\n\n    if (numVisible === 0) {\n      return null;\n    }\n    for (let i = 0; i < numVisible; i++) {\n      const view = visibleViews[i].view;\n      if (!this.isViewFinished(view)) {\n        return view;\n      }\n    }\n    const firstId = visible.first.id,\n      lastId = visible.last.id;\n\n    // All the visible views have rendered; try to handle any \"holes\" in the\n    // page layout (can happen e.g. with spreadModes at higher zoom levels).\n    if (lastId - firstId + 1 > numVisible) {\n      const visibleIds = visible.ids;\n      for (let i = 1, ii = lastId - firstId; i < ii; i++) {\n        const holeId = scrolledDown ? firstId + i : lastId - i;\n        if (visibleIds.has(holeId)) {\n          continue;\n        }\n        const holeView = views[holeId - 1];\n        if (!this.isViewFinished(holeView)) {\n          return holeView;\n        }\n      }\n    }\n\n    // All the visible views have rendered; try to render next/previous page.\n    // (IDs start at 1, so no need to add 1 when `scrolledDown === true`.)\n    let preRenderIndex = scrolledDown ? lastId : firstId - 2;\n    let preRenderView = views[preRenderIndex];\n\n    if (preRenderView && !this.isViewFinished(preRenderView)) {\n      return preRenderView;\n    }\n    if (preRenderExtra) {\n      preRenderIndex += scrolledDown ? 1 : -1;\n      preRenderView = views[preRenderIndex];\n\n      if (preRenderView && !this.isViewFinished(preRenderView)) {\n        return preRenderView;\n      }\n    }\n    // Everything that needs to be rendered has been.\n    return null;\n  }\n\n  /**\n   * @param {IRenderableView} view\n   * @returns {boolean}\n   */\n  isViewFinished(view) {\n    return view.renderingState === RenderingStates.FINISHED;\n  }\n\n  /**\n   * Render a page or thumbnail view. This calls the appropriate function\n   * based on the views state. If the view is already rendered it will return\n   * `false`.\n   *\n   * @param {IRenderableView} view\n   */\n  renderView(view) {\n    switch (view.renderingState) {\n      case RenderingStates.FINISHED:\n        return false;\n      case RenderingStates.PAUSED:\n        this.highestPriorityPage = view.renderingId;\n        view.resume();\n        break;\n      case RenderingStates.RUNNING:\n        this.highestPriorityPage = view.renderingId;\n        break;\n      case RenderingStates.INITIAL:\n        this.highestPriorityPage = view.renderingId;\n        view\n          .draw()\n          .finally(() => {\n            this.renderHighestPriority();\n          })\n          .catch(reason => {\n            if (reason instanceof RenderingCancelledException) {\n              return;\n            }\n            globalThis.ngxConsole.error(`renderView: \"${reason}\"`);\n          });\n        break;\n    }\n    return true;\n  }\n}\n\nexport { PDFRenderingQueue };\n","/* Copyright 2021 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { docProperties, GenericScripting } from \"./generic_scripting.js\";\nimport { PDFScriptingManager } from \"./pdf_scripting_manager.js\";\n\nclass PDFScriptingManagerComponents extends PDFScriptingManager {\n  constructor(options) {\n    // The default viewer already handles adding/removing of DOM events,\n    // hence limit this to only the viewer components.\n    if (!options.externalServices) {\n      window.addEventListener(\"updatefromsandbox\", event => {\n        options.eventBus.dispatch(\"updatefromsandbox\", {\n          source: window,\n          detail: event.detail,\n        });\n      });\n    }\n\n    options.externalServices ||= {\n      createScripting: ({ sandboxBundleSrc }) => {\n        return new GenericScripting(sandboxBundleSrc);\n      },\n    };\n    options.docProperties ||= pdfDocument => {\n      return docProperties(pdfDocument);\n    };\n    super(options);\n  }\n}\n\nexport { PDFScriptingManagerComponents as PDFScriptingManager };\n","/* Copyright 2021 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** @typedef {import(\"./event_utils\").EventBus} EventBus */\n\nimport { apiPageLayoutToViewerModes, RenderingStates } from \"./ui_utils.js\";\nimport { PromiseCapability, shadow } from \"pdfjs-lib\";\n\n/**\n * @typedef {Object} PDFScriptingManagerOptions\n * @property {EventBus} eventBus - The application event bus.\n * @property {string} sandboxBundleSrc - The path and filename of the scripting\n *   bundle.\n * @property {Object} [externalServices] - The factory that is used when\n *   initializing scripting; must contain a `createScripting` method.\n *   PLEASE NOTE: Primarily intended for the default viewer use-case.\n * @property {function} [docProperties] - The function that is used to lookup\n *   the necessary document properties.\n */\n\nclass PDFScriptingManager {\n  #closeCapability = null;\n\n  #destroyCapability = null;\n\n  #docProperties = null;\n\n  #eventBus = null;\n\n  #externalServices = null;\n\n  #pdfDocument = null;\n\n  #pdfViewer = null;\n\n  #ready = false;\n\n  #sandboxBundleSrc = null;\n\n  #scripting = null;\n\n  #willPrintCapability = null;\n\n  /**\n   * @param {PDFScriptingManagerOptions} options\n   */\n  constructor({\n    eventBus,\n    sandboxBundleSrc = null,\n    externalServices = null,\n    docProperties = null,\n  }) {\n    this.#eventBus = eventBus;\n    if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"GENERIC || CHROME\")) {\n      this.#sandboxBundleSrc = sandboxBundleSrc;\n    }\n    this.#externalServices = externalServices;\n    this.#docProperties = docProperties;\n  }\n\n  setViewer(pdfViewer) {\n    this.#pdfViewer = pdfViewer;\n  }\n\n  async setDocument(pdfDocument) {\n    if (this.#pdfDocument) {\n      await this.#destroyScripting();\n    }\n    this.#pdfDocument = pdfDocument;\n\n    if (!pdfDocument) {\n      return;\n    }\n    const [objects, calculationOrder, docActions] = await Promise.all([\n      pdfDocument.getFieldObjects(),\n      pdfDocument.getCalculationOrderIds(),\n      pdfDocument.getJSActions(),\n    ]);\n\n    if (!objects && !docActions) {\n      // No FieldObjects or JavaScript actions were found in the document.\n      await this.#destroyScripting();\n      return;\n    }\n    if (pdfDocument !== this.#pdfDocument) {\n      return; // The document was closed while the data resolved.\n    }\n    try {\n      this.#scripting = this.#initScripting();\n    } catch (error) {\n      globalThis.ngxConsole.error(`setDocument: \"${error.message}\".`);\n\n      await this.#destroyScripting();\n      return;\n    }\n\n    this._internalEvents.set(\"updatefromsandbox\", event => {\n      if (event?.source === window) {\n        this.#updateFromSandbox(event.detail);\n      }\n    });\n    this._internalEvents.set(\"dispatcheventinsandbox\", event => {\n      this.#scripting?.dispatchEventInSandbox(event.detail);\n    });\n\n    this._internalEvents.set(\"pagechanging\", ({ pageNumber, previous }) => {\n      if (pageNumber === previous) {\n        return; // The current page didn't change.\n      }\n      this.#dispatchPageClose(previous);\n      this.#dispatchPageOpen(pageNumber);\n    });\n    this._internalEvents.set(\"pagerendered\", ({ pageNumber }) => {\n      if (!this._pageOpenPending.has(pageNumber)) {\n        return; // No pending \"PageOpen\" event for the newly rendered page.\n      }\n      if (pageNumber !== this.#pdfViewer.currentPageNumber) {\n        return; // The newly rendered page is no longer the current one.\n      }\n      this.#dispatchPageOpen(pageNumber);\n    });\n    this._internalEvents.set(\"pagesdestroy\", async () => {\n      await this.#dispatchPageClose(this.#pdfViewer.currentPageNumber);\n\n      await this.#scripting?.dispatchEventInSandbox({\n        id: \"doc\",\n        name: \"WillClose\",\n      });\n\n      this.#closeCapability?.resolve();\n    });\n\n    for (const [name, listener] of this._internalEvents) {\n      this.#eventBus._on(name, listener);\n    }\n\n    try {\n      const docProperties = await this.#docProperties(pdfDocument);\n      if (pdfDocument !== this.#pdfDocument) {\n        return; // The document was closed while the properties resolved.\n      }\n\n      await this.#scripting.createSandbox({\n        objects,\n        calculationOrder,\n        appInfo: {\n          platform: navigator.platform,\n          language: navigator.language,\n        },\n        docInfo: {\n          ...docProperties,\n          actions: docActions,\n        },\n      });\n\n      this.#eventBus.dispatch(\"sandboxcreated\", { source: this });\n    } catch (error) {\n      globalThis.ngxConsole.error(`setDocument: \"${error.message}\".`);\n\n      await this.#destroyScripting();\n      return;\n    }\n\n    await this.#scripting?.dispatchEventInSandbox({\n      id: \"doc\",\n      name: \"Open\",\n    });\n    await this.#dispatchPageOpen(\n      this.#pdfViewer.currentPageNumber,\n      /* initialize = */ true\n    );\n\n    // Defer this slightly, to ensure that scripting is *fully* initialized.\n    Promise.resolve().then(() => {\n      if (pdfDocument === this.#pdfDocument) {\n        this.#ready = true;\n      }\n    });\n  }\n\n  async dispatchWillSave() {\n    return this.#scripting?.dispatchEventInSandbox({\n      id: \"doc\",\n      name: \"WillSave\",\n    });\n  }\n\n  async dispatchDidSave() {\n    return this.#scripting?.dispatchEventInSandbox({\n      id: \"doc\",\n      name: \"DidSave\",\n    });\n  }\n\n  async dispatchWillPrint() {\n    if (!this.#scripting) {\n      return;\n    }\n    await this.#willPrintCapability?.promise;\n    this.#willPrintCapability = new PromiseCapability();\n    try {\n      await this.#scripting.dispatchEventInSandbox({\n        id: \"doc\",\n        name: \"WillPrint\",\n      });\n    } catch (ex) {\n      this.#willPrintCapability.resolve();\n      this.#willPrintCapability = null;\n      throw ex;\n    }\n\n    await this.#willPrintCapability.promise;\n  }\n\n  async dispatchDidPrint() {\n    return this.#scripting?.dispatchEventInSandbox({\n      id: \"doc\",\n      name: \"DidPrint\",\n    });\n  }\n\n  get destroyPromise() {\n    return this.#destroyCapability?.promise || null;\n  }\n\n  get ready() {\n    return this.#ready;\n  }\n\n  /**\n   * @private\n   */\n  get _internalEvents() {\n    return shadow(this, \"_internalEvents\", new Map());\n  }\n\n  /**\n   * @private\n   */\n  get _pageOpenPending() {\n    return shadow(this, \"_pageOpenPending\", new Set());\n  }\n\n  /**\n   * @private\n   */\n  get _visitedPages() {\n    return shadow(this, \"_visitedPages\", new Map());\n  }\n\n  async #updateFromSandbox(detail) {\n    const pdfViewer = this.#pdfViewer;\n    // Ignore some events, see below, that don't make sense in PresentationMode.\n    const isInPresentationMode =\n      pdfViewer.isInPresentationMode || pdfViewer.isChangingPresentationMode;\n\n    const { id, siblings, command, value } = detail;\n    if (!id) {\n      switch (command) {\n        case \"clear\":\n          globalThis.ngxConsole.clear();\n          break;\n        case \"error\":\n          globalThis.ngxConsole.error(value);\n          break;\n        case \"layout\":\n          if (!isInPresentationMode) {\n            const modes = apiPageLayoutToViewerModes(value);\n            pdfViewer.spreadMode = modes.spreadMode;\n          }\n          break;\n        case \"page-num\":\n          pdfViewer.currentPageNumber = value + 1;\n          break;\n        case \"print\":\n          await pdfViewer.pagesPromise;\n          this.#eventBus.dispatch(\"print\", { source: this });\n          break;\n        case \"println\":\n          globalThis.ngxConsole.log(value);\n          break;\n        case \"zoom\":\n          if (!isInPresentationMode) {\n            pdfViewer.currentScaleValue = value;\n          }\n          break;\n        case \"SaveAs\":\n          this.#eventBus.dispatch(\"download\", { source: this });\n          break;\n        case \"FirstPage\":\n          pdfViewer.currentPageNumber = 1;\n          break;\n        case \"LastPage\":\n          pdfViewer.currentPageNumber = pdfViewer.pagesCount;\n          break;\n        case \"NextPage\":\n          pdfViewer.nextPage();\n          break;\n        case \"PrevPage\":\n          pdfViewer.previousPage();\n          break;\n        case \"ZoomViewIn\":\n          if (!isInPresentationMode) {\n            pdfViewer.increaseScale();\n          }\n          break;\n        case \"ZoomViewOut\":\n          if (!isInPresentationMode) {\n            pdfViewer.decreaseScale();\n          }\n          break;\n        case \"WillPrintFinished\":\n          this.#willPrintCapability?.resolve();\n          this.#willPrintCapability = null;\n          break;\n      }\n      return;\n    }\n\n    if (isInPresentationMode && detail.focus) {\n      return;\n    }\n    delete detail.id;\n    delete detail.siblings;\n\n    const ids = siblings ? [id, ...siblings] : [id];\n    for (const elementId of ids) {\n      const element = document.querySelector(\n        `[data-element-id=\"${elementId}\"]`\n      );\n      if (element) {\n        element.dispatchEvent(new CustomEvent(\"updatefromsandbox\", { detail }));\n      } else {\n        // The element hasn't been rendered yet, use the AnnotationStorage.\n        this.#pdfDocument?.annotationStorage.setValue(elementId, detail);\n      }\n    }\n  }\n\n  async #dispatchPageOpen(pageNumber, initialize = false) {\n    const pdfDocument = this.#pdfDocument,\n      visitedPages = this._visitedPages;\n\n    if (initialize) {\n      this.#closeCapability = new PromiseCapability();\n    }\n    if (!this.#closeCapability) {\n      return; // Scripting isn't fully initialized yet.\n    }\n    const pageView = this.#pdfViewer.getPageView(/* index = */ pageNumber - 1);\n\n    if (pageView?.renderingState !== RenderingStates.FINISHED) {\n      this._pageOpenPending.add(pageNumber);\n      return; // Wait for the page to finish rendering.\n    }\n    this._pageOpenPending.delete(pageNumber);\n\n    const actionsPromise = (async () => {\n      // Avoid sending, and thus serializing, the `actions` data more than once.\n      const actions = await (!visitedPages.has(pageNumber)\n        ? pageView.pdfPage?.getJSActions()\n        : null);\n      if (pdfDocument !== this.#pdfDocument) {\n        return; // The document was closed while the actions resolved.\n      }\n\n      await this.#scripting?.dispatchEventInSandbox({\n        id: \"page\",\n        name: \"PageOpen\",\n        pageNumber,\n        actions,\n      });\n    })();\n    visitedPages.set(pageNumber, actionsPromise);\n  }\n\n  async #dispatchPageClose(pageNumber) {\n    const pdfDocument = this.#pdfDocument,\n      visitedPages = this._visitedPages;\n\n    if (!this.#closeCapability) {\n      return; // Scripting isn't fully initialized yet.\n    }\n    if (this._pageOpenPending.has(pageNumber)) {\n      return; // The page is still rendering; no \"PageOpen\" event dispatched.\n    }\n    const actionsPromise = visitedPages.get(pageNumber);\n    if (!actionsPromise) {\n      return; // The \"PageClose\" event must be preceded by a \"PageOpen\" event.\n    }\n    visitedPages.set(pageNumber, null);\n\n    // Ensure that the \"PageOpen\" event is dispatched first.\n    await actionsPromise;\n    if (pdfDocument !== this.#pdfDocument) {\n      return; // The document was closed while the actions resolved.\n    }\n\n    await this.#scripting?.dispatchEventInSandbox({\n      id: \"page\",\n      name: \"PageClose\",\n      pageNumber,\n    });\n  }\n\n  #initScripting() {\n    this.#destroyCapability = new PromiseCapability();\n\n    if (this.#scripting) {\n      throw new Error(\"#initScripting: Scripting already exists.\");\n    }\n    return this.#externalServices.createScripting({\n      sandboxBundleSrc: this.#sandboxBundleSrc,\n    });\n  }\n\n  async #destroyScripting() {\n    if (!this.#scripting) {\n      this.#pdfDocument = null;\n\n      this.#destroyCapability?.resolve();\n      return;\n    }\n    if (this.#closeCapability) {\n      await Promise.race([\n        this.#closeCapability.promise,\n        new Promise(resolve => {\n          // Avoid the scripting/sandbox-destruction hanging indefinitely.\n          setTimeout(resolve, 1000);\n        }),\n      ]).catch(() => {\n        // Ignore any errors, to ensure that the sandbox is always destroyed.\n      });\n      this.#closeCapability = null;\n    }\n    this.#pdfDocument = null;\n\n    try {\n      await this.#scripting.destroySandbox();\n    } catch {}\n\n    this.#willPrintCapability?.reject(new Error(\"Scripting destroyed.\"));\n    this.#willPrintCapability = null;\n\n    for (const [name, listener] of this._internalEvents) {\n      this.#eventBus._off(name, listener);\n    }\n    this._internalEvents.clear();\n\n    this._pageOpenPending.clear();\n    this._visitedPages.clear();\n\n    this.#scripting = null;\n    this.#ready = false;\n\n    this.#destroyCapability?.resolve();\n  }\n}\n\nexport { PDFScriptingManager };\n","/* Copyright 2014 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ScrollMode, SpreadMode } from \"./ui_utils.js\";\nimport { PDFViewer } from \"./pdf_viewer.js\";\n\nclass PDFSinglePageViewer extends PDFViewer {\n  _resetView() {\n    super._resetView();\n    this._scrollMode = ScrollMode.PAGE;\n    this._spreadMode = SpreadMode.NONE;\n  }\n\n  // eslint-disable-next-line accessor-pairs\n  set scrollMode(mode) {}\n\n  _updateScrollMode() {}\n\n  // eslint-disable-next-line accessor-pairs\n  set spreadMode(mode) {}\n\n  _updateSpreadMode() {}\n}\n\nexport { PDFSinglePageViewer };\n","/* Copyright 2014 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FindState, PDFFindController } from \"./pdf_find_controller.js\";\nimport {\n  LinkTarget,\n  PDFLinkService,\n  SimpleLinkService,\n} from \"./pdf_link_service.js\";\nimport {\n  parseQueryString,\n  ProgressBar,\n  RenderingStates,\n  ScrollMode,\n  SpreadMode,\n} from \"./ui_utils.js\";\nimport { AnnotationLayerBuilder } from \"./annotation_layer_builder.js\";\nimport { DownloadManager } from \"./download_manager.js\";\nimport { EventBus } from \"./event_utils.js\";\nimport { GenericL10n } from \"./genericl10n.js\";\nimport { NullL10n } from \"./l10n_utils.js\";\nimport { PDFHistory } from \"./pdf_history.js\";\nimport { PDFPageView } from \"./pdf_page_view.js\";\nimport { PDFScriptingManager } from \"./pdf_scripting_manager.component.js\";\nimport { PDFSinglePageViewer } from \"./pdf_single_page_viewer.js\";\nimport { PDFViewer } from \"./pdf_viewer.js\";\nimport { StructTreeLayerBuilder } from \"./struct_tree_layer_builder.js\";\nimport { TextLayerBuilder } from \"./text_layer_builder.js\";\nimport { XfaLayerBuilder } from \"./xfa_layer_builder.js\";\n\n/* eslint-disable-next-line no-unused-vars */\nconst pdfjsVersion =\n  typeof PDFJSDev !== \"undefined\" ? PDFJSDev.eval(\"BUNDLE_VERSION\") : void 0;\n/* eslint-disable-next-line no-unused-vars */\nconst pdfjsBuild =\n  typeof PDFJSDev !== \"undefined\" ? PDFJSDev.eval(\"BUNDLE_BUILD\") : void 0;\n\nexport {\n  AnnotationLayerBuilder,\n  DownloadManager,\n  EventBus,\n  FindState,\n  GenericL10n,\n  LinkTarget,\n  NullL10n,\n  parseQueryString,\n  PDFFindController,\n  PDFHistory,\n  PDFLinkService,\n  PDFPageView,\n  PDFScriptingManager,\n  PDFSinglePageViewer,\n  PDFViewer,\n  ProgressBar,\n  RenderingStates,\n  ScrollMode,\n  SimpleLinkService,\n  SpreadMode,\n  StructTreeLayerBuilder,\n  TextLayerBuilder,\n  XfaLayerBuilder,\n};\n","/* Copyright 2014 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** @typedef {import(\"../src/display/api\").PDFDocumentProxy} PDFDocumentProxy */\n/** @typedef {import(\"../src/display/api\").PDFPageProxy} PDFPageProxy */\n// eslint-disable-next-line max-len\n/** @typedef {import(\"../src/display/display_utils\").PageViewport} PageViewport */\n// eslint-disable-next-line max-len\n/** @typedef {import(\"../src/display/optional_content_config\").OptionalContentConfig} OptionalContentConfig */\n/** @typedef {import(\"./event_utils\").EventBus} EventBus */\n/** @typedef {import(\"./interfaces\").IDownloadManager} IDownloadManager */\n/** @typedef {import(\"./interfaces\").IL10n} IL10n */\n/** @typedef {import(\"./interfaces\").IPDFLinkService} IPDFLinkService */\n// eslint-disable-next-line max-len\n/** @typedef {import(\"./pdf_find_controller\").PDFFindController} PDFFindController */\n// eslint-disable-next-line max-len\n/** @typedef {import(\"./pdf_scripting_manager\").PDFScriptingManager} PDFScriptingManager */\n\nimport {\n  AnnotationEditorType,\n  AnnotationEditorUIManager,\n  AnnotationMode,\n  PermissionFlag,\n  PixelsPerInch,\n  PromiseCapability,\n  shadow,\n  version,\n} from \"pdfjs-lib\";\nimport {\n  DEFAULT_SCALE,\n  DEFAULT_SCALE_DELTA,\n  DEFAULT_SCALE_VALUE,\n  docStyle,\n  getVisibleElements,\n  isPortraitOrientation,\n  isValidRotation,\n  isValidScrollMode,\n  isValidSpreadMode,\n  MAX_AUTO_SCALE,\n  MAX_SCALE,\n  MIN_SCALE,\n  PresentationModeState,\n  removeNullCharacters,\n  RenderingStates,\n  SCROLLBAR_PADDING,\n  scrollIntoView,\n  ScrollMode,\n  SpreadMode,\n  TextLayerMode,\n  UNKNOWN_SCALE,\n  VERTICAL_PADDING,\n  watchScroll,\n} from \"./ui_utils.js\";\nimport { NullL10n } from \"web-l10n_utils\";\nimport { PageFlip } from \"./page-flip.module.js\"; // #716 modified by ngx-extended-pdf-viewer\nimport { PDFPageView } from \"./pdf_page_view.js\";\nimport { PDFRenderingQueue } from \"./pdf_rendering_queue.js\";\nimport { SimpleLinkService } from \"./pdf_link_service.js\";\n\nconst DEFAULT_CACHE_SIZE = 10;\n\nconst PagesCountLimit = {\n  FORCE_SCROLL_MODE_PAGE: 15000,\n  FORCE_LAZY_PAGE_INIT: 7500,\n  PAUSE_EAGER_PAGE_INIT: 250,\n};\n\nfunction isValidAnnotationEditorMode(mode) {\n  return (\n    Object.values(AnnotationEditorType).includes(mode) &&\n    mode !== AnnotationEditorType.DISABLE\n  );\n}\n\n/**\n * @typedef {Object} PDFViewerOptions\n * @property {HTMLDivElement} container - The container for the viewer element.\n * @property {HTMLDivElement} [viewer] - The viewer element.\n * @property {EventBus} eventBus - The application event bus.\n * @property {IPDFLinkService} [linkService] - The navigation/linking service.\n * @property {IDownloadManager} [downloadManager] - The download manager\n *   component.\n * @property {PDFFindController} [findController] - The find controller\n *   component.\n * @property {PDFScriptingManager} [scriptingManager] - The scripting manager\n *   component.\n * @property {PDFRenderingQueue} [renderingQueue] - The rendering queue object.\n * @property {boolean} [removePageBorders] - Removes the border shadow around\n *   the pages. The default value is `false`.\n * @property {number} [textLayerMode] - Controls if the text layer used for\n *   selection and searching is created. The constants from {TextLayerMode}\n *   should be used. The default value is `TextLayerMode.ENABLE`.\n * @property {number} [annotationMode] - Controls if the annotation layer is\n *   created, and if interactive form elements or `AnnotationStorage`-data are\n *   being rendered. The constants from {@link AnnotationMode} should be used;\n *   see also {@link RenderParameters} and {@link GetOperatorListParameters}.\n *   The default value is `AnnotationMode.ENABLE_FORMS`.\n * @property {number} [annotationEditorMode] - Enables the creation and editing\n *   of new Annotations. The constants from {@link AnnotationEditorType} should\n *   be used. The default value is `AnnotationEditorType.NONE`.\n * @property {string} [imageResourcesPath] - Path for image resources, mainly\n *   mainly for annotation icons. Include trailing slash.\n * @property {boolean} [enablePrintAutoRotate] - Enables automatic rotation of\n *   landscape pages upon printing. The default is `false`.\n * @property {boolean} [isOffscreenCanvasSupported] - Allows to use an\n *   OffscreenCanvas if needed.\n * @property {number} [maxCanvasPixels] - The maximum supported canvas size in\n *   total pixels, i.e. width * height. Use `-1` for no limit, or `0` for\n *   CSS-only zooming. The default value is 4096 * 4096 (16 mega-pixels).\n * @property {IL10n} [l10n] - Localization service.\n * @property {boolean} [enablePermissions] - Enables PDF document permissions,\n *   when they exist. The default value is `false`.\n * @property {Object} [pageColors] - Overwrites background and foreground colors\n *   with user defined ones in order to improve readability in high contrast\n *   mode.\n */\n\nclass PDFPageViewBuffer {\n  // Here we rely on the fact that `Set`s preserve the insertion order.\n  #buf = new Set();\n\n  #size = 0;\n\n  constructor(size) {\n    this.#size = size;\n  }\n\n  push(view) {\n    const buf = this.#buf;\n    if (buf.has(view)) {\n      buf.delete(view); // Move the view to the \"end\" of the buffer.\n    }\n    buf.add(view);\n\n    if (buf.size > this.#size) {\n      this.#destroyFirstView();\n    }\n  }\n\n  /**\n   * After calling resize, the size of the buffer will be `newSize`.\n   * The optional parameter `idsToKeep` is, if present, a Set of page-ids to\n   * push to the back of the buffer, delaying their destruction. The size of\n   * `idsToKeep` has no impact on the final size of the buffer; if `idsToKeep`\n   * is larger than `newSize`, some of those pages will be destroyed anyway.\n   */\n  resize(newSize, idsToKeep = null) {\n    this.#size = newSize;\n\n    const buf = this.#buf;\n    if (idsToKeep) {\n      const ii = buf.size;\n      let i = 1;\n      for (const view of buf) {\n        if (idsToKeep.has(view.id)) {\n          buf.delete(view); // Move the view to the \"end\" of the buffer.\n          buf.add(view);\n        }\n        if (++i > ii) {\n          break;\n        }\n      }\n    }\n\n    while (buf.size > this.#size) {\n      this.#destroyFirstView();\n    }\n  }\n\n  has(view) {\n    return this.#buf.has(view);\n  }\n\n  [Symbol.iterator]() {\n    return this.#buf.keys();\n  }\n\n  #destroyFirstView() {\n    const firstView = this.#buf.keys().next().value;\n\n    firstView?.destroy();\n    this.#buf.delete(firstView);\n  }\n}\n\n/**\n * Simple viewer control to display PDF content/pages.\n */\nclass PDFViewer {\n  #buffer = null;\n\n  #altTextManager = null;\n\n  #annotationEditorMode = AnnotationEditorType.NONE;\n\n  #annotationEditorUIManager = null;\n\n  #annotationMode = AnnotationMode.ENABLE_FORMS;\n\n  #containerTopLeft = null;\n\n  #copyCallbackBound = null;\n\n  #enablePermissions = false;\n\n  #getAllTextInProgress = false;\n\n  #hiddenCopyElement = null;\n\n  #interruptCopyCondition = false;\n\n  #previousContainerHeight = 0;\n\n  #resizeObserver = new ResizeObserver(this.#resizeObserverCallback.bind(this));\n\n  #scrollModePageState = null;\n\n  #onVisibilityChange = null;\n\n  #scaleTimeoutId = null;\n\n  #textLayerMode = TextLayerMode.ENABLE;\n\n  /**\n   * @param {PDFViewerOptions} options\n   */\n  constructor(options) {\n    const viewerVersion =\n      typeof PDFJSDev !== \"undefined\" ? PDFJSDev.eval(\"BUNDLE_VERSION\") : null;\n    if (version !== viewerVersion) {\n      throw new Error(\n        `The API version \"${version}\" does not match the Viewer version \"${viewerVersion}\".`\n      );\n    }\n    this.container = options.container;\n    this.viewer = options.viewer || options.container.firstElementChild;\n\n    /** #495 modified by ngx-extended-pdf-viewer */\n    this.pageViewMode = options.pageViewMode || \"multiple\";\n    /** end of modification */\n\n    if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"GENERIC\")) {\n      if (this.container?.tagName !== \"DIV\" || this.viewer?.tagName !== \"DIV\") {\n        throw new Error(\"Invalid `container` and/or `viewer` option.\");\n      }\n\n      if (\n        this.container.offsetParent &&\n        getComputedStyle(this.container).position !== \"absolute\"\n      ) {\n        throw new Error(\"The `container` must be absolutely positioned.\");\n      }\n    }\n    this.#resizeObserver.observe(this.container);\n\n    this.eventBus = options.eventBus;\n    this.linkService = options.linkService || new SimpleLinkService();\n    this.downloadManager = options.downloadManager || null;\n    this.findController = options.findController || null;\n    this.#altTextManager = options.altTextManager || null;\n\n    if (this.findController) {\n      this.findController.onIsPageVisible = pageNumber =>\n        this._getVisiblePages().ids.has(pageNumber);\n    }\n    this._scriptingManager = options.scriptingManager || null;\n    this.#textLayerMode = options.textLayerMode ?? TextLayerMode.ENABLE;\n    this.#annotationMode =\n      options.annotationMode ?? AnnotationMode.ENABLE_FORMS;\n    this.#annotationEditorMode =\n      options.annotationEditorMode ?? AnnotationEditorType.NONE;\n    this.imageResourcesPath = options.imageResourcesPath || \"\";\n    this.enablePrintAutoRotate = options.enablePrintAutoRotate || false;\n    if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"GENERIC\")) {\n      this.removePageBorders = options.removePageBorders || false;\n    }\n    this.isOffscreenCanvasSupported =\n      options.isOffscreenCanvasSupported ?? true;\n    this.maxCanvasPixels = options.maxCanvasPixels;\n    this.l10n = options.l10n || NullL10n;\n    this.#enablePermissions = options.enablePermissions || false;\n    this.pageColors = options.pageColors || null;\n\n    this.defaultRenderingQueue = !options.renderingQueue;\n    if (\n      (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"GENERIC\")) &&\n      this.defaultRenderingQueue\n    ) {\n      // Custom rendering queue is not specified, using default one\n      this.renderingQueue = new PDFRenderingQueue();\n      this.renderingQueue.setViewer(this);\n    } else {\n      this.renderingQueue = options.renderingQueue;\n    }\n\n    this.scroll = watchScroll(this.container, this._scrollUpdate.bind(this));\n    this.presentationModeState = PresentationModeState.UNKNOWN;\n    this._onBeforeDraw = this._onAfterDraw = null;\n    this._resetView();\n\n    if (\n      (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"GENERIC\")) &&\n      this.removePageBorders\n    ) {\n      this.viewer.classList.add(\"removePageBorders\");\n    }\n\n    this.#updateContainerHeightCss();\n\n    // Trigger API-cleanup, once thumbnail rendering has finished,\n    // if the relevant pageView is *not* cached in the buffer.\n    this.eventBus._on(\"thumbnailrendered\", ({ pageNumber, pdfPage }) => {\n      const pageView = this._pages[pageNumber - 1];\n      if (!this.#buffer.has(pageView)) {\n        pdfPage?.cleanup();\n      }\n    });\n\n    if (\n      (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"GENERIC\")) &&\n      this.l10n === NullL10n\n    ) {\n      // Ensure that Fluent is connected in e.g. the COMPONENTS build.\n      this.l10n.translate(this.container);\n    }\n  }\n\n  get pagesCount() {\n    return this._pages.length;\n  }\n\n  getPageView(index) {\n    return this._pages[index];\n  }\n\n  getCachedPageViews() {\n    return new Set(this.#buffer);\n  }\n\n  /**\n   * @type {boolean} - True if all {PDFPageView} objects are initialized.\n   */\n  get pageViewsReady() {\n    // Prevent printing errors when 'disableAutoFetch' is set, by ensuring\n    // that *all* pages have in fact been completely loaded.\n    return (\n      this._pagesCapability.settled &&\n      this._pages.every(pageView => pageView?.pdfPage)\n    );\n  }\n\n  /**\n   * @type {boolean}\n   */\n  get renderForms() {\n    return this.#annotationMode === AnnotationMode.ENABLE_FORMS;\n  }\n\n  /**\n   * @type {boolean}\n   */\n  get enableScripting() {\n    return !!this._scriptingManager;\n  }\n\n  /**\n   * @type {number}\n   */\n  get currentPageNumber() {\n    return this._currentPageNumber;\n  }\n\n  /**\n   * @param {number} val - The page number.\n   */\n  set currentPageNumber(val) {\n    if (!Number.isInteger(val)) {\n      throw new Error(\"Invalid page number.\");\n    }\n    if (!this.pdfDocument) {\n      return;\n    }\n\n    // #716 modified by ngx-extended-pdf-viewer\n    const flip = Math.abs(this._currentPageNumber - val) <= 2;\n    // #716 end of modification\n\n    // The intent can be to just reset a scroll position and/or scale.\n    if (!this._setCurrentPageNumber(val, /* resetCurrentPageView = */ true)) {\n      globalThis.ngxConsole.error(`currentPageNumber: \"${val}\" is not a valid page.`);\n    }\n    // #716 modified by ngx-extended-pdf-viewer\n    if (this.pageFlip) {\n      if (flip) {\n        this.pageFlip.flip(val - 1);\n      } else {\n        this.pageFlip.turnToPage(val - 1);\n      }\n    }\n    // #716 end of modification\n  }\n\n  /** #495 modified by ngx-extended-pdf-viewer */\n  hidePagesDependingOnpageViewMode() {\n    if (this.pageViewMode === \"book\") {\n      if (!this.pageFlip) {\n        setTimeout(() => {\n          if (!this.pageFlip) {\n            const page1 = this._pages[0].div;\n            const htmlParentElement = page1.parentElement;\n            const viewer = htmlParentElement.parentElement;\n            viewer.style.width = 2 * page1.clientWidth + \"px\";\n            viewer.style.overflow = \"hidden\";\n            viewer.style.marginLeft = \"auto\";\n            viewer.style.marginRight = \"auto\";\n            this.pageFlip = new PageFlip(htmlParentElement, {\n              width: page1.clientWidth,\n              height: page1.clientHeight,\n              showCover: true,\n              size: \"fixed\",\n            });\n            this.pageFlip.loadFromHTML(document.querySelectorAll(\".page\"));\n            this.ensureAdjecentPagesAreLoaded();\n            // triggered by page turning\n            this.pageFlip.on(\"flip\", e => {\n              if (this._currentPageNumber !== e.data + 1) {\n                this._setCurrentPageNumber(e.data + 1, false);\n              }\n            });\n          }\n        }, 100);\n      }\n      // #716 end of modification\n    }\n  }\n  /** end of modification */\n\n  /**\n   * @returns {boolean} Whether the pageNumber is valid (within bounds).\n   * @private\n   */\n  _setCurrentPageNumber(val, resetCurrentPageView = false) {\n    if (this._currentPageNumber === val) {\n      if (resetCurrentPageView) {\n        this.#resetCurrentPageView();\n      }\n      return true;\n    }\n\n    if (!(0 < val && val <= this.pagesCount)) {\n      return false;\n    }\n    const previous = this._currentPageNumber;\n    this._currentPageNumber = val;\n\n    /** #495 modified by ngx-extended-pdf-viewer */\n    this.hidePagesDependingOnpageViewMode();\n    // #716 modified by ngx-extended-pdf-viewer\n    if (this.pageViewMode === \"book\" || this.pageViewMode === \"infinite-scroll\") {\n      const pageView = this._pages[this.currentPageNumber - 1];\n      if (pageView.div.parentElement.classList.contains(\"spread\")) {\n        pageView.div.parentElement.childNodes.forEach(div => {\n          const pageNumber = Number(div.getAttribute(\"data-page-number\"));\n          const pv = this._pages[pageNumber - 1];\n          this.#ensurePdfPageLoaded(pv).then(() => {\n            this.renderingQueue.renderView(pv);\n          });\n          div.style.display = \"inline-block\";\n        });\n      } else {\n        this.#ensurePdfPageLoaded(pageView).then(() => {\n          this.renderingQueue.renderView(pageView);\n        });\n        // #716 modified by ngx-extended-pdf-viewer\n        if (this.pageViewMode === \"book\") {\n          this.ensureAdjecentPagesAreLoaded();\n        }\n        // #716 modified by ngx-extended-pdf-viewer\n      }\n    }\n    /** end of modification */\n\n    this.eventBus.dispatch(\"pagechanging\", {\n      source: this,\n      pageNumber: val,\n      pageLabel: this._pageLabels?.[val - 1] ?? null,\n      previous,\n    });\n\n    if (resetCurrentPageView) {\n      this.#resetCurrentPageView();\n    }\n    return true;\n  }\n\n  // #950 modified by ngx-extended-pdf-viewer\n  /**\n   * Adds a page to the rendering queue\n   * @param {number} pageIndex Index of the page to render\n   * @returns {boolean} false, if the page has already been rendered\n   * or if it's out of range\n   */\n  addPageToRenderQueue(pageIndex = 0) {\n    if (pageIndex >= 0 && pageIndex <= this._pages.length - 1) {\n      const pageView = this._pages[pageIndex];\n      const isLoading = pageView.renderingState === RenderingStates.INITIAL;\n      if (isLoading) {\n        this.#ensurePdfPageLoaded(pageView).then(() => {\n          // todo: this cancels any rendering that's already in progress\n          this.renderingQueue.renderView(pageView);\n        });\n        return true;\n      }\n    }\n    return false;\n  }\n  // #950 end of modification by ngx-extended-pdf-viewer\n\n  // #716 modified by ngx-extended-pdf-viewer\n  async ensureAdjecentPagesAreLoaded() {\n    const advances = [0, 1, -1, 2, -2];\n    for (const advance of advances) {\n      const pageIndex = this.currentPageNumber + advance;\n      if (pageIndex >= 0 && pageIndex < this._pages.length) {\n        const pageView = this._pages[pageIndex];\n        await this.#ensurePdfPageLoaded(pageView);\n      }\n    }\n\n    const loader = () => this.adjacentPagesLoader(loader);\n    this.eventBus._on(\"pagerendered\", loader);\n    this.eventBus._on(\"thumbnailRendered\", loader);\n  }\n\n  adjacentPagesLoader(self) {\n    const advances = [0, 1, -1, 2, -2];\n    const isAlreadyRendering = this._pages.some(pageView => pageView.renderingState === RenderingStates.RUNNING);\n    if (isAlreadyRendering) {\n      // renderView() cancels any rendering in progress -\n      // let's wait until the page has rendered\n      return;\n    }\n    const pausedRendering = this._pages.find(pageView => pageView.renderingState === RenderingStates.PAUSED);\n    if (pausedRendering) {\n      this.renderingQueue.renderView(pausedRendering);\n      return;\n    }\n\n    for (const advance of advances) {\n      const pageIndex = this.currentPageNumber + advance;\n      if (pageIndex >= 0 && pageIndex < this._pages.length) {\n        const pageView = this._pages[pageIndex];\n        const needsToBeRendered = pageView.renderingState === RenderingStates.INITIAL;\n        if (needsToBeRendered) {\n          this.renderingQueue.renderView(pageView);\n          return;\n        }\n      }\n    }\n    this.eventBus._off(\"pagerendered\", self);\n    this.eventBus._off(\"thumbnailRendered\", self);\n  }\n  // #716 modified by ngx-extended-pdf-viewer\n\n  /**\n   * @type {string|null} Returns the current page label, or `null` if no page\n   *   labels exist.\n   */\n  get currentPageLabel() {\n    return this._pageLabels?.[this._currentPageNumber - 1] ?? null;\n  }\n\n  /**\n   * @param {string} val - The page label.\n   */\n  set currentPageLabel(val) {\n    if (!this.pdfDocument) {\n      return;\n    }\n    let page = val | 0; // Fallback page number.\n    if (this._pageLabels) {\n      const i = this._pageLabels.indexOf(val);\n      if (i >= 0) {\n        page = i + 1;\n      }\n    }\n    // The intent can be to just reset a scroll position and/or scale.\n    if (!this._setCurrentPageNumber(page, /* resetCurrentPageView = */ true)) {\n      globalThis.ngxConsole.error(`currentPageLabel: \"${val}\" is not a valid page.`);\n    }\n  }\n\n  /**\n   * @type {number}\n   */\n  get currentScale() {\n    return this._currentScale !== UNKNOWN_SCALE\n      ? this._currentScale\n      : DEFAULT_SCALE;\n  }\n\n  /**\n   * @param {number} val - Scale of the pages in percents.\n   */\n  set currentScale(val) {\n    if (isNaN(val)) {\n      throw new Error(\"Invalid numeric scale.\");\n    }\n    if (!this.pdfDocument) {\n      return;\n    }\n    this.#setScale(val, { noScroll: false });\n  }\n\n  /**\n   * @type {string}\n   */\n  get currentScaleValue() {\n    return this._currentScaleValue;\n  }\n\n  /**\n   * @param val - The scale of the pages (in percent or predefined value).\n   */\n  set currentScaleValue(val) {\n    if (!this.pdfDocument) {\n      return;\n    }\n    this.#setScale(val, { noScroll: false });\n  }\n\n  /**\n   * @type {number}\n   */\n  get pagesRotation() {\n    return this._pagesRotation;\n  }\n\n  /**\n   * @param {number} rotation - The rotation of the pages (0, 90, 180, 270).\n   */\n  set pagesRotation(rotation) {\n    if (!isValidRotation(rotation)) {\n      throw new Error(\"Invalid pages rotation angle.\");\n    }\n    if (!this.pdfDocument) {\n      return;\n    }\n    // Normalize the rotation, by clamping it to the [0, 360) range.\n    rotation %= 360;\n    if (rotation < 0) {\n      rotation += 360;\n    }\n    if (this._pagesRotation === rotation) {\n      return; // The rotation didn't change.\n    }\n    this._pagesRotation = rotation;\n\n    const pageNumber = this._currentPageNumber;\n\n    this.refresh(true, { rotation });\n\n    // Prevent errors in case the rotation changes *before* the scale has been\n    // set to a non-default value.\n    if (this._currentScaleValue) {\n      this.#setScale(this._currentScaleValue, { noScroll: true });\n    }\n\n    this.eventBus.dispatch(\"rotationchanging\", {\n      source: this,\n      pagesRotation: rotation,\n      pageNumber,\n    });\n\n    if (this.defaultRenderingQueue) {\n      this.update();\n    }\n  }\n\n  get firstPagePromise() {\n    return this.pdfDocument ? this._firstPageCapability.promise : null;\n  }\n\n  get onePageRendered() {\n    return this.pdfDocument ? this._onePageRenderedCapability.promise : null;\n  }\n\n  get pagesPromise() {\n    return this.pdfDocument ? this._pagesCapability.promise : null;\n  }\n\n  get _layerProperties() {\n    const self = this;\n    return shadow(this, \"_layerProperties\", {\n      get annotationEditorUIManager() {\n        return self.#annotationEditorUIManager;\n      },\n      get annotationStorage() {\n        return self.pdfDocument?.annotationStorage;\n      },\n      get downloadManager() {\n        return self.downloadManager;\n      },\n      get enableScripting() {\n        return !!self._scriptingManager;\n      },\n      get fieldObjectsPromise() {\n        return self.pdfDocument?.getFieldObjects();\n      },\n      get findController() {\n        return self.findController;\n      },\n      get hasJSActionsPromise() {\n        return self.pdfDocument?.hasJSActions();\n      },\n      get linkService() {\n        return self.linkService;\n      },\n    });\n  }\n\n  /**\n   * Currently only *some* permissions are supported.\n   * @returns {Object}\n   */\n  #initializePermissions(permissions) {\n    const params = {\n      annotationEditorMode: this.#annotationEditorMode,\n      annotationMode: this.#annotationMode,\n      textLayerMode: this.#textLayerMode,\n    };\n    if (!permissions) {\n      return params;\n    }\n\n    if (\n      !permissions.includes(PermissionFlag.COPY) &&\n      this.#textLayerMode === TextLayerMode.ENABLE\n    ) {\n      params.textLayerMode = TextLayerMode.ENABLE_PERMISSIONS;\n    }\n\n    if (!permissions.includes(PermissionFlag.MODIFY_CONTENTS)) {\n      params.annotationEditorMode = AnnotationEditorType.DISABLE;\n    }\n\n    if (\n      !permissions.includes(PermissionFlag.MODIFY_ANNOTATIONS) &&\n      !permissions.includes(PermissionFlag.FILL_INTERACTIVE_FORMS) &&\n      this.#annotationMode === AnnotationMode.ENABLE_FORMS\n    ) {\n      params.annotationMode = AnnotationMode.ENABLE;\n    }\n\n    return params;\n  }\n\n  #onePageRenderedOrForceFetch() {\n    // Unless the viewer *and* its pages are visible, rendering won't start and\n    // `this._onePageRenderedCapability` thus won't be resolved.\n    // To ensure that automatic printing, on document load, still works even in\n    // those cases we force-allow fetching of all pages when:\n    //  - The current window/tab is inactive, which will prevent rendering since\n    //    `requestAnimationFrame` is being used; fixes bug 1746213.\n    //  - The viewer is hidden in the DOM, e.g. in a `display: none` <iframe>\n    //    element; fixes bug 1618621.\n    //  - The viewer is visible, but none of the pages are (e.g. if the\n    //    viewer is very small); fixes bug 1618955.\n    if (\n      document.visibilityState === \"hidden\" ||\n      !this.container.offsetParent ||\n      this._getVisiblePages().views.length === 0\n    ) {\n      return Promise.resolve();\n    }\n\n    // Handle the window/tab becoming inactive *after* rendering has started;\n    // fixes (another part of) bug 1746213.\n    const visibilityChangePromise = new Promise(resolve => {\n      this.#onVisibilityChange = () => {\n        if (document.visibilityState !== \"hidden\") {\n          return;\n        }\n        resolve();\n\n        document.removeEventListener(\n          \"visibilitychange\",\n          this.#onVisibilityChange\n        );\n        this.#onVisibilityChange = null;\n      };\n      document.addEventListener(\"visibilitychange\", this.#onVisibilityChange);\n    });\n\n    return Promise.race([\n      this._onePageRenderedCapability.promise,\n      visibilityChangePromise,\n    ]);\n  }\n\n  async getAllText() {\n    const texts = [];\n    const buffer = [];\n    for (\n      let pageNum = 1, pagesCount = this.pdfDocument.numPages;\n      pageNum <= pagesCount;\n      ++pageNum\n    ) {\n      if (this.#interruptCopyCondition) {\n        return null;\n      }\n      buffer.length = 0;\n      const page = await this.pdfDocument.getPage(pageNum);\n      // By default getTextContent pass disableNormalization equals to false\n      // which is fine because we want a normalized string.\n      const { items } = await page.getTextContent();\n      for (const item of items) {\n        if (item.str) {\n          buffer.push(item.str);\n        }\n        if (item.hasEOL) {\n          buffer.push(\"\\n\");\n        }\n      }\n      texts.push(removeNullCharacters(buffer.join(\"\")));\n    }\n\n    return texts.join(\"\\n\");\n  }\n\n  #copyCallback(textLayerMode, event) {\n    const selection = document.getSelection();\n    const { focusNode, anchorNode } = selection;\n    if (\n      anchorNode &&\n      focusNode &&\n      selection.containsNode(this.#hiddenCopyElement)\n    ) {\n      // About the condition above:\n      //  - having non-null anchorNode and focusNode are here to guaranty that\n      //    we have at least a kind of selection.\n      //  - this.#hiddenCopyElement is an invisible element which is impossible\n      //    to select manually (its display is none) but ctrl+A will select all\n      //    including this element so having it in the selection means that all\n      //    has been selected.\n\n      if (\n        this.#getAllTextInProgress ||\n        textLayerMode === TextLayerMode.ENABLE_PERMISSIONS\n      ) {\n        event.preventDefault();\n        event.stopPropagation();\n        return;\n      }\n      this.#getAllTextInProgress = true;\n\n      // TODO: if all the pages are rendered we don't need to wait for\n      // getAllText and we could just get text from the Selection object.\n\n      // Select all the document.\n      const savedCursor = this.container.style.cursor;\n      this.container.style.cursor = \"wait\";\n\n      const interruptCopy = ev =>\n        (this.#interruptCopyCondition = ev.key === \"Escape\");\n      window.addEventListener(\"keydown\", interruptCopy);\n\n      this.getAllText()\n        .then(async text => {\n          if (text !== null) {\n            await navigator.clipboard.writeText(text);\n          }\n        })\n        .catch(reason => {\n          console.warn(\n            `Something goes wrong when extracting the text: ${reason.message}`\n          );\n        })\n        .finally(() => {\n          this.#getAllTextInProgress = false;\n          this.#interruptCopyCondition = false;\n          window.removeEventListener(\"keydown\", interruptCopy);\n          this.container.style.cursor = savedCursor;\n        });\n\n      event.preventDefault();\n      event.stopPropagation();\n    }\n  }\n\n  /**\n   * @param {PDFDocumentProxy} pdfDocument\n   */\n  setDocument(pdfDocument) {\n    if (this.pdfDocument) {\n      this.eventBus.dispatch(\"pagesdestroy\", { source: this });\n\n      this._cancelRendering();\n      this._resetView();\n\n      this.findController?.setDocument(null);\n      this._scriptingManager?.setDocument(null);\n\n      if (this.#annotationEditorUIManager) {\n        this.#annotationEditorUIManager.destroy();\n        this.#annotationEditorUIManager = null;\n      }\n    }\n\n    this.pdfDocument = pdfDocument;\n    if (!pdfDocument) {\n      return;\n    }\n    const pagesCount = pdfDocument.numPages;\n    const firstPagePromise = pdfDocument.getPage(1);\n    // Rendering (potentially) depends on this, hence fetching it immediately.\n    const optionalContentConfigPromise = pdfDocument.getOptionalContentConfig();\n    const permissionsPromise = this.#enablePermissions\n      ? pdfDocument.getPermissions()\n      : Promise.resolve();\n\n    // Given that browsers don't handle huge amounts of DOM-elements very well,\n    // enforce usage of PAGE-scrolling when loading *very* long/large documents.\n    if (pagesCount > PagesCountLimit.FORCE_SCROLL_MODE_PAGE) {\n      console.warn(\n        \"Forcing PAGE-scrolling for performance reasons, given the length of the document.\"\n      );\n      const mode = (this._scrollMode = ScrollMode.PAGE);\n      this.eventBus.dispatch(\"scrollmodechanged\", { source: this, mode });\n    }\n\n    this._pagesCapability.promise.then(\n      () => {\n        this.eventBus.dispatch(\"pagesloaded\", { source: this, pagesCount });\n      },\n      () => {\n        /* Prevent \"Uncaught (in promise)\"-messages in the console. */\n      }\n    );\n\n    this._onBeforeDraw = evt => {\n      const pageView = this._pages[evt.pageNumber - 1];\n      if (!pageView) {\n        return;\n      }\n      // Add the page to the buffer at the start of drawing. That way it can be\n      // evicted from the buffer and destroyed even if we pause its rendering.\n      this.#buffer.push(pageView);\n    };\n    this.eventBus._on(\"pagerender\", this._onBeforeDraw);\n\n    this._onAfterDraw = evt => {\n      if (evt.cssTransform || this._onePageRenderedCapability.settled) {\n        return;\n      }\n      this._onePageRenderedCapability.resolve({ timestamp: evt.timestamp });\n\n      this.eventBus._off(\"pagerendered\", this._onAfterDraw);\n      this._onAfterDraw = null;\n\n      if (this.#onVisibilityChange) {\n        document.removeEventListener(\n          \"visibilitychange\",\n          this.#onVisibilityChange\n        );\n        this.#onVisibilityChange = null;\n      }\n    };\n    this.eventBus._on(\"pagerendered\", this._onAfterDraw);\n\n    // Fetch a single page so we can get a viewport that will be the default\n    // viewport for all pages\n    Promise.all([firstPagePromise, permissionsPromise])\n      .then(([firstPdfPage, permissions]) => {\n        if (pdfDocument !== this.pdfDocument) {\n          return; // The document was closed while the first page resolved.\n        }\n        this._firstPageCapability.resolve(firstPdfPage);\n        this._optionalContentConfigPromise = optionalContentConfigPromise;\n\n        const { annotationEditorMode, annotationMode, textLayerMode } =\n          this.#initializePermissions(permissions);\n\n        if (textLayerMode !== TextLayerMode.DISABLE) {\n          const element = (this.#hiddenCopyElement =\n            document.createElement(\"div\"));\n          element.id = \"hiddenCopyElement\";\n          this.viewer.before(element);\n        }\n\n        if (annotationEditorMode !== AnnotationEditorType.DISABLE) {\n          const mode = annotationEditorMode;\n\n          if (pdfDocument.isPureXfa) {\n            console.warn(\"Warning: XFA-editing is not implemented.\");\n          } else if (isValidAnnotationEditorMode(mode)) {\n            this.#annotationEditorUIManager = new AnnotationEditorUIManager(\n              this.container,\n              this.viewer,\n              this.#altTextManager,\n              this.eventBus,\n              pdfDocument,\n              this.pageColors\n            );\n            if (mode !== AnnotationEditorType.NONE) {\n              this.#annotationEditorUIManager.updateMode(mode);\n            }\n          } else {\n            console.error(`Invalid AnnotationEditor mode: ${mode}`);\n          }\n        }\n\n        const viewerElement =\n          this._scrollMode === ScrollMode.PAGE ? null : this.viewer;\n        const scale = this.currentScale;\n        const viewport = firstPdfPage.getViewport({\n          scale: scale * PixelsPerInch.PDF_TO_CSS_UNITS,\n        });\n        // Ensure that the various layers always get the correct initial size,\n        // see issue 15795.\n        this.viewer.style.setProperty(\"--scale-factor\", viewport.scale);\n        if (\n          this.pageColors?.foreground === \"CanvasText\" ||\n          this.pageColors?.background === \"Canvas\"\n        ) {\n          this.viewer.style.setProperty(\n            \"--hcm-highlight-filter\",\n            pdfDocument.filterFactory.addHighlightHCMFilter(\n              \"CanvasText\",\n              \"Canvas\",\n              \"HighlightText\",\n              \"Highlight\"\n            )\n          );\n        }\n\n        for (let pageNum = 1; pageNum <= pagesCount; ++pageNum) {\n          const pageView = new PDFPageView({\n            container: viewerElement,\n            eventBus: this.eventBus,\n            id: pageNum,\n            scale,\n            defaultViewport: viewport.clone(),\n            optionalContentConfigPromise,\n            renderingQueue: this.renderingQueue,\n            textLayerMode,\n            annotationMode,\n            imageResourcesPath: this.imageResourcesPath,\n            removePageBorders: this.removePageBorders, // #194\n            useOnlyCssZoom: this.useOnlyCssZoom,\n            isOffscreenCanvasSupported: this.isOffscreenCanvasSupported,\n            maxCanvasPixels: this.maxCanvasPixels,\n            pageColors: this.pageColors,\n            l10n: this.l10n,\n            layerProperties: this._layerProperties,\n          });\n          this._pages.push(pageView);\n        }\n        // Set the first `pdfPage` immediately, since it's already loaded,\n        // rather than having to repeat the `PDFDocumentProxy.getPage` call in\n        // the `this.#ensurePdfPageLoaded` method before rendering can start.\n        const firstPageView = this._pages[0];\n        if (firstPageView) {\n          firstPageView.setPdfPage(firstPdfPage);\n          this.linkService.cachePageRef(1, firstPdfPage.ref);\n        }\n\n        if (this._scrollMode === ScrollMode.PAGE) {\n          // Ensure that the current page becomes visible on document load.\n          this.#ensurePageViewVisible();\n        } else if (this._spreadMode !== SpreadMode.NONE) {\n          this._updateSpreadMode();\n        }\n\n        // Fetch all the pages since the viewport is needed before printing\n        // starts to create the correct size canvas. Wait until one page is\n        // rendered so we don't tie up too many resources early on.\n        this.#onePageRenderedOrForceFetch().then(async () => {\n          this.findController?.setDocument(pdfDocument); // Enable searching.\n          this._scriptingManager?.setDocument(pdfDocument); // Enable scripting.\n\n          if (this.#hiddenCopyElement) {\n            this.#copyCallbackBound = this.#copyCallback.bind(\n              this,\n              textLayerMode\n            );\n            document.addEventListener(\"copy\", this.#copyCallbackBound);\n          }\n\n          if (this.#annotationEditorUIManager) {\n            // Ensure that the Editor buttons, in the toolbar, are updated.\n            this.eventBus.dispatch(\"annotationeditormodechanged\", {\n              source: this,\n              mode: this.#annotationEditorMode,\n            });\n          }\n\n          // In addition to 'disableAutoFetch' being set, also attempt to reduce\n          // resource usage when loading *very* long/large documents.\n          if (\n            pdfDocument.loadingParams.disableAutoFetch ||\n            pagesCount > PagesCountLimit.FORCE_LAZY_PAGE_INIT\n          ) {\n            // XXX: Printing is semi-broken with auto fetch disabled.\n            this._pagesCapability.resolve();\n            return;\n          }\n          let getPagesLeft = pagesCount - 1; // The first page was already loaded.\n\n          if (getPagesLeft <= 0) {\n            this._pagesCapability.resolve();\n            return;\n          }\n          for (let pageNum = 2; pageNum <= pagesCount; ++pageNum) {\n            const promise = pdfDocument.getPage(pageNum).then(\n              pdfPage => {\n                const pageView = this._pages[pageNum - 1];\n                if (!pageView.pdfPage) {\n                  pageView.setPdfPage(pdfPage);\n                }\n                this.linkService.cachePageRef(pageNum, pdfPage.ref);\n                if (--getPagesLeft === 0) {\n                  this._pagesCapability.resolve();\n                }\n              },\n              reason => {\n                console.error(\n                  `Unable to get page ${pageNum} to initialize viewer`,\n                  reason\n                );\n                if (--getPagesLeft === 0) {\n                  this._pagesCapability.resolve();\n                }\n              }\n            );\n\n            if (pageNum % PagesCountLimit.PAUSE_EAGER_PAGE_INIT === 0) {\n              await promise;\n            }\n          }\n        });\n\n        /** #495 modified by ngx-extended-pdf-viewer */\n        this.hidePagesDependingOnpageViewMode();\n        /** end of modification */\n\n        this.eventBus.dispatch(\"pagesinit\", { source: this });\n\n        pdfDocument.getMetadata().then(({ info }) => {\n          if (pdfDocument !== this.pdfDocument) {\n            return; // The document was closed while the metadata resolved.\n          }\n          if (info.Language) {\n            this.viewer.lang = info.Language;\n          }\n        });\n\n        if (this.defaultRenderingQueue) {\n          this.update();\n        }\n      })\n      .catch(reason => {\n        globalThis.ngxConsole.error(\"Unable to initialize viewer\", reason);\n\n        this._pagesCapability.reject(reason);\n      });\n  }\n\n  /**\n   * @param {Array|null} labels\n   */\n  setPageLabels(labels) {\n    if (!this.pdfDocument) {\n      return;\n    }\n    if (!labels) {\n      this._pageLabels = null;\n    } else if (\n      !(Array.isArray(labels) && this.pdfDocument.numPages === labels.length)\n    ) {\n      this._pageLabels = null;\n      globalThis.ngxConsole.error(`setPageLabels: Invalid page labels.`);\n    } else {\n      this._pageLabels = labels;\n    }\n    // Update all the `PDFPageView` instances.\n    for (let i = 0, ii = this._pages.length; i < ii; i++) {\n      this._pages[i].setPageLabel(this._pageLabels?.[i] ?? null);\n    }\n  }\n\n  _resetView() {\n    this._pages = [];\n    this._currentPageNumber = 1;\n    this._currentScale = UNKNOWN_SCALE;\n    this._currentScaleValue = null;\n    this._pageLabels = null;\n    // #950 modified by ngx-extended-pdf-viewer\n    const bufferSize = Number(PDFViewerApplicationOptions.get(\"defaultCacheSize\")) || DEFAULT_CACHE_SIZE;\n    this.#buffer = new PDFPageViewBuffer(bufferSize);\n    // #950 end of modification by ngx-extended-pdf-viewer\n    this._location = null;\n    this._pagesRotation = 0;\n    this._optionalContentConfigPromise = null;\n    this._firstPageCapability = new PromiseCapability();\n    this._onePageRenderedCapability = new PromiseCapability();\n    this._pagesCapability = new PromiseCapability();\n    this._scrollMode = ScrollMode.VERTICAL;\n    this._previousScrollMode = ScrollMode.UNKNOWN;\n    this._spreadMode = SpreadMode.NONE;\n\n    this.#scrollModePageState = {\n      previousPageNumber: 1,\n      scrollDown: true,\n      pages: [],\n    };\n\n    if (this._onBeforeDraw) {\n      this.eventBus._off(\"pagerender\", this._onBeforeDraw);\n      this._onBeforeDraw = null;\n    }\n    if (this._onAfterDraw) {\n      this.eventBus._off(\"pagerendered\", this._onAfterDraw);\n      this._onAfterDraw = null;\n    }\n    if (this.#onVisibilityChange) {\n      document.removeEventListener(\n        \"visibilitychange\",\n        this.#onVisibilityChange\n      );\n      this.#onVisibilityChange = null;\n    }\n    // Remove the pages from the DOM...\n    this.viewer.textContent = \"\";\n    // ... and reset the Scroll mode CSS class(es) afterwards.\n    this._updateScrollMode();\n\n    this.viewer.removeAttribute(\"lang\");\n\n    if (this.#hiddenCopyElement) {\n      document.removeEventListener(\"copy\", this.#copyCallbackBound);\n      this.#copyCallbackBound = null;\n\n      this.#hiddenCopyElement.remove();\n      this.#hiddenCopyElement = null;\n    }\n  }\n\n  #ensurePageViewVisible() {\n    if (this._scrollMode !== ScrollMode.PAGE) {\n      throw new Error(\"#ensurePageViewVisible: Invalid scrollMode value.\");\n    }\n    const pageNumber = this._currentPageNumber,\n      state = this.#scrollModePageState,\n      viewer = this.viewer;\n\n    // Temporarily remove all the pages from the DOM...\n    viewer.textContent = \"\";\n    // ... and clear out the active ones.\n    state.pages.length = 0;\n\n    if (this._spreadMode === SpreadMode.NONE && !this.isInPresentationMode) {\n      // Finally, append the new page to the viewer.\n      const pageView = this._pages[pageNumber - 1];\n      viewer.append(pageView.div);\n\n      state.pages.push(pageView);\n    } else {\n      const pageIndexSet = new Set(),\n        parity = this._spreadMode - 1;\n\n      // Determine the pageIndices in the new spread.\n      if (parity === -1) {\n        // PresentationMode is active, with `SpreadMode.NONE` set.\n        pageIndexSet.add(pageNumber - 1);\n      } else if (pageNumber % 2 !== parity) {\n        // Left-hand side page.\n        pageIndexSet.add(pageNumber - 1);\n        pageIndexSet.add(pageNumber);\n      } else {\n        // Right-hand side page.\n        pageIndexSet.add(pageNumber - 2);\n        pageIndexSet.add(pageNumber - 1);\n      }\n\n      // Finally, append the new pages to the viewer and apply the spreadMode.\n      const spread = document.createElement(\"div\");\n      spread.className = \"spread\";\n\n      if (this.isInPresentationMode) {\n        const dummyPage = document.createElement(\"div\");\n        dummyPage.className = \"dummyPage\";\n        spread.append(dummyPage);\n      }\n\n      for (const i of pageIndexSet) {\n        const pageView = this._pages[i];\n        if (!pageView) {\n          continue;\n        }\n        spread.append(pageView.div);\n\n        state.pages.push(pageView);\n      }\n      viewer.append(spread);\n    }\n\n    state.scrollDown = pageNumber >= state.previousPageNumber;\n    state.previousPageNumber = pageNumber;\n  }\n\n  _scrollUpdate() {\n    if (this.pagesCount === 0) {\n      return;\n    }\n    this.update();\n  }\n\n  // #1301 modified by ngx-extended-pdf-viewer:\n  // add an API to allow to scroll within a page\n  scrollPagePosIntoView(pageNumber, pageSpot) {\n    const pageDiv = this._pages[pageNumber - 1].div;\n\n    if (pageSpot) {\n      const targetPageSpot = { ...pageSpot };\n      if (typeof targetPageSpot.top === \"string\") {\n        if (targetPageSpot.top.endsWith(\"%\")) {\n          const percent = Number(targetPageSpot.top.replace(\"%\", \"\"));\n          const viewerHeight = this.viewer.querySelector(\".page\")?.clientHeight;\n          let height = pageDiv.clientHeight ? pageDiv.clientHeight : viewerHeight;\n          const visibleWindowHeight = this.viewer.parentElement.clientHeight;\n          height = Math.max(0, height - visibleWindowHeight);\n          targetPageSpot.top = (percent * height) / 100;\n        }\n      }\n      if (typeof targetPageSpot.left === \"string\") {\n        if (targetPageSpot.left.endsWith(\"%\")) {\n          const percent = Number(targetPageSpot.left.replace(\"%\", \"\"));\n          const viewerWidth = this.viewer.querySelector(\".page\")?.clientWidth;\n          const width = pageDiv.clientWidth ? pageDiv.clientWidth : viewerWidth;\n          targetPageSpot.left = (percent * width) / 100;\n        }\n      }\n      this.#scrollIntoView({ div: pageDiv, id: pageNumber }, targetPageSpot);\n    } else {\n      this.#scrollIntoView({ pageDiv, pageNumber });\n    }\n  }\n  // #1301 end of modification by ngx-extended-pdf-viewer\n\n  #scrollIntoView(pageView, pageSpot = null) {\n    // modified by ngx-extended-pdf-viewer\n    // to fix a bug that's basically caused by the showcase demo\n    if (!pageView) {\n      return;\n    }\n    // end of modification by ngx-extended-pdf-viewer\n    const { div, id } = pageView;\n\n    // Ensure that `this._currentPageNumber` is correct, when `#scrollIntoView`\n    // is called directly (and not from `#resetCurrentPageView`).\n    if (this._currentPageNumber !== id) {\n      this._setCurrentPageNumber(id);\n    }\n    if (this._scrollMode === ScrollMode.PAGE) {\n      this.#ensurePageViewVisible();\n      // Ensure that rendering always occurs, to avoid showing a blank page,\n      // even if the current position doesn't change when the page is scrolled.\n      this.update();\n    }\n\n    if (!pageSpot && !this.isInPresentationMode) {\n      const left = div.offsetLeft + div.clientLeft,\n        right = left + div.clientWidth;\n      const { scrollLeft, clientWidth } = this.container;\n      if (\n        this._scrollMode === ScrollMode.HORIZONTAL ||\n        left < scrollLeft ||\n        right > scrollLeft + clientWidth\n      ) {\n        pageSpot = { left: 0, top: 0 };\n      }\n    }\n    scrollIntoView(div, pageSpot, false, this.pageViewMode === \"infinite-scroll\");\n\n    // Ensure that the correct *initial* document position is set, when any\n    // OpenParameters are used, for documents with non-default Scroll/Spread\n    // modes (fixes issue 15695). This is necessary since the scroll-handler\n    // invokes the `update`-method asynchronously, and `this._location` could\n    // thus be wrong when the initial zooming occurs in the default viewer.\n    if (!this._currentScaleValue && this._location) {\n      this._location = null;\n    }\n  }\n\n  /**\n   * Prevent unnecessary re-rendering of all pages when the scale changes\n   * only because of limited numerical precision.\n   */\n  #isSameScale(newScale) {\n    return (\n      newScale === this._currentScale ||\n      Math.abs(newScale - this._currentScale) < 1e-15\n    );\n  }\n\n  #setScaleUpdatePages(\n    newScale,\n    newValue,\n    { noScroll = false, preset = false, drawingDelay = -1 }\n  ) {\n    const previousScale = isNaN(Number(this.currentScale)) ? undefined : Number(this.currentScale);\n    const previousScaleValue = this.currentScaleValue;\n    this._currentScaleValue = newValue.toString();\n\n    if (this.#isSameScale(newScale)) {\n      if (preset) {\n        this.eventBus.dispatch(\"scalechanging\", {\n          source: this,\n          scale: newScale,\n          presetValue: newValue,\n          previousScale,\n          previousPresetValue: previousScaleValue,\n        });\n      }\n      return;\n    }\n\n    this.viewer.style.setProperty(\n      \"--scale-factor\",\n      newScale * PixelsPerInch.PDF_TO_CSS_UNITS\n    );\n\n    const postponeDrawing = drawingDelay >= 0 && drawingDelay < 1000;\n    this.refresh(true, {\n      scale: newScale,\n      drawingDelay: postponeDrawing ? drawingDelay : -1,\n    });\n\n    if (postponeDrawing) {\n      this.#scaleTimeoutId = setTimeout(() => {\n        this.#scaleTimeoutId = null;\n        this.refresh();\n      }, drawingDelay);\n    }\n\n    this._currentScale = newScale;\n\n    if (!noScroll) {\n      let page = this._currentPageNumber,\n        dest;\n      if (\n        this._location &&\n        !(this.isInPresentationMode || this.isChangingPresentationMode)\n      ) {\n        page = this._location.pageNumber;\n        dest = [\n          null,\n          { name: \"XYZ\" },\n          this._location.left,\n          this._location.top,\n          null,\n        ];\n      }\n      this.scrollPageIntoView({\n        pageNumber: page,\n        destArray: dest,\n        allowNegativeOffset: true,\n      });\n    }\n\n    this.eventBus.dispatch(\"scalechanging\", {\n      source: this,\n      scale: newScale,\n      presetValue: preset ? newValue : undefined,\n      previousScale,\n      previousPresetValue: previousScaleValue,\n    });\n\n    if (this.defaultRenderingQueue) {\n      this.update();\n    }\n  }\n\n  get #pageWidthScaleFactor() {\n    if (\n      this._spreadMode !== SpreadMode.NONE &&\n      this._scrollMode !== ScrollMode.HORIZONTAL\n    ) {\n      return 2;\n    }\n    return 1;\n  }\n\n  #setScale(value, options) {\n    // #90 modified by ngx-extended-pdf-viewer\n    if (!value) {\n      value = \"auto\";\n    }\n    // #90 end of modification\n    let scale = parseFloat(value);\n    // #1095 modified by ngx-extended-pdf-viewer: prevent duplicate rendering\n    if (this._currentScale === scale) {\n      return; // nothing to do\n    }\n    // #1095 end of modification\n\n    if (scale > 0) {\n      options.preset = false;\n      this.#setScaleUpdatePages(scale, value, options);\n    } else {\n      const currentPage = this._pages[this._currentPageNumber - 1];\n      if (!currentPage) {\n        return;\n      }\n      let hPadding = SCROLLBAR_PADDING,\n        vPadding = VERTICAL_PADDING;\n\n      if (this.isInPresentationMode) {\n        // Pages have a 2px (transparent) border in PresentationMode, see\n        // the `web/pdf_viewer.css` file.\n        hPadding = vPadding = 4; // 2 * 2px\n        if (this._spreadMode !== SpreadMode.NONE) {\n          // Account for two pages being visible in PresentationMode, thus\n          // \"doubling\" the total border width.\n          hPadding *= 2;\n        }\n      } else if (\n        (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"GENERIC\")) &&\n        this.removePageBorders\n      ) {\n        hPadding = vPadding = 0;\n      } else if (this._scrollMode === ScrollMode.HORIZONTAL) {\n        [hPadding, vPadding] = [vPadding, hPadding]; // Swap the padding values.\n      }\n      const pageWidthScale =\n        (((this.container.clientWidth - hPadding) / currentPage.width) *\n          currentPage.scale) /\n        this.#pageWidthScaleFactor;\n      const pageHeightScale =\n        ((this.container.clientHeight - vPadding) / currentPage.height) *\n        currentPage.scale;\n      switch (value) {\n        case \"page-actual\":\n          scale = 1;\n          break;\n        case \"page-width\":\n          scale = pageWidthScale;\n          break;\n        case \"page-height\":\n          scale = pageHeightScale;\n          break;\n        case \"page-fit\":\n          scale = Math.min(pageWidthScale, pageHeightScale);\n          break;\n        case \"auto\":\n          // For pages in landscape mode, fit the page height to the viewer\n          // *unless* the page would thus become too wide to fit horizontally.\n          const horizontalScale = isPortraitOrientation(currentPage)\n            ? pageWidthScale\n            : Math.min(pageHeightScale, pageWidthScale);\n          scale = Math.min(MAX_AUTO_SCALE, horizontalScale);\n          break;\n        default:\n          globalThis.ngxConsole.error(`#setScale: \"${value}\" is an unknown zoom value.`);\n          return;\n      }\n      options.preset = true;\n      this.#setScaleUpdatePages(scale, value, options);\n    }\n  }\n\n  /**\n   * Refreshes page view: scrolls to the current page and updates the scale.\n   */\n  #resetCurrentPageView() {\n    const pageView = this._pages[this._currentPageNumber - 1];\n\n    if (this.isInPresentationMode) {\n      // Fixes the case when PDF has different page sizes.\n      this.#setScale(this._currentScaleValue, { noScroll: true });\n    }\n    this.#scrollIntoView(pageView);\n  }\n\n  /**\n   * @param {string} label - The page label.\n   * @returns {number|null} The page number corresponding to the page label,\n   *   or `null` when no page labels exist and/or the input is invalid.\n   */\n  pageLabelToPageNumber(label) {\n    if (!this._pageLabels) {\n      return null;\n    }\n    const i = this._pageLabels.indexOf(label);\n    if (i < 0) {\n      return null;\n    }\n    return i + 1;\n  }\n\n  /**\n   * @typedef {Object} ScrollPageIntoViewParameters\n   * @property {number} pageNumber - The page number.\n   * @property {Array} [destArray] - The original PDF destination array, in the\n   *   format: <page-ref> </XYZ|/FitXXX> <args..>\n   * @property {boolean} [allowNegativeOffset] - Allow negative page offsets.\n   *   The default value is `false`.\n   * @property {boolean} [ignoreDestinationZoom] - Ignore the zoom argument in\n   *   the destination array. The default value is `false`.\n   */\n\n  /**\n   * Scrolls page into view.\n   * @param {ScrollPageIntoViewParameters} params\n   */\n  scrollPageIntoView({\n    pageNumber,\n    destArray = null,\n    allowNegativeOffset = false,\n    ignoreDestinationZoom = false,\n  }) {\n    if (!this.pdfDocument) {\n      return;\n    }\n    const pageView =\n      Number.isInteger(pageNumber) && this._pages[pageNumber - 1];\n    if (!pageView) {\n      console.error(\n        `scrollPageIntoView: \"${pageNumber}\" is not a valid pageNumber parameter.`\n      );\n      return;\n    }\n\n    if (this.isInPresentationMode || !destArray) {\n      this._setCurrentPageNumber(pageNumber, /* resetCurrentPageView = */ true);\n      return;\n    }\n    let x = 0,\n      y = 0;\n    let width = 0,\n      height = 0,\n      widthScale,\n      heightScale;\n    const changeOrientation = pageView.rotation % 180 !== 0;\n    const pageWidth =\n      (changeOrientation ? pageView.height : pageView.width) /\n      pageView.scale /\n      PixelsPerInch.PDF_TO_CSS_UNITS;\n    const pageHeight =\n      (changeOrientation ? pageView.width : pageView.height) /\n      pageView.scale /\n      PixelsPerInch.PDF_TO_CSS_UNITS;\n    let scale = 0;\n    switch (destArray[1].name) {\n      case \"XYZ\":\n        x = destArray[2];\n        y = destArray[3];\n        scale = destArray[4];\n        // If x and/or y coordinates are not supplied, default to\n        // _top_ left of the page (not the obvious bottom left,\n        // since aligning the bottom of the intended page with the\n        // top of the window is rarely helpful).\n        x = x !== null ? x : 0;\n        y = y !== null ? y : pageHeight;\n        break;\n      case \"Fit\":\n      case \"FitB\":\n        scale = \"page-fit\";\n        break;\n      case \"FitH\":\n      case \"FitBH\":\n        y = destArray[2];\n        scale = \"page-width\";\n        // According to the PDF spec, section 12.3.2.2, a `null` value in the\n        // parameter should maintain the position relative to the new page.\n        if (y === null && this._location) {\n          x = this._location.left;\n          y = this._location.top;\n        } else if (typeof y !== \"number\" || y < 0) {\n          // The \"top\" value isn't optional, according to the spec, however some\n          // bad PDF generators will pretend that it is (fixes bug 1663390).\n          y = pageHeight;\n        }\n        break;\n      case \"FitV\":\n      case \"FitBV\":\n        x = destArray[2];\n        width = pageWidth;\n        height = pageHeight;\n        scale = \"page-height\";\n        break;\n      case \"FitR\":\n        x = destArray[2];\n        y = destArray[3];\n        width = destArray[4] - x;\n        height = destArray[5] - y;\n        let hPadding = SCROLLBAR_PADDING,\n          vPadding = VERTICAL_PADDING;\n\n        if (\n          (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"GENERIC\")) &&\n          this.removePageBorders\n        ) {\n          hPadding = vPadding = 0;\n        }\n        widthScale =\n          (this.container.clientWidth - hPadding) /\n          width /\n          PixelsPerInch.PDF_TO_CSS_UNITS;\n        heightScale =\n          (this.container.clientHeight - vPadding) /\n          height /\n          PixelsPerInch.PDF_TO_CSS_UNITS;\n        scale = Math.min(Math.abs(widthScale), Math.abs(heightScale));\n        break;\n      default:\n        console.error(\n          `scrollPageIntoView: \"${destArray[1].name}\" is not a valid destination type.`\n        );\n        return;\n    }\n\n    if (!ignoreDestinationZoom) {\n      if (scale && scale !== this._currentScale) {\n        this.currentScaleValue = scale;\n      } else if (this._currentScale === UNKNOWN_SCALE) {\n        this.currentScaleValue = DEFAULT_SCALE_VALUE;\n      }\n    }\n\n    /** #495 modified by ngx-extended-pdf-viewer */\n    this.#ensurePdfPageLoaded(pageView).then(() => {\n      this.renderingQueue.renderView(pageView);\n      if (this.pageViewMode === \"single\") {\n        if (this.currentPageNumber !== pageNumber) {\n          this.currentPageNumber = pageNumber;\n        }\n      }\n    });\n    /** end of modification */\n\n    if (scale === \"page-fit\" && !destArray[4]) {\n      this.#scrollIntoView(pageView);\n      return;\n    }\n\n    const boundingRect = [\n      pageView.viewport.convertToViewportPoint(x, y),\n      pageView.viewport.convertToViewportPoint(x + width, y + height),\n    ];\n    let left = Math.min(boundingRect[0][0], boundingRect[1][0]);\n    let top = Math.min(boundingRect[0][1], boundingRect[1][1]);\n\n    if (!allowNegativeOffset) {\n      // Some bad PDF generators will create destinations with e.g. top values\n      // that exceeds the page height. Ensure that offsets are not negative,\n      // to prevent a previous page from becoming visible (fixes bug 874482).\n      left = Math.max(left, 0);\n      top = Math.max(top, 0);\n    }\n    this.#scrollIntoView(pageView, /* pageSpot = */ { left, top });\n  }\n\n  _updateLocation(firstPage) {\n    const currentScale = this._currentScale;\n    const currentScaleValue = this._currentScaleValue;\n    const normalizedScaleValue =\n      parseFloat(currentScaleValue) === currentScale\n        ? Math.round(currentScale * 10000) / 100\n        : currentScaleValue;\n\n    const pageNumber = firstPage.id;\n    const currentPageView = this._pages[pageNumber - 1];\n    const container = this.container;\n    const topLeft = currentPageView.getPagePoint(\n      container.scrollLeft - firstPage.x,\n      container.scrollTop - firstPage.y\n    );\n    const intLeft = Math.round(topLeft[0]);\n    const intTop = Math.round(topLeft[1]);\n\n    let pdfOpenParams = `#page=${pageNumber}`;\n    if (!this.isInPresentationMode) {\n      pdfOpenParams += `&zoom=${normalizedScaleValue},${intLeft},${intTop}`;\n    }\n\n    this._location = {\n      pageNumber,\n      scale: normalizedScaleValue,\n      top: intTop,\n      left: intLeft,\n      rotation: this._pagesRotation,\n      pdfOpenParams,\n    };\n  }\n\n  update() {\n    // #1201 modified by ngx-extended-pdf-viewer\n    if (this.scrollMode === ScrollMode.PAGE) {\n      this.viewer.classList.add(\"singlePageView\");\n    } else {\n      this.viewer.classList.remove(\"singlePageView\");\n    }\n    // #1201 end of modification by ngx-extended-pdf-viewer\n\n    const visible = this._getVisiblePages();\n    const visiblePages = visible.views,\n      numVisiblePages = visiblePages.length;\n\n    if (numVisiblePages === 0) {\n      return;\n    }\n    // #950 modified by ngx-extended-pdf-viewer\n    const bufferSize = Number(PDFViewerApplicationOptions.get(\"defaultCacheSize\")) || DEFAULT_CACHE_SIZE;\n    const newCacheSize = Math.max(bufferSize, 2 * numVisiblePages + 1);\n    // #950 end of modification\n    this.#buffer.resize(newCacheSize, visible.ids);\n\n    this.renderingQueue.renderHighestPriority(visible);\n\n    const isSimpleLayout =\n      this._spreadMode === SpreadMode.NONE &&\n      (this._scrollMode === ScrollMode.PAGE ||\n        this._scrollMode === ScrollMode.VERTICAL);\n    const currentId = this._currentPageNumber;\n    let stillFullyVisible = false;\n\n    for (const page of visiblePages) {\n      if (page.percent < 100) {\n        break;\n      }\n      if (page.id === currentId && isSimpleLayout) {\n        stillFullyVisible = true;\n        break;\n      }\n    }\n    // #1808 modified by ngx-extended-pdf-viewer\n    // stop the infinite loop in presentation mode with [(page)]\n    if (this.scrollMode !== ScrollMode.PAGE) {\n      this._setCurrentPageNumber(\n        stillFullyVisible ? currentId : visiblePages[0].id\n      );\n\n      this._updateLocation(visible.first);\n      this.eventBus.dispatch(\"updateviewarea\", {\n        source: this,\n        location: this._location,\n      });\n    }\n    // #1808 end of modification by ngx-extended-pdf-viewer\n    // #859 modified by ngx-extended-pdf-viewer\n    this.hidePagesDependingOnpageViewMode();\n    // #859 end of modification\n  }\n\n  containsElement(element) {\n    return this.container.contains(element);\n  }\n\n  focus() {\n    this.container.focus();\n  }\n\n  get _isContainerRtl() {\n    return getComputedStyle(this.container).direction === \"rtl\";\n  }\n\n  get isInPresentationMode() {\n    return this.presentationModeState === PresentationModeState.FULLSCREEN;\n  }\n\n  get isChangingPresentationMode() {\n    return this.presentationModeState === PresentationModeState.CHANGING;\n  }\n\n  get isHorizontalScrollbarEnabled() {\n    return this.isInPresentationMode\n      ? false\n      : this.container.scrollWidth > this.container.clientWidth;\n  }\n\n  get isVerticalScrollbarEnabled() {\n    return this.isInPresentationMode\n      ? false\n      : this.container.scrollHeight > this.container.clientHeight;\n  }\n\n  _getVisiblePages() {\n    const views =\n        this._scrollMode === ScrollMode.PAGE\n          ? this.#scrollModePageState.pages\n          : this._pages,\n      horizontal = this._scrollMode === ScrollMode.HORIZONTAL,\n      rtl = horizontal && this._isContainerRtl;\n\n    return getVisibleElements({\n      scrollEl: this.container,\n      views,\n      sortByVisibility: true,\n      horizontal,\n      rtl,\n    });\n  }\n\n  cleanup() {\n    for (const pageView of this._pages) {\n      if (pageView.renderingState !== RenderingStates.FINISHED) {\n        pageView.reset();\n      }\n    }\n  }\n\n  /**\n   * @private\n   */\n  _cancelRendering() {\n    for (const pageView of this._pages) {\n      pageView.cancelRendering();\n    }\n  }\n\n  /**\n   * @param {PDFPageView} pageView\n   * @returns {Promise<PDFPageProxy | null>}\n   */\n  async #ensurePdfPageLoaded(pageView) {\n    if (pageView.pdfPage) {\n      return pageView.pdfPage;\n    }\n    try {\n      const pdfPage = await this.pdfDocument.getPage(pageView.id);\n      if (!pageView.pdfPage) {\n        pageView.setPdfPage(pdfPage);\n      }\n      if (!this.linkService._cachedPageNumber?.(pdfPage.ref)) {\n        this.linkService.cachePageRef(pageView.id, pdfPage.ref);\n      }\n      return pdfPage;\n    } catch (reason) {\n      console.error(\"Unable to get page for page view\", reason);\n      return null; // Page error -- there is nothing that can be done.\n    }\n  }\n\n  #getScrollAhead(visible) {\n    if (visible.first?.id === 1) {\n      return true;\n    } else if (visible.last?.id === this.pagesCount) {\n      return false;\n    }\n    switch (this._scrollMode) {\n      case ScrollMode.PAGE:\n        return this.#scrollModePageState.scrollDown;\n      case ScrollMode.HORIZONTAL:\n        return this.scroll.right;\n    }\n    return this.scroll.down;\n  }\n\n  forceRendering(currentlyVisiblePages) {\n    const visiblePages = currentlyVisiblePages || this._getVisiblePages();\n    const scrollAhead = this.#getScrollAhead(visiblePages);\n    const preRenderExtra =\n      this._spreadMode !== SpreadMode.NONE &&\n      this._scrollMode !== ScrollMode.HORIZONTAL;\n\n    const pageView = this.renderingQueue.getHighestPriority(\n      visiblePages,\n      this._pages,\n      scrollAhead,\n      preRenderExtra\n    );\n\n    if (pageView) {\n      this.#ensurePdfPageLoaded(pageView).then(() => {\n        this.renderingQueue.renderView(pageView);\n      });\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * @type {boolean} Whether all pages of the PDF document have identical\n   *   widths and heights.\n   */\n  get hasEqualPageSizes() {\n    const firstPageView = this._pages[0];\n    for (let i = 1, ii = this._pages.length; i < ii; ++i) {\n      const pageView = this._pages[i];\n      if (\n        pageView.width !== firstPageView.width ||\n        pageView.height !== firstPageView.height\n      ) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  /**\n   * Returns sizes of the pages.\n   * @returns {Array} Array of objects with width/height/rotation fields.\n   */\n  getPagesOverview() {\n    let initialOrientation;\n    return this._pages.map(pageView => {\n      const viewport = pageView.pdfPage.getViewport({ scale: 1 });\n      const orientation = isPortraitOrientation(viewport);\n      if (initialOrientation === undefined) {\n        initialOrientation = orientation;\n      } else if (\n        this.enablePrintAutoRotate &&\n        orientation !== initialOrientation\n      ) {\n        // Rotate to fit the initial orientation.\n        return {\n          width: viewport.height,\n          height: viewport.width,\n          rotation: (viewport.rotation - 90) % 360,\n        };\n      }\n      return {\n        width: viewport.width,\n        height: viewport.height,\n        rotation: viewport.rotation,\n      };\n    });\n  }\n\n  /**\n   * @type {Promise<OptionalContentConfig | null>}\n   */\n  get optionalContentConfigPromise() {\n    if (!this.pdfDocument) {\n      return Promise.resolve(null);\n    }\n    if (!this._optionalContentConfigPromise) {\n      console.error(\"optionalContentConfigPromise: Not initialized yet.\");\n      // Prevent issues if the getter is accessed *before* the `onePageRendered`\n      // promise has resolved; won't (normally) happen in the default viewer.\n      return this.pdfDocument.getOptionalContentConfig();\n    }\n    return this._optionalContentConfigPromise;\n  }\n\n  /**\n   * @param {Promise<OptionalContentConfig>} promise - A promise that is\n   *   resolved with an {@link OptionalContentConfig} instance.\n   */\n  set optionalContentConfigPromise(promise) {\n    if (!(promise instanceof Promise)) {\n      throw new Error(`Invalid optionalContentConfigPromise: ${promise}`);\n    }\n    if (!this.pdfDocument) {\n      return;\n    }\n    if (!this._optionalContentConfigPromise) {\n      // Ignore the setter *before* the `onePageRendered` promise has resolved,\n      // since it'll be overwritten anyway; won't happen in the default viewer.\n      return;\n    }\n    this._optionalContentConfigPromise = promise;\n\n    this.refresh(false, { optionalContentConfigPromise: promise });\n\n    this.eventBus.dispatch(\"optionalcontentconfigchanged\", {\n      source: this,\n      promise,\n    });\n  }\n\n  /**\n   * @type {number} One of the values in {ScrollMode}.\n   */\n  get scrollMode() {\n    return this._scrollMode;\n  }\n\n  /**\n   * @param {number} mode - The direction in which the document pages should be\n   *   laid out within the scrolling container.\n   *   The constants from {ScrollMode} should be used.\n   */\n  set scrollMode(mode) {\n    if (\n      typeof PDFJSDev === \"undefined\"\n        ? window.isGECKOVIEW\n        : PDFJSDev.test(\"GECKOVIEW\")\n    ) {\n      // NOTE: Always ignore the pageLayout in GeckoView since there's\n      // no UI available to change Scroll/Spread modes for the user.\n      return;\n    }\n    if (this._scrollMode === mode) {\n      return; // The Scroll mode didn't change.\n    }\n    if (!isValidScrollMode(mode)) {\n      throw new Error(`Invalid scroll mode: ${mode}`);\n    }\n    if (this.pagesCount > PagesCountLimit.FORCE_SCROLL_MODE_PAGE) {\n      return; // Disabled for performance reasons.\n    }\n    this._previousScrollMode = this._scrollMode;\n\n    this._scrollMode = mode;\n    this.eventBus.dispatch(\"scrollmodechanged\", { source: this, mode });\n\n    this._updateScrollMode(/* pageNumber = */ this._currentPageNumber);\n  }\n\n  _updateScrollMode(pageNumber = null) {\n    const scrollMode = this._scrollMode,\n      viewer = this.viewer;\n\n    viewer.classList.toggle(\n      \"scrollHorizontal\",\n      scrollMode === ScrollMode.HORIZONTAL\n    );\n    viewer.classList.toggle(\"scrollWrapped\", scrollMode === ScrollMode.WRAPPED);\n\n    if (!this.pdfDocument || !pageNumber) {\n      return;\n    }\n\n    if (scrollMode === ScrollMode.PAGE) {\n      this.#ensurePageViewVisible();\n    } else if (this._previousScrollMode === ScrollMode.PAGE) {\n      // Ensure that the current spreadMode is still applied correctly when\n      // the *previous* scrollMode was `ScrollMode.PAGE`.\n      this._updateSpreadMode();\n    }\n    // Non-numeric scale values can be sensitive to the scroll orientation.\n    // Call this before re-scrolling to the current page, to ensure that any\n    // changes in scale don't move the current page.\n    if (this._currentScaleValue && isNaN(this._currentScaleValue)) {\n      this.#setScale(this._currentScaleValue, { noScroll: true });\n    }\n    this._setCurrentPageNumber(pageNumber, /* resetCurrentPageView = */ true);\n    this.update();\n  }\n\n  /**\n   * @type {number} One of the values in {SpreadMode}.\n   */\n  get spreadMode() {\n    return this._spreadMode;\n  }\n\n  /**\n   * @param {number} mode - Group the pages in spreads, starting with odd- or\n   *   even-number pages (unless `SpreadMode.NONE` is used).\n   *   The constants from {SpreadMode} should be used.\n   */\n  set spreadMode(mode) {\n    if (\n      typeof PDFJSDev === \"undefined\"\n        ? window.isGECKOVIEW\n        : PDFJSDev.test(\"GECKOVIEW\")\n    ) {\n      // NOTE: Always ignore the pageLayout in GeckoView since there's\n      // no UI available to change Scroll/Spread modes for the user.\n      return;\n    }\n    if (this._spreadMode === mode) {\n      return; // The Spread mode didn't change.\n    }\n    if (!isValidSpreadMode(mode)) {\n      throw new Error(`Invalid spread mode: ${mode}`);\n    }\n    this._spreadMode = mode;\n    this.eventBus.dispatch(\"spreadmodechanged\", { source: this, mode });\n\n    this._updateSpreadMode(/* pageNumber = */ this._currentPageNumber);\n  }\n\n  _updateSpreadMode(pageNumber = null) {\n    if (!this.pdfDocument) {\n      return;\n    }\n    const viewer = this.viewer,\n      pages = this._pages;\n\n    if (this._scrollMode === ScrollMode.PAGE) {\n      this.#ensurePageViewVisible();\n    } else {\n      // Temporarily remove all the pages from the DOM.\n      viewer.textContent = \"\";\n\n      if (this._spreadMode === SpreadMode.NONE) {\n        for (const pageView of this._pages) {\n          viewer.append(pageView.div);\n        }\n      } else {\n        const parity = this._spreadMode - 1;\n        let spread = null;\n        for (let i = 0, ii = pages.length; i < ii; ++i) {\n          if (spread === null) {\n            spread = document.createElement(\"div\");\n            spread.className = \"spread\";\n            viewer.append(spread);\n          } else if (i % 2 === parity) {\n            spread = spread.cloneNode(false);\n            viewer.append(spread);\n          }\n          spread.append(pages[i].div);\n        }\n      }\n    }\n\n    // #859 modified by ngx-extended-pdf-viewer\n    this.hidePagesDependingOnpageViewMode();\n    // end of modification by ngx-extended-pdf-viewer\n\n    if (!pageNumber) {\n      return;\n    }\n    // Non-numeric scale values can be sensitive to the scroll orientation.\n    // Call this before re-scrolling to the current page, to ensure that any\n    // changes in scale don't move the current page.\n    if (this._currentScaleValue && isNaN(this._currentScaleValue)) {\n      this.#setScale(this._currentScaleValue, { noScroll: true });\n    }\n    this._setCurrentPageNumber(pageNumber, /* resetCurrentPageView = */ true);\n    this.update();\n  }\n\n  /**\n   * @private\n   */\n  _getPageAdvance(currentPageNumber, previous = false) {\n    // #1695 modified by ngx-extended-pdf-viewer\n    if (this.pageViewMode === \"book\") {\n      return 2;\n    }\n    // end of modification by ngx-extended-pdf-viewer\n    switch (this._scrollMode) {\n      case ScrollMode.WRAPPED: {\n        const { views } = this._getVisiblePages(),\n          pageLayout = new Map();\n\n        // Determine the current (visible) page layout.\n        for (const { id, y, percent, widthPercent } of views) {\n          if (percent === 0 || widthPercent < 100) {\n            continue;\n          }\n          let yArray = pageLayout.get(y);\n          if (!yArray) {\n            pageLayout.set(y, (yArray ||= []));\n          }\n          yArray.push(id);\n        }\n        // Find the row of the current page.\n        for (const yArray of pageLayout.values()) {\n          const currentIndex = yArray.indexOf(currentPageNumber);\n          if (currentIndex === -1) {\n            continue;\n          }\n          const numPages = yArray.length;\n          if (numPages === 1) {\n            break;\n          }\n          // Handle documents with varying page sizes.\n          if (previous) {\n            for (let i = currentIndex - 1, ii = 0; i >= ii; i--) {\n              const currentId = yArray[i],\n                expectedId = yArray[i + 1] - 1;\n              if (currentId < expectedId) {\n                return currentPageNumber - expectedId;\n              }\n            }\n          } else {\n            for (let i = currentIndex + 1, ii = numPages; i < ii; i++) {\n              const currentId = yArray[i],\n                expectedId = yArray[i - 1] + 1;\n              if (currentId > expectedId) {\n                return expectedId - currentPageNumber;\n              }\n            }\n          }\n          // The current row is \"complete\", advance to the previous/next one.\n          if (previous) {\n            const firstId = yArray[0];\n            if (firstId < currentPageNumber) {\n              return currentPageNumber - firstId + 1;\n            }\n          } else {\n            const lastId = yArray[numPages - 1];\n            if (lastId > currentPageNumber) {\n              return lastId - currentPageNumber + 1;\n            }\n          }\n          break;\n        }\n        break;\n      }\n      case ScrollMode.HORIZONTAL: {\n        break;\n      }\n      case ScrollMode.PAGE:\n      case ScrollMode.VERTICAL: {\n        if (this._spreadMode === SpreadMode.NONE) {\n          break; // Normal vertical scrolling.\n        }\n        const parity = this._spreadMode - 1;\n\n        if (previous && currentPageNumber % 2 !== parity) {\n          break; // Left-hand side page.\n        } else if (!previous && currentPageNumber % 2 === parity) {\n          break; // Right-hand side page.\n        }\n        const { views } = this._getVisiblePages(),\n          expectedId = previous ? currentPageNumber - 1 : currentPageNumber + 1;\n\n        for (const { id, percent, widthPercent } of views) {\n          if (id !== expectedId) {\n            continue;\n          }\n          if (percent > 0 && widthPercent === 100) {\n            return 2;\n          }\n          break;\n        }\n        break;\n      }\n    }\n    return 1;\n  }\n\n  /**\n   * Go to the next page, taking scroll/spread-modes into account.\n   * @returns {boolean} Whether navigation occurred.\n   */\n  nextPage() {\n    const currentPageNumber = this._currentPageNumber,\n      pagesCount = this.pagesCount;\n\n    if (currentPageNumber >= pagesCount) {\n      return false;\n    }\n    const advance =\n      this._getPageAdvance(currentPageNumber, /* previous = */ false) || 1;\n\n    this.currentPageNumber = Math.min(currentPageNumber + advance, pagesCount);\n    return true;\n  }\n\n  /**\n   * Go to the previous page, taking scroll/spread-modes into account.\n   * @returns {boolean} Whether navigation occurred.\n   */\n  previousPage() {\n    const currentPageNumber = this._currentPageNumber;\n\n    if (currentPageNumber <= 1) {\n      return false;\n    }\n    const advance =\n      this._getPageAdvance(currentPageNumber, /* previous = */ true) || 1;\n\n    this.currentPageNumber = Math.max(currentPageNumber - advance, 1);\n    return true;\n  }\n\n  /**\n   * @typedef {Object} ChangeScaleOptions\n   * @property {number} [drawingDelay]\n   * @property {number} [scaleFactor]\n   * @property {number} [steps]\n   */\n\n  /**\n   * Increase the current zoom level one, or more, times.\n   * @param {ChangeScaleOptions} [options]\n   */\n  increaseScale({ drawingDelay, scaleFactor, steps } = {}) {\n    if (!this.pdfDocument) {\n      return;\n    }\n    let newScale = this._currentScale;\n    if (scaleFactor > 1) {\n      newScale = Math.round(newScale * scaleFactor * 100) / 100;\n    } else {\n      steps ??= 1;\n      do {\n        newScale =\n          Math.ceil((newScale * DEFAULT_SCALE_DELTA).toFixed(2) * 10) / 10;\n      } while (--steps > 0 && newScale < MAX_SCALE);\n    }\n    // modified by ngx-extended-pdf-viewer #367\n    let maxScale = Number(PDFViewerApplicationOptions.get(\"maxZoom\"));\n    if (!maxScale) {\n      maxScale = MAX_SCALE;\n    }\n    this.#setScale(Math.min(maxScale, newScale), {\n      noScroll: false,\n      drawingDelay,\n    });\n    // #367 end of modification by ngx-extended-pdf-viewer\n  }\n\n  /**\n   * Decrease the current zoom level one, or more, times.\n   * @param {ChangeScaleOptions} [options]\n   */\n  decreaseScale({ drawingDelay, scaleFactor, steps } = {}) {\n    if (!this.pdfDocument) {\n      return;\n    }\n    let newScale = this._currentScale;\n    if (scaleFactor > 0 && scaleFactor < 1) {\n      newScale = Math.round(newScale * scaleFactor * 100) / 100;\n    } else {\n      steps ??= 1;\n      do {\n        newScale =\n          Math.floor((newScale / DEFAULT_SCALE_DELTA).toFixed(2) * 10) / 10;\n      } while (--steps > 0 && newScale > MIN_SCALE);\n    }\n    // modified by ngx-extended-pdf-viewer #367\n    let minScale = Number(PDFViewerApplicationOptions.get(\"minZoom\"));\n    if (!minScale) {\n      minScale = MIN_SCALE;\n    }\n    this.#setScale(Math.max(minScale, newScale), {\n      noScroll: false,\n      drawingDelay,\n    });\n    // #367 end of modification by ngx-extended-pdf-viewer\n  }\n\n  #updateContainerHeightCss(height = this.container.clientHeight) {\n    if (height !== this.#previousContainerHeight) {\n      this.#previousContainerHeight = height;\n      docStyle.setProperty(\"--viewer-container-height\", `${height}px`);\n    }\n  }\n\n  #resizeObserverCallback(entries) {\n    for (const entry of entries) {\n      if (entry.target === this.container) {\n        this.#updateContainerHeightCss(\n          Math.floor(entry.borderBoxSize[0].blockSize)\n        );\n        this.#containerTopLeft = null;\n        break;\n      }\n    }\n  }\n\n  get containerTopLeft() {\n    return (this.#containerTopLeft ||= [\n      this.container.offsetTop,\n      this.container.offsetLeft,\n    ]);\n  }\n\n  get annotationEditorMode() {\n    return this.#annotationEditorUIManager\n      ? this.#annotationEditorMode\n      : AnnotationEditorType.DISABLE;\n  }\n\n  /**\n   * @typedef {Object} AnnotationEditorModeOptions\n   * @property {number} mode - The editor mode (none, FreeText, ink, ...).\n   * @property {string|null} [editId] - ID of the existing annotation to edit.\n   * @property {boolean} [isFromKeyboard] - True if the mode change is due to a\n   *   keyboard action.\n   */\n\n  /**\n   * @param {AnnotationEditorModeOptions} options\n   */\n  set annotationEditorMode({ mode, editId = null, isFromKeyboard = false }) {\n    if (!this.#annotationEditorUIManager) {\n      throw new Error(`The AnnotationEditor is not enabled.`);\n    }\n    if (this.#annotationEditorMode === mode) {\n      return; // The AnnotationEditor mode didn't change.\n    }\n    if (!isValidAnnotationEditorMode(mode)) {\n      throw new Error(`Invalid AnnotationEditor mode: ${mode}`);\n    }\n    if (!this.pdfDocument) {\n      return;\n    }\n    this.#annotationEditorMode = mode;\n    this.eventBus.dispatch(\"annotationeditormodechanged\", {\n      source: this,\n      mode,\n    });\n\n    this.#annotationEditorUIManager.updateMode(mode, editId, isFromKeyboard);\n  }\n\n  // eslint-disable-next-line accessor-pairs\n  set annotationEditorParams({ type, value }) {\n    if (!this.#annotationEditorUIManager) {\n      throw new Error(`The AnnotationEditor is not enabled.`);\n    }\n    this.#annotationEditorUIManager.updateParams(type, value);\n  }\n\n  refresh(noUpdate = false, updateArgs = Object.create(null)) {\n    if (!this.pdfDocument) {\n      return;\n    }\n    for (const pageView of this._pages) {\n      pageView.update(updateArgs);\n    }\n    if (this.#scaleTimeoutId !== null) {\n      clearTimeout(this.#scaleTimeoutId);\n      this.#scaleTimeoutId = null;\n    }\n    if (!noUpdate) {\n      this.update();\n    }\n  }\n\n  // #1783 modified by ngx-extended-pdf-viewer\n  getSerializedAnnotations() {\n    const rawAnnotations = this.pdfDocument.annotationStorage.getAll();\n    if (rawAnnotations) {\n      const annotations = Object.values(rawAnnotations);\n      return annotations.map(a => a.serialize());\n    }\n    return null;\n  }\n\n  addEditorAnnotation(data) {\n    if (!Array.isArray(data)) {\n      data = [data];\n    }\n\n    this.#annotationEditorUIManager.addSerializedEditor(data, true, true, false);\n  }\n\n  removeEditorAnnotations(filter = () => true) {\n    this.#annotationEditorUIManager.removeEditors(filter);\n  }\n  // #1783 end of modification by ngx-extended-pdf-viewer\n\n  // #1415 modified by ngx-extended-pdf-viewer\n  destroyBookMode() {\n    if (this.pageFlip) {\n      this.pageFlip.destroy();\n      this.pageFlip = null;\n    }\n  }\n\n  stopRendering() {\n    // this.renderingQueue._stop();\n    this._cancelRendering();\n  }\n  // #1415 end of modification by ngx-extended-pdf-viewer\n}\n\nexport { PagesCountLimit, PDFPageViewBuffer, PDFViewer };\n","/* Copyright 2016 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// Ensure that the viewer waits for the library to complete loading,\n// to avoid breaking e.g. the standalone viewer components (see issue 17228).\nif (\n  (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"GENERIC\")) &&\n  !globalThis.pdfjsLib\n) {\n  await globalThis.pdfjsLibPromise;\n}\n\nconst {\n  AbortException,\n  AnnotationEditorLayer,\n  AnnotationEditorParamsType,\n  AnnotationEditorType,\n  AnnotationEditorUIManager,\n  AnnotationLayer,\n  AnnotationMode,\n  build,\n  CMapCompressionType,\n  createValidAbsoluteUrl,\n  DOMSVGFactory,\n  DrawLayer,\n  FeatureTest,\n  fetchData,\n  getDocument,\n  getFilenameFromUrl,\n  getPdfFilenameFromUrl,\n  getXfaPageViewport,\n  GlobalWorkerOptions,\n  ImageKind,\n  InvalidPDFException,\n  isDataScheme,\n  isPdfFile,\n  MissingPDFException,\n  noContextMenu,\n  normalizeUnicode,\n  OPS,\n  Outliner,\n  PasswordResponses,\n  PDFDataRangeTransport,\n  PDFDateString,\n  PDFWorker,\n  PermissionFlag,\n  PixelsPerInch,\n  PromiseCapability,\n  RenderingCancelledException,\n  renderTextLayer,\n  setLayerDimensions,\n  shadow,\n  UnexpectedResponseException,\n  updateTextLayer,\n  Util,\n  VerbosityLevel,\n  version,\n  XfaLayer,\n} = globalThis.pdfjsLib;\n\nexport {\n  AbortException,\n  AnnotationEditorLayer,\n  AnnotationEditorParamsType,\n  AnnotationEditorType,\n  AnnotationEditorUIManager,\n  AnnotationLayer,\n  AnnotationMode,\n  build,\n  CMapCompressionType,\n  createValidAbsoluteUrl,\n  DOMSVGFactory,\n  DrawLayer,\n  FeatureTest,\n  fetchData,\n  getDocument,\n  getFilenameFromUrl,\n  getPdfFilenameFromUrl,\n  getXfaPageViewport,\n  GlobalWorkerOptions,\n  ImageKind,\n  InvalidPDFException,\n  isDataScheme,\n  isPdfFile,\n  MissingPDFException,\n  noContextMenu,\n  normalizeUnicode,\n  OPS,\n  Outliner,\n  PasswordResponses,\n  PDFDataRangeTransport,\n  PDFDateString,\n  PDFWorker,\n  PermissionFlag,\n  PixelsPerInch,\n  PromiseCapability,\n  RenderingCancelledException,\n  renderTextLayer,\n  setLayerDimensions,\n  shadow,\n  UnexpectedResponseException,\n  updateTextLayer,\n  Util,\n  VerbosityLevel,\n  version,\n  XfaLayer,\n};\n","/* Copyright 2021 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { removeNullCharacters } from \"./ui_utils.js\";\n\nconst PDF_ROLE_TO_HTML_ROLE = {\n  // Document level structure types\n  Document: null, // There's a \"document\" role, but it doesn't make sense here.\n  DocumentFragment: null,\n  // Grouping level structure types\n  Part: \"group\",\n  Sect: \"group\", // XXX: There's a \"section\" role, but it's abstract.\n  Div: \"group\",\n  Aside: \"note\",\n  NonStruct: \"none\",\n  // Block level structure types\n  P: null,\n  // H<n>,\n  H: \"heading\",\n  Title: null,\n  FENote: \"note\",\n  // Sub-block level structure type\n  Sub: \"group\",\n  // General inline level structure types\n  Lbl: null,\n  Span: null,\n  Em: null,\n  Strong: null,\n  Link: \"link\",\n  Annot: \"note\",\n  Form: \"form\",\n  // Ruby and Warichu structure types\n  Ruby: null,\n  RB: null,\n  RT: null,\n  RP: null,\n  Warichu: null,\n  WT: null,\n  WP: null,\n  // List standard structure types\n  L: \"list\",\n  LI: \"listitem\",\n  LBody: null,\n  // Table standard structure types\n  Table: \"table\",\n  TR: \"row\",\n  TH: \"columnheader\",\n  TD: \"cell\",\n  THead: \"columnheader\",\n  TBody: null,\n  TFoot: null,\n  // Standard structure type Caption\n  Caption: null,\n  // Standard structure type Figure\n  Figure: \"figure\",\n  // Standard structure type Formula\n  Formula: null,\n  // standard structure type Artifact\n  Artifact: null,\n};\n\nconst HEADING_PATTERN = /^H(\\d+)$/;\n\nclass StructTreeLayerBuilder {\n  #treeDom = undefined;\n\n  get renderingDone() {\n    return this.#treeDom !== undefined;\n  }\n\n  render(structTree) {\n    if (this.#treeDom !== undefined) {\n      return this.#treeDom;\n    }\n    const treeDom = this.#walk(structTree);\n    treeDom?.classList.add(\"structTree\");\n    return (this.#treeDom = treeDom);\n  }\n\n  hide() {\n    if (this.#treeDom && !this.#treeDom.hidden) {\n      this.#treeDom.hidden = true;\n    }\n  }\n\n  show() {\n    if (this.#treeDom?.hidden) {\n      this.#treeDom.hidden = false;\n    }\n  }\n\n  #setAttributes(structElement, htmlElement) {\n    const { alt, id, lang } = structElement;\n    if (alt !== undefined) {\n      htmlElement.setAttribute(\"aria-label\", removeNullCharacters(alt));\n    }\n    if (id !== undefined) {\n      htmlElement.setAttribute(\"aria-owns\", id);\n    }\n    if (lang !== undefined) {\n      htmlElement.setAttribute(\n        \"lang\",\n        removeNullCharacters(lang, /* replaceInvisible = */ true)\n      );\n    }\n  }\n\n  #walk(node) {\n    if (!node) {\n      return null;\n    }\n\n    const element = document.createElement(\"span\");\n    if (\"role\" in node) {\n      const { role } = node;\n      const match = role.match(HEADING_PATTERN);\n      if (match) {\n        element.setAttribute(\"role\", \"heading\");\n        element.setAttribute(\"aria-level\", match[1]);\n      } else if (PDF_ROLE_TO_HTML_ROLE[role]) {\n        element.setAttribute(\"role\", PDF_ROLE_TO_HTML_ROLE[role]);\n      }\n    }\n\n    this.#setAttributes(node, element);\n\n    if (node.children) {\n      if (node.children.length === 1 && \"id\" in node.children[0]) {\n        // Often there is only one content node so just set the values on the\n        // parent node to avoid creating an extra span.\n        this.#setAttributes(node.children[0], element);\n      } else {\n        for (const kid of node.children) {\n          element.append(this.#walk(kid));\n        }\n      }\n    }\n    return element;\n  }\n}\n\nexport { StructTreeLayerBuilder };\n","/* Copyright 2022 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { binarySearchFirstItem } from \"./ui_utils.js\";\n\n/**\n * This class aims to provide some methods:\n *  - to reorder elements in the DOM with respect to the visual order;\n *  - to create a link, using aria-owns, between spans in the textLayer and\n *    annotations in the annotationLayer. The goal is to help to know\n *    where the annotations are in the text flow.\n */\nclass TextAccessibilityManager {\n  #enabled = false;\n\n  #textChildren = null;\n\n  #textNodes = new Map();\n\n  #waitingElements = new Map();\n\n  setTextMapping(textDivs) {\n    this.#textChildren = textDivs;\n  }\n\n  /**\n   * Compare the positions of two elements, it must correspond to\n   * the visual ordering.\n   *\n   * @param {HTMLElement} e1\n   * @param {HTMLElement} e2\n   * @returns {number}\n   */\n  static #compareElementPositions(e1, e2) {\n    const rect1 = e1.getBoundingClientRect();\n    const rect2 = e2.getBoundingClientRect();\n\n    if (rect1.width === 0 && rect1.height === 0) {\n      return +1;\n    }\n\n    if (rect2.width === 0 && rect2.height === 0) {\n      return -1;\n    }\n\n    const top1 = rect1.y;\n    const bot1 = rect1.y + rect1.height;\n    const mid1 = rect1.y + rect1.height / 2;\n\n    const top2 = rect2.y;\n    const bot2 = rect2.y + rect2.height;\n    const mid2 = rect2.y + rect2.height / 2;\n\n    if (mid1 <= top2 && mid2 >= bot1) {\n      return -1;\n    }\n\n    if (mid2 <= top1 && mid1 >= bot2) {\n      return +1;\n    }\n\n    const centerX1 = rect1.x + rect1.width / 2;\n    const centerX2 = rect2.x + rect2.width / 2;\n\n    return centerX1 - centerX2;\n  }\n\n  /**\n   * Function called when the text layer has finished rendering.\n   */\n  enable() {\n    if (this.#enabled) {\n      throw new Error(\"TextAccessibilityManager is already enabled.\");\n    }\n    if (!this.#textChildren) {\n      throw new Error(\"Text divs and strings have not been set.\");\n    }\n\n    this.#enabled = true;\n    this.#textChildren = this.#textChildren.slice();\n    this.#textChildren.sort(TextAccessibilityManager.#compareElementPositions);\n\n    if (this.#textNodes.size > 0) {\n      // Some links have been made before this manager has been disabled, hence\n      // we restore them.\n      const textChildren = this.#textChildren;\n      for (const [id, nodeIndex] of this.#textNodes) {\n        const element = document.getElementById(id);\n        if (!element) {\n          // If the page was *fully* reset the element no longer exists, and it\n          // will be re-inserted later (i.e. when the annotationLayer renders).\n          this.#textNodes.delete(id);\n          continue;\n        }\n        this.#addIdToAriaOwns(id, textChildren[nodeIndex]);\n      }\n    }\n\n    for (const [element, isRemovable] of this.#waitingElements) {\n      this.addPointerInTextLayer(element, isRemovable);\n    }\n    this.#waitingElements.clear();\n  }\n\n  disable() {\n    if (!this.#enabled) {\n      return;\n    }\n\n    // Don't clear this.#textNodes which is used to rebuild the aria-owns\n    // in case it's re-enabled at some point.\n\n    this.#waitingElements.clear();\n    this.#textChildren = null;\n    this.#enabled = false;\n  }\n\n  /**\n   * Remove an aria-owns id from a node in the text layer.\n   * @param {HTMLElement} element\n   */\n  removePointerInTextLayer(element) {\n    if (!this.#enabled) {\n      this.#waitingElements.delete(element);\n      return;\n    }\n\n    const children = this.#textChildren;\n    if (!children || children.length === 0) {\n      return;\n    }\n\n    const { id } = element;\n    const nodeIndex = this.#textNodes.get(id);\n    if (nodeIndex === undefined) {\n      return;\n    }\n\n    const node = children[nodeIndex];\n\n    this.#textNodes.delete(id);\n    let owns = node.getAttribute(\"aria-owns\");\n    if (owns?.includes(id)) {\n      owns = owns\n        .split(\" \")\n        .filter(x => x !== id)\n        .join(\" \");\n      if (owns) {\n        node.setAttribute(\"aria-owns\", owns);\n      } else {\n        node.removeAttribute(\"aria-owns\");\n        node.setAttribute(\"role\", \"presentation\");\n      }\n    }\n  }\n\n  #addIdToAriaOwns(id, node) {\n    const owns = node.getAttribute(\"aria-owns\");\n    if (!owns?.includes(id)) {\n      node.setAttribute(\"aria-owns\", owns ? `${owns} ${id}` : id);\n    }\n    node.removeAttribute(\"role\");\n  }\n\n  /**\n   * Find the text node which is the nearest and add an aria-owns attribute\n   * in order to correctly position this editor in the text flow.\n   * @param {HTMLElement} element\n   * @param {boolean} isRemovable\n   * @returns {string|null} The id in the struct tree if any.\n   */\n  addPointerInTextLayer(element, isRemovable) {\n    const { id } = element;\n    if (!id) {\n      return null;\n    }\n\n    if (!this.#enabled) {\n      // The text layer needs to be there, so we postpone the association.\n      this.#waitingElements.set(element, isRemovable);\n      return null;\n    }\n\n    if (isRemovable) {\n      this.removePointerInTextLayer(element);\n    }\n\n    const children = this.#textChildren;\n    if (!children || children.length === 0) {\n      return null;\n    }\n\n    const index = binarySearchFirstItem(\n      children,\n      node =>\n        TextAccessibilityManager.#compareElementPositions(element, node) < 0\n    );\n\n    const nodeIndex = Math.max(0, index - 1);\n    const child = children[nodeIndex];\n    this.#addIdToAriaOwns(id, child);\n    this.#textNodes.set(id, nodeIndex);\n\n    const parent = child.parentNode;\n    return parent?.classList.contains(\"markedContent\") ? parent.id : null;\n  }\n\n  /**\n   * Move a div in the DOM in order to respect the visual order.\n   * @param {HTMLDivElement} element\n   * @returns {string|null} The id in the struct tree if any.\n   */\n  moveElementInDOM(container, element, contentElement, isRemovable) {\n    const id = this.addPointerInTextLayer(contentElement, isRemovable);\n\n    if (!container.hasChildNodes()) {\n      container.append(element);\n      return id;\n    }\n\n    const children = Array.from(container.childNodes).filter(\n      node => node !== element\n    );\n\n    if (children.length === 0) {\n      return id;\n    }\n\n    const elementToCompare = contentElement || element;\n    const index = binarySearchFirstItem(\n      children,\n      node =>\n        TextAccessibilityManager.#compareElementPositions(\n          elementToCompare,\n          node\n        ) < 0\n    );\n\n    if (index === 0) {\n      children[0].before(element);\n    } else {\n      children[index - 1].after(element);\n    }\n\n    return id;\n  }\n}\n\nexport { TextAccessibilityManager };\n","/* Copyright 2021 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** @typedef {import(\"./event_utils\").EventBus} EventBus */\n// eslint-disable-next-line max-len\n/** @typedef {import(\"./pdf_find_controller\").PDFFindController} PDFFindController */\n\n/**\n * @typedef {Object} TextHighlighterOptions\n * @property {PDFFindController} findController\n * @property {EventBus} eventBus - The application event bus.\n * @property {number} pageIndex - The page index.\n */\n\n/**\n * TextHighlighter handles highlighting matches from the FindController in\n * either the text layer or XFA layer depending on the type of document.\n */\nclass TextHighlighter {\n  /**\n   * @param {TextHighlighterOptions} options\n   */\n  constructor({ findController, eventBus, pageIndex }) {\n    this.findController = findController;\n    this.matches = [];\n    this.eventBus = eventBus;\n    this.pageIdx = pageIndex;\n    this._onUpdateTextLayerMatches = null;\n    this.textDivs = null;\n    this.textContentItemsStr = null;\n    this.enabled = false;\n  }\n\n  /**\n   * Store two arrays that will map DOM nodes to text they should contain.\n   * The arrays should be of equal length and the array element at each index\n   * should correspond to the other. e.g.\n   * `items[0] = \"<span>Item 0</span>\" and texts[0] = \"Item 0\";\n   *\n   * @param {Array<Node>} divs\n   * @param {Array<string>} texts\n   */\n  setTextMapping(divs, texts) {\n    this.textDivs = divs;\n    this.textContentItemsStr = texts;\n  }\n\n  /**\n   * Start listening for events to update the highlighter and check if there are\n   * any current matches that need be highlighted.\n   */\n  enable() {\n    if (!this.textDivs || !this.textContentItemsStr) {\n      throw new Error(\"Text divs and strings have not been set.\");\n    }\n    if (this.enabled) {\n      // #1501 modified by ngx-extended-pdf-viewer\n      // silently swallow the error message because calling this method doesn't\n      // seem to cause error, and sometime it does happen in the wild\n      return;\n      // throw new Error(\"TextHighlighter is already enabled.\");\n      // #1501 end of modification by ngx-extended-pdf-viewer\n    }\n    this.enabled = true;\n    if (!this._onUpdateTextLayerMatches) {\n      this._onUpdateTextLayerMatches = evt => {\n        if (evt.pageIndex === this.pageIdx || evt.pageIndex === -1) {\n          this._updateMatches();\n        }\n      };\n      this.eventBus._on(\n        \"updatetextlayermatches\",\n        this._onUpdateTextLayerMatches\n      );\n    }\n    this._updateMatches();\n  }\n\n  disable() {\n    if (!this.enabled) {\n      return;\n    }\n    this.enabled = false;\n    if (this._onUpdateTextLayerMatches) {\n      this.eventBus._off(\n        \"updatetextlayermatches\",\n        this._onUpdateTextLayerMatches\n      );\n      this._onUpdateTextLayerMatches = null;\n    }\n    this._updateMatches(/* reset = */ true);\n  }\n\n  _convertMatches(\n    matches,\n    matchesLength\n  ) {\n    // Early exit if there is nothing to convert.\n    if (!matches) {\n      return [];\n    }\n    const { textContentItemsStr } = this;\n\n    let i = 0,\n      iIndex = 0;\n    const end = textContentItemsStr.length - 1;\n    const result = [];\n\n    for (let m = 0, mm = matches.length; m < mm; m++) {\n      // Calculate the start position.\n      let matchIdx = matches[m];\n\n      // Loop over the divIdxs.\n      while (i !== end && matchIdx >= iIndex + textContentItemsStr[i].length) {\n        iIndex += textContentItemsStr[i].length;\n        i++;\n      }\n\n      if (i === textContentItemsStr.length) {\n        globalThis.ngxConsole.error(\"Could not find a matching mapping\");\n      }\n\n      const match = {\n        begin: {\n          divIdx: i,\n          offset: matchIdx - iIndex,\n        },\n      };\n\n      // Calculate the end position.\n      matchIdx += matchesLength[m];\n\n      // Somewhat the same array as above, but use > instead of >= to get\n      // the end position right.\n      while (i !== end && matchIdx > iIndex + textContentItemsStr[i].length) {\n        iIndex += textContentItemsStr[i].length;\n        i++;\n      }\n\n      match.end = {\n        divIdx: i,\n        offset: matchIdx - iIndex,\n      };\n      result.push(match);\n    }\n    return result;\n  }\n\n  _renderMatches(matches) {\n    // Early exit if there is nothing to render.\n    if (matches.length === 0) {\n      return;\n    }\n    const { findController, pageIdx } = this;\n    const { textContentItemsStr, textDivs } = this;\n\n    const isSelectedPage = pageIdx === findController.selected.pageIdx;\n    const selectedMatchIdx = findController.selected.matchIdx;\n    const highlightAll = findController.state.highlightAll;\n    let prevEnd = null;\n    const infinity = {\n      divIdx: -1,\n      offset: undefined,\n    };\n\n    function beginText(begin, className) {\n      const divIdx = begin.divIdx;\n      textDivs[divIdx].textContent = \"\";\n      return appendTextToDiv(divIdx, 0, begin.offset, className);\n    }\n\n    function appendTextToDiv(divIdx, fromOffset, toOffset, className) {\n      let div = textDivs[divIdx];\n      if (div.nodeType === Node.TEXT_NODE) {\n        const span = document.createElement(\"span\");\n        div.before(span);\n        span.append(div);\n        textDivs[divIdx] = span;\n        div = span;\n      }\n      const content = textContentItemsStr[divIdx].substring(\n        fromOffset,\n        toOffset\n      );\n      const node = document.createTextNode(content);\n      if (className) {\n        const span = document.createElement(\"span\");\n        span.className = `${className} appended`;\n        span.append(node);\n        div.append(span);\n        return className.includes(\"selected\") ? span.offsetLeft : 0;\n      }\n      div.append(node);\n      return 0;\n    }\n\n    let i0 = selectedMatchIdx,\n      i1 = i0 + 1;\n    if (highlightAll) {\n      i0 = 0;\n      i1 = matches.length;\n    } else if (!isSelectedPage) {\n      // Not highlighting all and this isn't the selected page, so do nothing.\n      return;\n    }\n\n    let lastDivIdx = -1;\n    let lastOffset = -1;\n    for (let i = i0; i < i1; i++) {\n      const match = matches[i];\n      const begin = match.begin;\n      if (begin.divIdx === lastDivIdx && begin.offset === lastOffset) {\n        // It's possible to be in this situation if we searched for a 'f' and we\n        // have a ligature 'ff' in the text. The 'ff' has to be highlighted two\n        // times.\n        continue;\n      }\n      lastDivIdx = begin.divIdx;\n      lastOffset = begin.offset;\n\n      const end = match.end;\n      const isSelected = isSelectedPage && i === selectedMatchIdx;\n      const highlightSuffix = isSelected ? \" selected\" : \"\";\n      let selectedLeft = 0;\n\n      // Match inside new div.\n      if (!prevEnd || begin.divIdx !== prevEnd.divIdx) {\n        // If there was a previous div, then add the text at the end.\n        if (prevEnd !== null) {\n          appendTextToDiv(prevEnd.divIdx, prevEnd.offset, infinity.offset);\n        }\n        // Clear the divs and set the content until the starting point.\n        beginText(begin);\n      } else {\n        appendTextToDiv(prevEnd.divIdx, prevEnd.offset, begin.offset);\n      }\n\n      if (begin.divIdx === end.divIdx) {\n        selectedLeft = appendTextToDiv(\n          begin.divIdx,\n          begin.offset,\n          end.offset,\n          \"highlight\" + highlightSuffix\n        );\n      } else {\n        selectedLeft = appendTextToDiv(\n          begin.divIdx,\n          begin.offset,\n          infinity.offset,\n          \"highlight begin\" + highlightSuffix\n        );\n        for (let n0 = begin.divIdx + 1, n1 = end.divIdx; n0 < n1; n0++) {\n          textDivs[n0].className = \"highlight middle\" + highlightSuffix;\n        }\n        beginText(end, \"highlight end\" + highlightSuffix);\n      }\n      prevEnd = end;\n\n      if (isSelected) {\n        // Attempt to scroll the selected match into view.\n        findController.scrollMatchIntoView({\n          element: textDivs[begin.divIdx],\n          selectedLeft,\n          pageIndex: pageIdx,\n          matchIndex: selectedMatchIdx,\n        });\n      }\n    }\n\n    if (prevEnd) {\n      appendTextToDiv(prevEnd.divIdx, prevEnd.offset, infinity.offset);\n    }\n  }\n\n  _updateMatches(reset = false) {\n    if (!this.enabled && !reset) {\n      return;\n    }\n    const { findController, matches, pageIdx } = this;\n    const { textContentItemsStr, textDivs } = this;\n    let clearedUntilDivIdx = -1;\n\n    // Clear all current matches.\n    for (const match of matches) {\n      const begin = Math.max(clearedUntilDivIdx, match.begin.divIdx);\n      for (let n = begin, end = match.end.divIdx; n <= end; n++) {\n        const div = textDivs[n];\n        div.textContent = textContentItemsStr[n];\n        div.className = \"\";\n      }\n      clearedUntilDivIdx = match.end.divIdx + 1;\n    }\n\n    if (!findController?.highlightMatches || reset) {\n      return;\n    }\n    // Convert the matches on the `findController` into the match format\n    // used for the textLayer.\n    const pageMatches = findController.pageMatches[pageIdx] || null;\n    const pageMatchesLength = findController.pageMatchesLength[pageIdx] || null;\n\n    this.matches = this._convertMatches(pageMatches, pageMatchesLength);\n    this._renderMatches(this.matches);\n  }\n}\n\nexport { TextHighlighter };\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// eslint-disable-next-line max-len\n/** @typedef {import(\"../src/display/display_utils\").PageViewport} PageViewport */\n/** @typedef {import(\"../src/display/api\").TextContent} TextContent */\n/** @typedef {import(\"./text_highlighter\").TextHighlighter} TextHighlighter */\n// eslint-disable-next-line max-len\n/** @typedef {import(\"./text_accessibility.js\").TextAccessibilityManager} TextAccessibilityManager */\n\nimport { normalizeUnicode, renderTextLayer, updateTextLayer } from \"pdfjs-lib\";\nimport { removeNullCharacters } from \"./ui_utils.js\";\n\n/**\n * @typedef {Object} TextLayerBuilderOptions\n * @property {TextHighlighter} highlighter - Optional object that will handle\n *   highlighting text from the find controller.\n * @property {TextAccessibilityManager} [accessibilityManager]\n * @property {boolean} [isOffscreenCanvasSupported] - Allows to use an\n *   OffscreenCanvas if needed.\n */\n\n/**\n * The text layer builder provides text selection functionality for the PDF.\n * It does this by creating overlay divs over the PDF's text. These divs\n * contain text that matches the PDF text they are overlaying.\n */\nclass TextLayerBuilder {\n  #enablePermissions = false;\n\n  #rotation = 0;\n\n  #scale = 0;\n\n  #textContentSource = null;\n\n  constructor({\n    highlighter = null,\n    accessibilityManager = null,\n    isOffscreenCanvasSupported = true,\n    enablePermissions = false,\n  }) {\n    this.textContentItemsStr = [];\n    this.renderingDone = false;\n    this.textDivs = [];\n    this.textDivProperties = new WeakMap();\n    this.textLayerRenderTask = null;\n    this.highlighter = highlighter;\n    this.accessibilityManager = accessibilityManager;\n    this.isOffscreenCanvasSupported = isOffscreenCanvasSupported;\n    this.#enablePermissions = enablePermissions === true;\n\n    /**\n     * Callback used to attach the textLayer to the DOM.\n     * @type {function}\n     */\n    this.onAppend = null;\n\n    this.div = document.createElement(\"div\");\n    this.div.className = \"textLayer\";\n  }\n\n  #finishRendering() {\n    this.renderingDone = true;\n\n    const endOfContent = document.createElement(\"div\");\n    endOfContent.className = \"endOfContent\";\n    this.div.append(endOfContent);\n\n    this.#bindMouse();\n  }\n\n  get numTextDivs() {\n    return this.textDivs.length;\n  }\n\n  /**\n   * Renders the text layer.\n   * @param {PageViewport} viewport\n   */\n  async render(viewport) {\n    if (!this.#textContentSource) {\n      throw new Error('No \"textContentSource\" parameter specified.');\n    }\n\n    const scale = viewport.scale * (globalThis.devicePixelRatio || 1);\n    const { rotation } = viewport;\n    if (this.renderingDone) {\n      const mustRotate = rotation !== this.#rotation;\n      const mustRescale = scale !== this.#scale;\n      if (mustRotate || mustRescale) {\n        this.hide();\n        updateTextLayer({\n          container: this.div,\n          viewport,\n          textDivs: this.textDivs,\n          textDivProperties: this.textDivProperties,\n          isOffscreenCanvasSupported: this.isOffscreenCanvasSupported,\n          mustRescale,\n          mustRotate,\n        });\n        this.#scale = scale;\n        this.#rotation = rotation;\n      }\n      this.show();\n      return;\n    }\n\n    this.cancel();\n    this.highlighter?.setTextMapping(this.textDivs, this.textContentItemsStr);\n    this.accessibilityManager?.setTextMapping(this.textDivs);\n\n    this.textLayerRenderTask = renderTextLayer({\n      textContentSource: this.#textContentSource,\n      container: this.div,\n      viewport,\n      textDivs: this.textDivs,\n      textDivProperties: this.textDivProperties,\n      textContentItemsStr: this.textContentItemsStr,\n      isOffscreenCanvasSupported: this.isOffscreenCanvasSupported,\n    });\n\n    await this.textLayerRenderTask.promise;\n    this.#finishRendering();\n    this.#scale = scale;\n    this.#rotation = rotation;\n    // Ensure that the textLayer is appended to the DOM *before* handling\n    // e.g. a pending search operation.\n    this.onAppend(this.div);\n    this.highlighter?.enable();\n    this.accessibilityManager?.enable();\n  }\n\n  hide() {\n    if (!this.div.hidden && this.renderingDone) {\n      // We turn off the highlighter in order to avoid to scroll into view an\n      // element of the text layer which could be hidden.\n      this.highlighter?.disable();\n      this.div.hidden = true;\n    }\n  }\n\n  show() {\n    if (this.div.hidden && this.renderingDone) {\n      this.div.hidden = false;\n      this.highlighter?.enable();\n    }\n  }\n\n  /**\n   * Cancel rendering of the text layer.\n   */\n  cancel() {\n    if (this.textLayerRenderTask) {\n      this.textLayerRenderTask.cancel();\n      this.textLayerRenderTask = null;\n    }\n    this.highlighter?.disable();\n    this.accessibilityManager?.disable();\n    this.textContentItemsStr.length = 0;\n    this.textDivs.length = 0;\n    this.textDivProperties = new WeakMap();\n  }\n\n  /**\n   * @param {ReadableStream | TextContent} source\n   */\n  setTextContentSource(source) {\n    this.cancel();\n    this.#textContentSource = source;\n  }\n\n  /**\n   * Improves text selection by adding an additional div where the mouse was\n   * clicked. This reduces flickering of the content if the mouse is slowly\n   * dragged up or down.\n   */\n  #bindMouse() {\n    const { div } = this;\n\n    div.addEventListener(\"mousedown\", evt => {\n      const end = div.querySelector(\".endOfContent\");\n      if (!end) {\n        return;\n      }\n      if (typeof PDFJSDev === \"undefined\" || !PDFJSDev.test(\"MOZCENTRAL\")) {\n        // On non-Firefox browsers, the selection will feel better if the height\n        // of the `endOfContent` div is adjusted to start at mouse click\n        // location. This avoids flickering when the selection moves up.\n        // However it does not work when selection is started on empty space.\n        let adjustTop = evt.target !== div;\n        if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"GENERIC\")) {\n          adjustTop &&=\n            getComputedStyle(end).getPropertyValue(\"-moz-user-select\") !==\n            \"none\";\n        }\n        if (adjustTop) {\n          const divBounds = div.getBoundingClientRect();\n          const r = Math.max(0, (evt.pageY - divBounds.top) / divBounds.height);\n          end.style.top = (r * 100).toFixed(2) + \"%\";\n        }\n      }\n      end.classList.add(\"active\");\n    });\n\n    div.addEventListener(\"mouseup\", () => {\n      const end = div.querySelector(\".endOfContent\");\n      if (!end) {\n        return;\n      }\n      if (typeof PDFJSDev === \"undefined\" || !PDFJSDev.test(\"MOZCENTRAL\")) {\n        end.style.top = \"\";\n      }\n      end.classList.remove(\"active\");\n    });\n\n    div.addEventListener(\"copy\", event => {\n      if (!this.#enablePermissions) {\n        const selection = document.getSelection();\n        event.clipboardData.setData(\n          \"text/plain\",\n          removeNullCharacters(normalizeUnicode(selection.toString()))\n        );\n      }\n      event.preventDefault();\n      event.stopPropagation();\n    });\n  }\n}\n\nexport { TextLayerBuilder };\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst DEFAULT_SCALE_VALUE = \"auto\";\nconst DEFAULT_SCALE = 1.0;\nconst DEFAULT_SCALE_DELTA = 1.1;\nconst MIN_SCALE = 0.1;\nconst MAX_SCALE = 10.0;\nconst UNKNOWN_SCALE = 0;\nconst MAX_AUTO_SCALE = 1.25;\nconst SCROLLBAR_PADDING = 40;\nconst VERTICAL_PADDING = 5;\n\nconst RenderingStates = {\n  INITIAL: 0,\n  RUNNING: 1,\n  PAUSED: 2,\n  FINISHED: 3,\n};\n\nconst PresentationModeState = {\n  UNKNOWN: 0,\n  NORMAL: 1,\n  CHANGING: 2,\n  FULLSCREEN: 3,\n};\n\nconst SidebarView = {\n  UNKNOWN: -1,\n  NONE: 0,\n  THUMBS: 1, // Default value.\n  OUTLINE: 2,\n  ATTACHMENTS: 3,\n  LAYERS: 4,\n};\n\nconst TextLayerMode = {\n  DISABLE: 0,\n  ENABLE: 1,\n  ENABLE_PERMISSIONS: 2,\n};\n\nconst ScrollMode = {\n  UNKNOWN: -1,\n  VERTICAL: 0, // Default value.\n  HORIZONTAL: 1,\n  WRAPPED: 2,\n  PAGE: 3,\n};\n\nconst SpreadMode = {\n  UNKNOWN: -1,\n  NONE: 0, // Default value.\n  ODD: 1,\n  EVEN: 2,\n};\n\nconst CursorTool = {\n  SELECT: 0, // The default value.\n  HAND: 1,\n  ZOOM: 2,\n};\n\n// Used by `PDFViewerApplication`, and by the API unit-tests.\nconst AutoPrintRegExp = /\\bprint\\s*\\(/;\n\n/**\n * Scale factors for the canvas, necessary with HiDPI displays.\n */\nclass OutputScale {\n  constructor() {\n    const pixelRatio = window.devicePixelRatio || 1;\n\n    /**\n     * @type {number} Horizontal scale.\n     */\n    this.sx = pixelRatio;\n\n    /**\n     * @type {number} Vertical scale.\n     */\n    this.sy = pixelRatio;\n  }\n\n  /**\n   * @type {boolean} Returns `true` when scaling is required, `false` otherwise.\n   */\n  get scaled() {\n    return this.sx !== 1 || this.sy !== 1;\n  }\n}\n\n/**\n * Scrolls specified element into view of its parent.\n * @param {HTMLElement} element - The element to be visible.\n * @param {Object} [spot] - An object with optional top and left properties,\n *   specifying the offset from the top left edge.\n * @param {number} [spot.left]\n * @param {number} [spot.top]\n * @param {boolean} [scrollMatches] - When scrolling search results into view,\n *   ignore elements that either: Contains marked content identifiers,\n *   or have the CSS-rule `overflow: hidden;` set. The default value is `false`.\n */\n// #492 modified by ngx-extended-pdf-viewer\nfunction scrollIntoView(element, spot, scrollMatches = false, infiniteScroll=false) {\n// #492 end of modification\n  // Assuming offsetParent is available (it's not available when viewer is in\n  // hidden iframe or object). We have to scroll: if the offsetParent is not set\n  // producing the error. See also animationStarted.\n\n  // #716 modified by ngx-extended-pdf-viewer\n  if (\n    element.classList.contains(\"stf__item\") ||\n    element.parentElement?.classList.contains(\"stf__item\") ||\n    element.parentElement?.parentElement?.classList.contains(\"stf__item\")\n  ) {\n    // globalThis.ngxConsole.log(\"don't scroll in book mode\");\n    return;\n  }\n  // #716 end of modification\n\n  let parent = element.offsetParent;\n  if (!parent) {\n    globalThis.ngxConsole.error(\"offsetParent is not set -- cannot scroll\");\n    return;\n  }\n  let offsetY = element.offsetTop + element.clientTop;\n  let offsetX = element.offsetLeft + element.clientLeft;\n  while (\n    (parent.clientHeight === parent.scrollHeight &&\n      parent.clientWidth === parent.scrollWidth) ||\n    (scrollMatches &&\n      (parent.classList.contains(\"markedContent\") ||\n        getComputedStyle(parent).overflow === \"hidden\"))\n  ) {\n    offsetY += parent.offsetTop;\n    offsetX += parent.offsetLeft;\n\n    parent = parent.offsetParent;\n    if (!parent) {\n      // modified by ngx-extended-pdf-viewer #492\n      if (infiniteScroll) {\n        if (document.body.clientHeight > offsetY) {\n          // infinite scroll\n          offsetY -= 32;\n          window.scrollTo(window.scrollX, offsetY);\n        }\n      }\n      // end of modification #492\n      return; // no need to scroll\n    }\n  }\n  if (spot) {\n    if (spot.top !== undefined) {\n      offsetY += spot.top;\n    }\n    if (spot.left !== undefined) {\n      offsetX += spot.left;\n      parent.scrollLeft = offsetX;\n    }\n  // #1823 modified by ngx-extended-pdf-viewer\n  } else if (isDivInViewport(element)) {\n    return; // no need to scroll\n  // #1823 end of modification by ngx-extended-pdf-viewer\n  }\n  parent.scrollTop = offsetY;\n}\n\n// #1823 modified by ngx-extended-pdf-viewer\nfunction isDivInViewport(element) {\n  const rect = element.getBoundingClientRect();\n\n  // Check if the element is within the viewport's boundaries.\n  return (\n    rect.top >= 0 &&\n    rect.left >= 0 &&\n    rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&\n    rect.right <= (window.innerWidth || document.documentElement.clientWidth)\n  );\n}\n// #1823 end of modification by ngx-extended-pdf-viewer\n\n/**\n * Helper function to start monitoring the scroll event and converting them into\n * PDF.js friendly one: with scroll debounce and scroll direction.\n */\nfunction watchScroll(viewAreaElement, callback) {\n  const debounceScroll = function (evt) {\n    if (rAF) {\n      return;\n    }\n    // schedule an invocation of scroll for next animation frame.\n    rAF = window.requestAnimationFrame(function viewAreaElementScrolled() {\n      rAF = null;\n\n      const currentX = viewAreaElement.scrollLeft;\n      const lastX = state.lastX;\n      if (currentX !== lastX) {\n        state.right = currentX > lastX;\n      }\n      state.lastX = currentX;\n      const currentY = viewAreaElement.scrollTop;\n      const lastY = state.lastY;\n      if (currentY !== lastY) {\n        state.down = currentY > lastY;\n      }\n      state.lastY = currentY;\n      callback(state);\n    });\n  };\n\n  const state = {\n    right: true,\n    down: true,\n    lastX: viewAreaElement.scrollLeft,\n    lastY: viewAreaElement.scrollTop,\n    _eventHandler: debounceScroll,\n  };\n\n  let rAF = null;\n  viewAreaElement.addEventListener(\"scroll\", debounceScroll, true);\n  return state;\n}\n\n/**\n * Helper function to parse query string (e.g. ?param1=value&param2=...).\n * @param {string} query\n * @returns {Map}\n */\nfunction parseQueryString(query) {\n  const params = new Map();\n  for (const [key, value] of new URLSearchParams(query)) {\n    params.set(key.toLowerCase(), value);\n  }\n  return params;\n}\n\nconst InvisibleCharactersRegExp = /[\\x00-\\x1F]/g;\n\n/**\n * @param {string} str\n * @param {boolean} [replaceInvisible]\n */\nfunction removeNullCharacters(str, replaceInvisible = false) {\n  if (!InvisibleCharactersRegExp.test(str)) {\n    return str;\n  }\n  if (replaceInvisible) {\n    return str.replaceAll(InvisibleCharactersRegExp, m => {\n      return m === \"\\x00\" ? \"\" : \" \";\n    });\n  }\n  return str.replaceAll(\"\\x00\", \"\");\n}\n\n/**\n * Use binary search to find the index of the first item in a given array which\n * passes a given condition. The items are expected to be sorted in the sense\n * that if the condition is true for one item in the array, then it is also true\n * for all following items.\n *\n * @returns {number} Index of the first array element to pass the test,\n *                   or |items.length| if no such element exists.\n */\nfunction binarySearchFirstItem(items, condition, start = 0) {\n  let minIndex = start;\n  let maxIndex = items.length - 1;\n\n  if (maxIndex < 0 || !condition(items[maxIndex])) {\n    return items.length;\n  }\n  if (condition(items[minIndex])) {\n    return minIndex;\n  }\n\n  while (minIndex < maxIndex) {\n    const currentIndex = (minIndex + maxIndex) >> 1;\n    const currentItem = items[currentIndex];\n    if (condition(currentItem)) {\n      maxIndex = currentIndex;\n    } else {\n      minIndex = currentIndex + 1;\n    }\n  }\n  return minIndex; /* === maxIndex */\n}\n\n/**\n *  Approximates float number as a fraction using Farey sequence (max order\n *  of 8).\n *  @param {number} x - Positive float number.\n *  @returns {Array} Estimated fraction: the first array item is a numerator,\n *                   the second one is a denominator.\n */\nfunction approximateFraction(x) {\n  // Fast paths for int numbers or their inversions.\n  if (Math.floor(x) === x) {\n    return [x, 1];\n  }\n  const xinv = 1 / x;\n  const limit = 8;\n  if (xinv > limit) {\n    return [1, limit];\n  } else if (Math.floor(xinv) === xinv) {\n    return [1, xinv];\n  }\n\n  const x_ = x > 1 ? xinv : x;\n  // a/b and c/d are neighbours in Farey sequence.\n  let a = 0,\n    b = 1,\n    c = 1,\n    d = 1;\n  // Limiting search to order 8.\n  while (true) {\n    // Generating next term in sequence (order of q).\n    const p = a + c,\n      q = b + d;\n    if (q > limit) {\n      break;\n    }\n    if (x_ <= p / q) {\n      c = p;\n      d = q;\n    } else {\n      a = p;\n      b = q;\n    }\n  }\n  let result;\n  // Select closest of the neighbours to x.\n  if (x_ - a / b < c / d - x_) {\n    result = x_ === x ? [a, b] : [b, a];\n  } else {\n    result = x_ === x ? [c, d] : [d, c];\n  }\n  return result;\n}\n\nfunction roundToDivide(x, div) {\n  const r = x % div;\n  return r === 0 ? x : Math.round(x - r + div);\n}\n\n/**\n * @typedef {Object} GetPageSizeInchesParameters\n * @property {number[]} view\n * @property {number} userUnit\n * @property {number} rotate\n */\n\n/**\n * @typedef {Object} PageSize\n * @property {number} width - In inches.\n * @property {number} height - In inches.\n */\n\n/**\n * Gets the size of the specified page, converted from PDF units to inches.\n * @param {GetPageSizeInchesParameters} params\n * @returns {PageSize}\n */\nfunction getPageSizeInches({ view, userUnit, rotate }) {\n  const [x1, y1, x2, y2] = view;\n  // We need to take the page rotation into account as well.\n  const changeOrientation = rotate % 180 !== 0;\n\n  const width = ((x2 - x1) / 72) * userUnit;\n  const height = ((y2 - y1) / 72) * userUnit;\n\n  return {\n    width: changeOrientation ? height : width,\n    height: changeOrientation ? width : height,\n  };\n}\n\n/**\n * Helper function for getVisibleElements.\n *\n * @param {number} index - initial guess at the first visible element\n * @param {Array} views - array of pages, into which `index` is an index\n * @param {number} top - the top of the scroll pane\n * @returns {number} less than or equal to `index` that is definitely at or\n *   before the first visible element in `views`, but not by too much. (Usually,\n *   this will be the first element in the first partially visible row in\n *   `views`, although sometimes it goes back one row further.)\n */\nfunction backtrackBeforeAllVisibleElements(index, views, top) {\n  // binarySearchFirstItem's assumption is that the input is ordered, with only\n  // one index where the conditions flips from false to true: [false ...,\n  // true...]. With vertical scrolling and spreads, it is possible to have\n  // [false ..., true, false, true ...]. With wrapped scrolling we can have a\n  // similar sequence, with many more mixed true and false in the middle.\n  //\n  // So there is no guarantee that the binary search yields the index of the\n  // first visible element. It could have been any of the other visible elements\n  // that were preceded by a hidden element.\n\n  // Of course, if either this element or the previous (hidden) element is also\n  // the first element, there's nothing to worry about.\n  if (index < 2) {\n    return index;\n  }\n\n  // That aside, the possible cases are represented below.\n  //\n  //     ****  = fully hidden\n  //     A*B*  = mix of partially visible and/or hidden pages\n  //     CDEF  = fully visible\n  //\n  // (1) Binary search could have returned A, in which case we can stop.\n  // (2) Binary search could also have returned B, in which case we need to\n  // check the whole row.\n  // (3) Binary search could also have returned C, in which case we need to\n  // check the whole previous row.\n  //\n  // There's one other possibility:\n  //\n  //     ****  = fully hidden\n  //     ABCD  = mix of fully and/or partially visible pages\n  //\n  // (4) Binary search could only have returned A.\n\n  // Initially assume that we need to find the beginning of the current row\n  // (case 1, 2, or 4), which means finding a page that is above the current\n  // page's top. If the found page is partially visible, we're definitely not in\n  // case 3, and this assumption is correct.\n  let elt = views[index].div;\n  let pageTop = elt.offsetTop + elt.clientTop;\n\n  if (pageTop >= top) {\n    // The found page is fully visible, so we're actually either in case 3 or 4,\n    // and unfortunately we can't tell the difference between them without\n    // scanning the entire previous row, so we just conservatively assume that\n    // we do need to backtrack to that row. In both cases, the previous page is\n    // in the previous row, so use its top instead.\n    elt = views[index - 1].div;\n    pageTop = elt.offsetTop + elt.clientTop;\n  }\n\n  // Now we backtrack to the first page that still has its bottom below\n  // `pageTop`, which is the top of a page in the first visible row (unless\n  // we're in case 4, in which case it's the row before that).\n  // `index` is found by binary search, so the page at `index - 1` is\n  // invisible and we can start looking for potentially visible pages from\n  // `index - 2`. (However, if this loop terminates on its first iteration,\n  // which is the case when pages are stacked vertically, `index` should remain\n  // unchanged, so we use a distinct loop variable.)\n  for (let i = index - 2; i >= 0; --i) {\n    elt = views[i].div;\n    if (elt.offsetTop + elt.clientTop + elt.clientHeight <= pageTop) {\n      // We have reached the previous row, so stop now.\n      // This loop is expected to terminate relatively quickly because the\n      // number of pages per row is expected to be small.\n      break;\n    }\n    index = i;\n  }\n  return index;\n}\n\n/**\n * @typedef {Object} GetVisibleElementsParameters\n * @property {HTMLElement} scrollEl - A container that can possibly scroll.\n * @property {Array} views - Objects with a `div` property that contains an\n *   HTMLElement, which should all be descendants of `scrollEl` satisfying the\n *   relevant layout assumptions.\n * @property {boolean} sortByVisibility - If `true`, the returned elements are\n *   sorted in descending order of the percent of their padding box that is\n *   visible. The default value is `false`.\n * @property {boolean} horizontal - If `true`, the elements are assumed to be\n *   laid out horizontally instead of vertically. The default value is `false`.\n * @property {boolean} rtl - If `true`, the `scrollEl` container is assumed to\n *   be in right-to-left mode. The default value is `false`.\n */\n\n/**\n * Generic helper to find out what elements are visible within a scroll pane.\n *\n * Well, pretty generic. There are some assumptions placed on the elements\n * referenced by `views`:\n *   - If `horizontal`, no left of any earlier element is to the right of the\n *     left of any later element.\n *   - Otherwise, `views` can be split into contiguous rows where, within a row,\n *     no top of any element is below the bottom of any other element, and\n *     between rows, no bottom of any element in an earlier row is below the\n *     top of any element in a later row.\n *\n * (Here, top, left, etc. all refer to the padding edge of the element in\n * question. For pages, that ends up being equivalent to the bounding box of the\n * rendering canvas. Earlier and later refer to index in `views`, not page\n * layout.)\n *\n * @param {GetVisibleElementsParameters} params\n * @returns {Object} `{ first, last, views: [{ id, x, y, view, percent }] }`\n */\nfunction getVisibleElements({\n  scrollEl,\n  views,\n  sortByVisibility = false,\n  horizontal = false,\n  rtl = false,\n}) {\n  const top = scrollEl.scrollTop,\n    bottom = top + scrollEl.clientHeight;\n  const left = scrollEl.scrollLeft,\n    right = left + scrollEl.clientWidth;\n\n  // Throughout this \"generic\" function, comments will assume we're working with\n  // PDF document pages, which is the most important and complex case. In this\n  // case, the visible elements we're actually interested is the page canvas,\n  // which is contained in a wrapper which adds no padding/border/margin, which\n  // is itself contained in `view.div` which adds no padding (but does add a\n  // border). So, as specified in this function's doc comment, this function\n  // does all of its work on the padding edge of the provided views, starting at\n  // offsetLeft/Top (which includes margin) and adding clientLeft/Top (which is\n  // the border). Adding clientWidth/Height gets us the bottom-right corner of\n  // the padding edge.\n  function isElementBottomAfterViewTop(view) {\n    const element = view.div;\n    const elementBottom =\n      element.offsetTop + element.clientTop + element.clientHeight;\n    return elementBottom > top;\n  }\n  function isElementNextAfterViewHorizontally(view) {\n    const element = view.div;\n    const elementLeft = element.offsetLeft + element.clientLeft;\n    const elementRight = elementLeft + element.clientWidth;\n    return rtl ? elementLeft < right : elementRight > left;\n  }\n\n  const visible = [],\n    ids = new Set(),\n    numViews = views.length;\n  let firstVisibleElementInd = binarySearchFirstItem(\n    views,\n    horizontal\n      ? isElementNextAfterViewHorizontally\n      : isElementBottomAfterViewTop\n  );\n\n  // Please note the return value of the `binarySearchFirstItem` function when\n  // no valid element is found (hence the `firstVisibleElementInd` check below).\n  if (\n    firstVisibleElementInd > 0 &&\n    firstVisibleElementInd < numViews &&\n    !horizontal\n  ) {\n    // In wrapped scrolling (or vertical scrolling with spreads), with some page\n    // sizes, isElementBottomAfterViewTop doesn't satisfy the binary search\n    // condition: there can be pages with bottoms above the view top between\n    // pages with bottoms below. This function detects and corrects that error;\n    // see it for more comments.\n    firstVisibleElementInd = backtrackBeforeAllVisibleElements(\n      firstVisibleElementInd,\n      views,\n      top\n    );\n  }\n\n  // lastEdge acts as a cutoff for us to stop looping, because we know all\n  // subsequent pages will be hidden.\n  //\n  // When using wrapped scrolling or vertical scrolling with spreads, we can't\n  // simply stop the first time we reach a page below the bottom of the view;\n  // the tops of subsequent pages on the same row could still be visible. In\n  // horizontal scrolling, we don't have that issue, so we can stop as soon as\n  // we pass `right`, without needing the code below that handles the -1 case.\n  let lastEdge = horizontal ? right : -1;\n\n  for (let i = firstVisibleElementInd; i < numViews; i++) {\n    const view = views[i],\n      element = view.div;\n    const currentWidth = element.offsetLeft + element.clientLeft;\n    const currentHeight = element.offsetTop + element.clientTop;\n    const viewWidth = element.clientWidth,\n      viewHeight = element.clientHeight;\n    const viewRight = currentWidth + viewWidth;\n    const viewBottom = currentHeight + viewHeight;\n\n    if (lastEdge === -1) {\n      // As commented above, this is only needed in non-horizontal cases.\n      // Setting lastEdge to the bottom of the first page that is partially\n      // visible ensures that the next page fully below lastEdge is on the\n      // next row, which has to be fully hidden along with all subsequent rows.\n      if (viewBottom >= bottom) {\n        lastEdge = viewBottom;\n      }\n    } else if ((horizontal ? currentWidth : currentHeight) > lastEdge) {\n      break;\n    }\n\n    if (\n      viewBottom <= top ||\n      currentHeight >= bottom ||\n      viewRight <= left ||\n      currentWidth >= right\n    ) {\n      continue;\n    }\n\n    const hiddenHeight =\n      Math.max(0, top - currentHeight) + Math.max(0, viewBottom - bottom);\n    const hiddenWidth =\n      Math.max(0, left - currentWidth) + Math.max(0, viewRight - right);\n\n    const fractionHeight = (viewHeight - hiddenHeight) / viewHeight,\n      fractionWidth = (viewWidth - hiddenWidth) / viewWidth;\n    const percent = (fractionHeight * fractionWidth * 100) | 0;\n\n    visible.push({\n      id: view.id,\n      x: currentWidth,\n      y: currentHeight,\n      view,\n      percent,\n      widthPercent: (fractionWidth * 100) | 0,\n    });\n    ids.add(view.id);\n  }\n\n  const first = visible[0],\n    last = visible.at(-1);\n\n  if (sortByVisibility) {\n    visible.sort(function (a, b) {\n      const pc = a.percent - b.percent;\n      if (Math.abs(pc) > 0.001) {\n        return -pc;\n      }\n      return a.id - b.id; // ensure stability\n    });\n  }\n  return { first, last, views: visible, ids };\n}\n\nfunction normalizeWheelEventDirection(evt) {\n  let delta = Math.hypot(evt.deltaX, evt.deltaY);\n  const angle = Math.atan2(evt.deltaY, evt.deltaX);\n  if (-0.25 * Math.PI < angle && angle < 0.75 * Math.PI) {\n    // All that is left-up oriented has to change the sign.\n    delta = -delta;\n  }\n  return delta;\n}\n\nfunction normalizeWheelEventDelta(evt) {\n  const deltaMode = evt.deltaMode; // Avoid being affected by bug 1392460.\n  let delta = normalizeWheelEventDirection(evt);\n\n  const MOUSE_PIXELS_PER_LINE = 30;\n  const MOUSE_LINES_PER_PAGE = 30;\n\n  // Converts delta to per-page units\n  if (deltaMode === WheelEvent.DOM_DELTA_PIXEL) {\n    delta /= MOUSE_PIXELS_PER_LINE * MOUSE_LINES_PER_PAGE;\n  } else if (deltaMode === WheelEvent.DOM_DELTA_LINE) {\n    delta /= MOUSE_LINES_PER_PAGE;\n  }\n  return delta;\n}\n\nfunction isValidRotation(angle) {\n  return Number.isInteger(angle) && angle % 90 === 0;\n}\n\nfunction isValidScrollMode(mode) {\n  return (\n    Number.isInteger(mode) &&\n    Object.values(ScrollMode).includes(mode) &&\n    mode !== ScrollMode.UNKNOWN\n  );\n}\n\nfunction isValidSpreadMode(mode) {\n  return (\n    Number.isInteger(mode) &&\n    Object.values(SpreadMode).includes(mode) &&\n    mode !== SpreadMode.UNKNOWN\n  );\n}\n\nfunction isPortraitOrientation(size) {\n  return size.width <= size.height;\n}\n\n/**\n * Promise that is resolved when DOM window becomes visible.\n */\nconst animationStarted = new Promise(function (resolve) {\n  if (\n    typeof PDFJSDev !== \"undefined\" &&\n    PDFJSDev.test(\"LIB\") &&\n    typeof window === \"undefined\"\n  ) {\n    // Prevent \"ReferenceError: window is not defined\" errors when running the\n    // unit-tests in Node.js environments.\n    setTimeout(resolve, 20);\n    return;\n  }\n  window.ngxZone.runOutsideAngular(() => {\n    window.requestAnimationFrame(resolve);\n  });\n});\n\nconst docStyle =\n  typeof PDFJSDev !== \"undefined\" &&\n  PDFJSDev.test(\"LIB\") &&\n  typeof document === \"undefined\"\n    ? null\n    : document.documentElement.style;\n\nfunction clamp(v, min, max) {\n  return Math.min(Math.max(v, min), max);\n}\n\nclass ProgressBar {\n  #classList = null;\n\n  #disableAutoFetchTimeout = null;\n\n  #percent = 0;\n\n  #style = null;\n\n  #visible = true;\n\n  constructor(bar) {\n    this.#classList = bar.classList;\n    this.#style = bar.style;\n  }\n\n  get percent() {\n    return this.#percent;\n  }\n\n  set percent(val) {\n    this.#percent = clamp(val, 0, 100);\n\n    if (isNaN(val)) {\n      this.#classList.add(\"indeterminate\");\n      return;\n    }\n    this.#classList.remove(\"indeterminate\");\n\n    this.#style.setProperty(\"--progressBar-percent\", `${this.#percent}%`);\n  }\n\n  setWidth(viewer) {\n    if (!viewer) {\n      return;\n    }\n    const container = viewer.parentNode;\n    const scrollbarWidth = container.offsetWidth - viewer.offsetWidth;\n    if (scrollbarWidth > 0) {\n      this.#style.setProperty(\n        \"--progressBar-end-offset\",\n        `${scrollbarWidth}px`\n      );\n    }\n  }\n\n  setDisableAutoFetch(delay = /* ms = */ 5000) {\n    if (isNaN(this.#percent)) {\n      return;\n    }\n    if (this.#disableAutoFetchTimeout) {\n      clearTimeout(this.#disableAutoFetchTimeout);\n    }\n    this.show();\n\n    this.#disableAutoFetchTimeout = setTimeout(() => {\n      this.#disableAutoFetchTimeout = null;\n      this.hide();\n    }, delay);\n  }\n\n  hide() {\n    if (!this.#visible) {\n      return;\n    }\n    this.#visible = false;\n    this.#classList.add(\"hidden\");\n  }\n\n  show() {\n    if (this.#visible) {\n      return;\n    }\n    this.#visible = true;\n    this.#classList.remove(\"hidden\");\n  }\n}\n\n/**\n * Get the active or focused element in current DOM.\n *\n * Recursively search for the truly active or focused element in case there are\n * shadow DOMs.\n *\n * @returns {Element} the truly active or focused element.\n */\nfunction getActiveOrFocusedElement() {\n  let curRoot = document;\n  let curActiveOrFocused =\n    curRoot.activeElement || curRoot.querySelector(\":focus\");\n\n  while (curActiveOrFocused?.shadowRoot) {\n    curRoot = curActiveOrFocused.shadowRoot;\n    curActiveOrFocused =\n      curRoot.activeElement || curRoot.querySelector(\":focus\");\n  }\n\n  return curActiveOrFocused;\n}\n\n/**\n * Converts API PageLayout values to the format used by `BaseViewer`.\n * @param {string} layout - The API PageLayout value.\n * @returns {Object}\n */\nfunction apiPageLayoutToViewerModes(layout) {\n  let scrollMode = ScrollMode.VERTICAL,\n    spreadMode = SpreadMode.NONE;\n\n  switch (layout) {\n    case \"SinglePage\":\n      scrollMode = ScrollMode.PAGE;\n      break;\n    case \"OneColumn\":\n      break;\n    case \"TwoPageLeft\":\n      scrollMode = ScrollMode.PAGE;\n    /* falls through */\n    case \"TwoColumnLeft\":\n      spreadMode = SpreadMode.ODD;\n      break;\n    case \"TwoPageRight\":\n      scrollMode = ScrollMode.PAGE;\n    /* falls through */\n    case \"TwoColumnRight\":\n      spreadMode = SpreadMode.EVEN;\n      break;\n  }\n  return { scrollMode, spreadMode };\n}\n\n/**\n * Converts API PageMode values to the format used by `PDFSidebar`.\n * NOTE: There's also a \"FullScreen\" parameter which is not possible to support,\n *       since the Fullscreen API used in browsers requires that entering\n *       fullscreen mode only occurs as a result of a user-initiated event.\n * @param {string} mode - The API PageMode value.\n * @returns {number} A value from {SidebarView}.\n */\nfunction apiPageModeToSidebarView(mode) {\n  switch (mode) {\n    case \"UseNone\":\n      return SidebarView.NONE;\n    case \"UseThumbs\":\n      return SidebarView.THUMBS;\n    case \"UseOutlines\":\n      return SidebarView.OUTLINE;\n    case \"UseAttachments\":\n      return SidebarView.ATTACHMENTS;\n    case \"UseOC\":\n      return SidebarView.LAYERS;\n  }\n  return SidebarView.NONE; // Default value.\n}\n\nfunction toggleCheckedBtn(button, toggle, view = null) {\n  button.classList.toggle(\"toggled\", toggle);\n  button.setAttribute(\"aria-checked\", toggle);\n\n  view?.classList.toggle(\"hidden\", !toggle);\n}\n\nfunction toggleExpandedBtn(button, toggle, view = null) {\n  button.classList.toggle(\"toggled\", toggle);\n  button.setAttribute(\"aria-expanded\", toggle);\n\n  view?.classList.toggle(\"hidden\", !toggle);\n}\n\nexport {\n  animationStarted,\n  apiPageLayoutToViewerModes,\n  apiPageModeToSidebarView,\n  approximateFraction,\n  AutoPrintRegExp,\n  backtrackBeforeAllVisibleElements, // only exported for testing\n  binarySearchFirstItem,\n  CursorTool,\n  DEFAULT_SCALE,\n  DEFAULT_SCALE_DELTA,\n  DEFAULT_SCALE_VALUE,\n  docStyle,\n  getActiveOrFocusedElement,\n  getPageSizeInches,\n  getVisibleElements,\n  isPortraitOrientation,\n  isValidRotation,\n  isValidScrollMode,\n  isValidSpreadMode,\n  MAX_AUTO_SCALE,\n  MAX_SCALE,\n  MIN_SCALE,\n  normalizeWheelEventDelta,\n  normalizeWheelEventDirection,\n  OutputScale,\n  parseQueryString,\n  PresentationModeState,\n  ProgressBar,\n  removeNullCharacters,\n  RenderingStates,\n  roundToDivide,\n  SCROLLBAR_PADDING,\n  scrollIntoView,\n  ScrollMode,\n  SidebarView,\n  SpreadMode,\n  TextLayerMode,\n  toggleCheckedBtn,\n  toggleExpandedBtn,\n  UNKNOWN_SCALE,\n  VERTICAL_PADDING,\n  watchScroll,\n};\n","/* Copyright 2021 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** @typedef {import(\"../src/display/api\").PDFPageProxy} PDFPageProxy */\n// eslint-disable-next-line max-len\n/** @typedef {import(\"../src/display/annotation_storage\").AnnotationStorage} AnnotationStorage */\n// eslint-disable-next-line max-len\n/** @typedef {import(\"../src/display/display_utils\").PageViewport} PageViewport */\n/** @typedef {import(\"./interfaces\").IPDFLinkService} IPDFLinkService */\n\nimport { XfaLayer } from \"pdfjs-lib\";\n\n/**\n * @typedef {Object} XfaLayerBuilderOptions\n * @property {PDFPageProxy} pdfPage\n * @property {AnnotationStorage} [annotationStorage]\n * @property {IPDFLinkService} linkService\n * @property {Object} [xfaHtml]\n */\n\nclass XfaLayerBuilder {\n  /**\n   * @param {XfaLayerBuilderOptions} options\n   */\n  constructor({\n    pdfPage,\n    annotationStorage = null,\n    linkService,\n    xfaHtml = null,\n  }) {\n    this.pdfPage = pdfPage;\n    this.annotationStorage = annotationStorage;\n    this.linkService = linkService;\n    this.xfaHtml = xfaHtml;\n\n    this.div = null;\n    this._cancelled = false;\n  }\n\n  /**\n   * @param {PageViewport} viewport\n   * @param {string} intent (default value is 'display')\n   * @returns {Promise<Object | void>} A promise that is resolved when rendering\n   *   of the XFA layer is complete. The first rendering will return an object\n   *   with a `textDivs` property that can be used with the TextHighlighter.\n   */\n  async render(viewport, intent = \"display\") {\n    if (intent === \"print\") {\n      const parameters = {\n        viewport: viewport.clone({ dontFlip: true }),\n        div: this.div,\n        xfaHtml: this.xfaHtml,\n        annotationStorage: this.annotationStorage,\n        linkService: this.linkService,\n        intent,\n      };\n\n      // Create an xfa layer div and render the form\n      this.div = document.createElement(\"div\");\n      parameters.div = this.div;\n\n      return XfaLayer.render(parameters);\n    }\n\n    // intent === \"display\"\n    const xfaHtml = await this.pdfPage.getXfa();\n    if (this._cancelled || !xfaHtml) {\n      return { textDivs: [] };\n    }\n\n    const parameters = {\n      viewport: viewport.clone({ dontFlip: true }),\n      div: this.div,\n      xfaHtml,\n      annotationStorage: this.annotationStorage,\n      linkService: this.linkService,\n      intent,\n    };\n\n    if (this.div) {\n      return XfaLayer.update(parameters);\n    }\n    // Create an xfa layer div and render the form\n    this.div = document.createElement(\"div\");\n    parameters.div = this.div;\n\n    return XfaLayer.render(parameters);\n  }\n\n  cancel() {\n    this._cancelled = true;\n  }\n\n  hide() {\n    if (!this.div) {\n      return;\n    }\n    this.div.hidden = true;\n  }\n}\n\nexport { XfaLayerBuilder };\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","var webpackQueues = typeof Symbol === \"function\" ? Symbol(\"webpack queues\") : \"__webpack_queues__\";\nvar webpackExports = typeof Symbol === \"function\" ? Symbol(\"webpack exports\") : \"__webpack_exports__\";\nvar webpackError = typeof Symbol === \"function\" ? Symbol(\"webpack error\") : \"__webpack_error__\";\nvar resolveQueue = (queue) => {\n\tif(queue && queue.d < 1) {\n\t\tqueue.d = 1;\n\t\tqueue.forEach((fn) => (fn.r--));\n\t\tqueue.forEach((fn) => (fn.r-- ? fn.r++ : fn()));\n\t}\n}\nvar wrapDeps = (deps) => (deps.map((dep) => {\n\tif(dep !== null && typeof dep === \"object\") {\n\t\tif(dep[webpackQueues]) return dep;\n\t\tif(dep.then) {\n\t\t\tvar queue = [];\n\t\t\tqueue.d = 0;\n\t\t\tdep.then((r) => {\n\t\t\t\tobj[webpackExports] = r;\n\t\t\t\tresolveQueue(queue);\n\t\t\t}, (e) => {\n\t\t\t\tobj[webpackError] = e;\n\t\t\t\tresolveQueue(queue);\n\t\t\t});\n\t\t\tvar obj = {};\n\t\t\tobj[webpackQueues] = (fn) => (fn(queue));\n\t\t\treturn obj;\n\t\t}\n\t}\n\tvar ret = {};\n\tret[webpackQueues] = x => {};\n\tret[webpackExports] = dep;\n\treturn ret;\n}));\n__webpack_require__.a = (module, body, hasAwait) => {\n\tvar queue;\n\thasAwait && ((queue = []).d = -1);\n\tvar depQueues = new Set();\n\tvar exports = module.exports;\n\tvar currentDeps;\n\tvar outerResolve;\n\tvar reject;\n\tvar promise = new Promise((resolve, rej) => {\n\t\treject = rej;\n\t\touterResolve = resolve;\n\t});\n\tpromise[webpackExports] = exports;\n\tpromise[webpackQueues] = (fn) => (queue && fn(queue), depQueues.forEach(fn), promise[\"catch\"](x => {}));\n\tmodule.exports = promise;\n\tbody((deps) => {\n\t\tcurrentDeps = wrapDeps(deps);\n\t\tvar fn;\n\t\tvar getResult = () => (currentDeps.map((d) => {\n\t\t\tif(d[webpackError]) throw d[webpackError];\n\t\t\treturn d[webpackExports];\n\t\t}))\n\t\tvar promise = new Promise((resolve) => {\n\t\t\tfn = () => (resolve(getResult));\n\t\t\tfn.r = 0;\n\t\t\tvar fnQueue = (q) => (q !== queue && !depQueues.has(q) && (depQueues.add(q), q && !q.d && (fn.r++, q.push(fn))));\n\t\t\tcurrentDeps.map((dep) => (dep[webpackQueues](fnQueue)));\n\t\t});\n\t\treturn fn.r ? promise : getResult();\n\t}, (err) => ((err ? reject(promise[webpackError] = err) : outerResolve(exports)), resolveQueue(queue)));\n\tqueue && queue.d < 0 && (queue.d = 0);\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","","// startup\n// Load entry module and return exports\n// This entry module used 'module' so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(103);\n",""],"names":["_iterableToArrayLimit","arr","i","_i","Symbol","iterator","_s","_e","_x","_r","_arr","_n","_d","call","next","Object","done","push","value","length","err","return","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","apply","_objectSpread2","target","arguments","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","obj","_toPropertyKey","configurable","writable","_objectWithoutPropertiesLoose","excluded","sourceKeys","indexOf","_objectWithoutProperties","sourceSymbolKeys","prototype","propertyIsEnumerable","_slicedToArray","_arrayWithHoles","_unsupportedIterableToArray","_nonIterableRest","_toConsumableArray","_arrayWithoutHoles","_iterableToArray","_nonIterableSpread","Array","isArray","_arrayLikeToArray","iter","from","o","minLen","n","toString","slice","constructor","name","test","len","arr2","TypeError","_toPrimitive","input","hint","prim","toPrimitive","undefined","res","String","Number","arg","canvasTest","settings","size","sizes","shift","width","Math","max","ceil","height","fill","job","Date","now","isWorker","WorkerGlobalScope","self","cropCvs","testCvs","OffscreenCanvas","document","createElement","cropCtx","getContext","testCtx","fillRect","drawImage","isTestPass","getImageData","data","benchmark","cvs","postMessage","onSuccess","onError","testSizes","area","_excluded","defaults","min","step","usePromise","useWorker","Function","workerJobs","createSizesArray","isArea","isWidth","isHeight","testSize","testMin","testStep","handleMethod","hasCanvasSupport","window","hasOffscreenCanvasSupport","jobID","_onError","_onSuccess","settingsWithoutCallbacks","worker","js","concat","blob","Blob","type","blobURL","URL","createObjectURL","Worker","revokeObjectURL","onmessage","e","_e$data","Promise","resolve","reject","promiseSettings","isLastTest","_settings$sizes$slice","_settings$sizes$slice2","_settings$sizes$slice3","lastWidth","lastHeight","canvasSize","maxArea","options","maxHeight","maxWidth","default","FluentType","valueOf","FluentNone","scope","FluentNumber","opts","nf","memoizeIntlObject","Intl","NumberFormat","format","reportError","FluentDateTime","dtf","DateTimeFormat","toISOString","MAX_PLACEABLES","FSI","PDI","match","selector","category","PluralRules","select","getDefault","variants","star","resolvePattern","RangeError","getArguments","args","positional","named","create","resolveExpression","expr","minimumFractionDigits","precision","resolveVariableReference","resolveMessageReference","resolveTermReference","resolveFunctionReference","resolveSelectExpression","params","hasOwnProperty","ReferenceError","getTime","attr","message","bundle","_messages","get","attribute","attributes","id","term","_terms","resolved","func","_functions","sel","variant","resolveComplexPattern","ptn","dirty","has","add","result","useIsolating","_useIsolating","elem","_transform","placeables","delete","join","Scope","errors","WeakSet","error","Error","ctor","cache","_intls","set","JSON","stringify","locales","values","allowed","unwrapped","opt","entries","includes","NUMBER_ALLOWED","NUMBER","DATETIME_ALLOWED","DATETIME","Map","getMemoizerForLocale","stringLocale","memoizer","FluentBundle","functions","transform","v","hasMessage","getMessage","addResource","allowOverrides","body","entry","startsWith","formatPattern","pattern","RE_MESSAGE_START","RE_ATTRIBUTE_START","RE_VARIANT_START","RE_NUMBER_LITERAL","RE_IDENTIFIER","RE_REFERENCE","RE_FUNCTION_NAME","RE_TEXT_RUN","RE_STRING_RUN","RE_STRING_ESCAPE","RE_UNICODE_ESCAPE","RE_LEADING_NEWLINES","RE_TRAILING_SPACES","RE_BLANK_LINES","RE_INDENT","TOKEN_BRACE_OPEN","TOKEN_BRACE_CLOSE","TOKEN_BRACKET_OPEN","TOKEN_BRACKET_CLOSE","TOKEN_PAREN_OPEN","TOKEN_ARROW","TOKEN_COLON","TOKEN_COMMA","TOKEN_BLANK","FluentResource","lastIndex","cursor","exec","parseMessage","SyntaxError","re","consumeChar","char","errorClass","consumeToken","match1","parsePattern","parseAttributes","attrs","first","parsePatternElements","Infinity","indent","parseIndent","trim","elements","commonIndent","parsePlaceable","lastElement","baked","element","Indent","parseInlineExpression","parseVariants","sigil","parseArguments","parseLiteral","parseArgument","count","parseVariantKey","parseNumberLiteral","parseStringLiteral","fraction","parseFloat","parseEscapeSequence","codepoint4","codepoint6","codepoint","parseInt","fromCodePoint","start","makeIndent","text","replace","blank","reOverlay","TEXT_LEVEL_ELEMENTS","LOCALIZABLE_ATTRIBUTES","global","a","menuitem","menu","optgroup","option","track","img","textarea","th","description","label","textbox","translateElement","translation","localName","namespaceURI","textContent","templateElement","ownerDocument","createElementNS","innerHTML","overlayChildNodes","content","overlayAttributes","fromFragment","toElement","childNode","childNodes","nodeType","TEXT_NODE","hasAttribute","sanitized","getNodeForNamedElement","replaceChild","isElementAllowed","createSanitizedElement","console","warn","createTextNodeFromTextContent","appendChild","fromElement","explicitlyAllowed","getAttribute","split","map","isAttrNameLocalizable","removeAttribute","setAttribute","sourceElement","translatedChild","childName","sourceChild","querySelector","removeChild","clone","cloneNode","shallowPopulateUsing","createTextNode","attrName","toLowerCase","elemName","CachedIterable","iterable","CachedSyncIterable","cached","cur","touchNext","idx","last","CachedAsyncIterable","asyncIterator","Localization","resourceIds","generateBundles","onChange","addResourceIds","eager","removeResourceIds","r","formatWithFallback","method","translations","hasAtLeastOneBundle","bundles","missingIds","keysFromBundle","locale","ids","formatMessages","messageFromBundle","formatValues","valueFromBundle","formatValue","val","handleEvent","formatted","attrNames","messageErrors","Set","L10NID_ATTR_NAME","L10NARGS_ATTR_NAME","L10N_ELEMENT_QUERY","DOMLocalization","roots","pendingrAF","pendingElements","windowElement","mutationObserver","observerConfig","characterData","childList","subtree","attributeFilter","translateRoots","setAttributes","getAttributes","parse","connectRoot","newRoot","root","contains","defaultView","MutationObserver","mutations","translateMutations","observe","disconnectRoot","pauseObserving","clear","resumeObserving","all","translateFragment","takeRecords","disconnect","mutation","addedNode","addedNodes","ELEMENT_NODE","childElementCount","getTranslatables","requestAnimationFrame","translateElements","frag","getKeysForElement","applyTranslations","nodes","querySelectorAll","isNodeJS","process","versions","nw","electron","IDENTITY_MATRIX","FONT_IDENTITY_MATRIX","MAX_IMAGE_SIZE_TO_CACHE","LINE_FACTOR","LINE_DESCENT_FACTOR","BASELINE_FACTOR","RenderingIntentFlag","ANY","DISPLAY","PRINT","SAVE","ANNOTATIONS_FORMS","ANNOTATIONS_STORAGE","ANNOTATIONS_DISABLE","OPLIST","AnnotationMode","DISABLE","ENABLE","ENABLE_FORMS","ENABLE_STORAGE","AnnotationEditorPrefix","AnnotationEditorType","NONE","FREETEXT","HIGHLIGHT","STAMP","INK","AnnotationEditorParamsType","RESIZE","CREATE","FREETEXT_SIZE","FREETEXT_COLOR","FREETEXT_OPACITY","INK_COLOR","INK_THICKNESS","INK_OPACITY","PermissionFlag","MODIFY_CONTENTS","COPY","MODIFY_ANNOTATIONS","FILL_INTERACTIVE_FORMS","COPY_FOR_ACCESSIBILITY","ASSEMBLE","PRINT_HIGH_QUALITY","TextRenderingMode","FILL","STROKE","FILL_STROKE","INVISIBLE","FILL_ADD_TO_PATH","STROKE_ADD_TO_PATH","FILL_STROKE_ADD_TO_PATH","ADD_TO_PATH","FILL_STROKE_MASK","ADD_TO_PATH_FLAG","ImageKind","GRAYSCALE_1BPP","RGB_24BPP","RGBA_32BPP","AnnotationType","TEXT","LINK","LINE","SQUARE","CIRCLE","POLYGON","POLYLINE","UNDERLINE","SQUIGGLY","STRIKEOUT","CARET","POPUP","FILEATTACHMENT","SOUND","MOVIE","WIDGET","SCREEN","PRINTERMARK","TRAPNET","WATERMARK","THREED","REDACT","AnnotationReplyType","GROUP","REPLY","AnnotationFlag","HIDDEN","NOZOOM","NOROTATE","NOVIEW","READONLY","LOCKED","TOGGLENOVIEW","LOCKEDCONTENTS","AnnotationFieldFlag","REQUIRED","NOEXPORT","MULTILINE","PASSWORD","NOTOGGLETOOFF","RADIO","PUSHBUTTON","COMBO","EDIT","SORT","FILESELECT","MULTISELECT","DONOTSPELLCHECK","DONOTSCROLL","COMB","RICHTEXT","RADIOSINUNISON","COMMITONSELCHANGE","AnnotationBorderStyleType","SOLID","DASHED","BEVELED","INSET","AnnotationActionEventType","E","X","D","U","Fo","Bl","PO","PC","PV","PI","K","F","V","C","DocumentActionEventType","WC","WS","DS","WP","DP","PageActionEventType","O","VerbosityLevel","ERRORS","WARNINGS","INFOS","CMapCompressionType","BINARY","OPS","dependency","setLineWidth","setLineCap","setLineJoin","setMiterLimit","setDash","setRenderingIntent","setFlatness","setGState","save","restore","moveTo","lineTo","curveTo","curveTo2","curveTo3","closePath","rectangle","stroke","closeStroke","eoFill","fillStroke","eoFillStroke","closeFillStroke","closeEOFillStroke","endPath","clip","eoClip","beginText","endText","setCharSpacing","setWordSpacing","setHScale","setLeading","setFont","setTextRenderingMode","setTextRise","moveText","setLeadingMoveText","setTextMatrix","nextLine","showText","showSpacedText","nextLineShowText","nextLineSetSpacingShowText","setCharWidth","setCharWidthAndBounds","setStrokeColorSpace","setFillColorSpace","setStrokeColor","setStrokeColorN","setFillColor","setFillColorN","setStrokeGray","setFillGray","setStrokeRGBColor","setFillRGBColor","setStrokeCMYKColor","setFillCMYKColor","shadingFill","beginInlineImage","beginImageData","endInlineImage","paintXObject","markPoint","markPointProps","beginMarkedContent","beginMarkedContentProps","endMarkedContent","beginCompat","endCompat","paintFormXObjectBegin","paintFormXObjectEnd","beginGroup","endGroup","beginAnnotation","endAnnotation","paintImageMaskXObject","paintImageMaskXObjectGroup","paintImageXObject","paintInlineImageXObject","paintInlineImageXObjectGroup","paintImageXObjectRepeat","paintImageMaskXObjectRepeat","paintSolidColorImageMask","constructPath","PasswordResponses","NEED_PASSWORD","INCORRECT_PASSWORD","verbosity","setVerbosityLevel","level","isInteger","getVerbosityLevel","info","msg","log","Window","globalThis","ngxConsole","unreachable","assert","cond","_isValidProtocol","url","protocol","createValidAbsoluteUrl","baseUrl","addDefaultProtocol","dots","tryConvertEncoding","stringToUTF8String","absoluteUrl","shadow","prop","nonSerializable","BaseException","BaseExceptionClosure","PasswordException","code","UnknownErrorException","details","InvalidPDFException","MissingPDFException","UnexpectedResponseException","status","FormatError","AbortException","bytesToString","bytes","MAX_ARGUMENT_COUNT","fromCharCode","strBuf","chunkEnd","chunk","subarray","stringToBytes","str","Uint8Array","charCodeAt","string32","objectSize","objectFromMap","isLittleEndian","buffer8","view32","Uint32Array","buffer","isEvalSupported","FeatureTest","isOffscreenCanvasSupported","platform","navigator","isMac","isCSSRoundSupported","CSS","supports","hexNumbers","padStart","Util","makeHexColor","g","b","scaleMinMax","minMax","temp","m1","m2","applyTransform","p","m","xt","yt","applyInverseTransform","d","getAxialAlignedBoundingBox","p1","p2","p3","p4","inverseTransform","singularValueDecompose2dScale","transpose","c","second","sqrt","sx","sy","normalizeRect","rect","intersect","rect1","rect2","xLow","xHigh","yLow","yHigh","bezierBoundingBox","x0","y0","x1","y1","x2","y2","x3","y3","tvalues","bounds","t","t1","t2","b2ac","sqrtb2ac","abs","j","mt","jlen","PDFStringTranslateTable","stringToPDFString","encoding","decoder","TextDecoder","fatal","decoded","decode","replaceAll","ex","ii","charCode","charAt","decodeURIComponent","escape","utf8StringToString","unescape","encodeURIComponent","isArrayBuffer","byteLength","isArrayEqual","arr1","getModificationDate","date","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","PromiseCapability","settled","promise","reason","NormalizeRegex","NormalizationMap","normalizeUnicode","_","normalize","getUuid","crypto","randomUUID","buf","getRandomValues","floor","random","AnnotationPrefix","AnnotationEditorLayer","NullL10n","AnnotationEditorLayerBuilder","annotationLayer","uiManager","pageDiv","pdfPage","accessibilityManager","l10n","annotationEditorLayer","div","_cancelled","render","viewport","intent","clonedViewport","dontFlip","update","show","className","tabIndex","hidden","dir","direction","append","pageIndex","pageNumber","parameters","annotations","cancel","destroy","remove","hide","isEmpty","AnnotationLayer","PresentationModeState","AnnotationLayerBuilder","onPresentationModeChanged","linkService","downloadManager","annotationStorage","imageResourcesPath","renderForms","enableScripting","hasJSActionsPromise","fieldObjectsPromise","annotationCanvasMap","_hasJSActionsPromise","_fieldObjectsPromise","_annotationCanvasMap","_accessibilityManager","_eventBus","eventBus","hasJSActions","fieldObjects","getAnnotations","page","isInPresentationMode","updatePresentationModeState","FULLSCREEN","evt","state","_on","_off","disableFormElements","NORMAL","section","inert","compatibilityParams","userAgent","maxTouchPoints","isAndroid","isIOS","checkCanvasSizeLimitation","maxCanvasPixels","OptionKind","BROWSER","VIEWER","API","WORKER","PREFERENCE","defaultOptions","canvasMaxAreaInBytes","kind","isInAutomation","supportsDocumentFonts","supportsIntegratedFind","supportsMouseWheelZoomCtrlKey","supportsMouseWheelZoomMetaKey","supportsPinchToZoom","annotationEditorMode","annotationMode","cursorToolOnLoad","defaultZoomDelay","defaultZoomValue","disableHistory","disablePageLabels","enablePermissions","enablePrintAutoRotate","externalLinkRel","externalLinkTarget","historyUpdateUrl","ignoreDestinationZoom","forcePageColors","pageColorsBackground","pageColorsForeground","pdfBugEnabled","printResolution","removePageBorders","sidebarViewOnLoad","scrollModeOnLoad","spreadModeOnLoad","textLayerMode","viewOnLoad","cMapPacked","cMapUrl","disableAutoFetch","disableFontFace","disableRange","disableStream","docBaseUrl","enableXfa","fontExtraProperties","maxImageSize","pdfBug","standardFontDataUrl","workerPort","workerSrc","viewerCssTheme","defaultUrl","disablePreferences","language","sandboxBundleSrc","userOptions","pdfDefaultOptions","AppOptions","userOption","defaultOption","getAll","setAll","init","isPdfFile","download","blobUrl","filename","click","href","documentElement","DownloadManager","openBlobUrls","WeakMap","downloadUrl","_options","downloadData","contentType","openOrDownloadData","dest","isPdfData","WaitOnType","EVENT","TIMEOUT","waitOnEventOrTimeout","delay","handler","EventBus","eventHandler","removeEventListener","timeout","clearTimeout","bind","addEventListener","timeoutHandler","setTimeout","listeners","on","eventName","listener","external","once","off","dispatch","eventListeners","externalListeners","splice","AutomationEventBus","getPdfFilenameFromUrl","docProperties","pdfDocument","metadata","contentDispositionFilename","contentLength","getMetadata","getDownloadInfo","baseURL","filesize","getRaw","authors","numPages","GenericScripting","_ready","sandbox","__non_webpack_import__","then","pdfjsSandbox","QuickJSSandbox","catch","createSandbox","dispatchEventInSandbox","event","dispatchEvent","destroySandbox","nukeSandbox","fetchData","L10n","GenericL10n","lang","_setL10n","getLanguage","defaultLang","baseLang","paths","getPaths","langs","shortLang","createBundle","path","resource","isRTL","fixupLangCode","getDirection","fallback","messages","translate","pause","resume","langCode","PARTIAL_LANG_CODES","en","es","fy","ga","gu","hi","hy","nb","ne","nn","pa","pt","sv","zh","shortCode","ConstL10n","instance","Page","density","angle","position","x","y","hardAngle","hardDrawingAngle","createdDensity","nowDrawingDensity","setDensity","setDrawingDensity","setPosition","pagePos","setAngle","setArea","setHardDrawingAngle","setHardAngle","setOrientation","orientation","getDrawingDensity","getDensity","getHardAngle","ImagePage","image","isLoad","loadingAngle","Image","src","draw","tempDensity","activateWillReadFrequentlyFlag","willReadFrequently","ctx","canvas","convertToGlobal","pageWidth","getRect","pageHeight","beginPath","rotate","drawLoader","simpleDraw","orient","left","top","shiftPos","strokeStyle","fillStyle","lineWidth","middlePoint","arc","load","onload","newTemporaryCopy","getTemporaryCopy","hideTemporaryCopy","PageCollection","app","pages","currentPageIndex","currentSpreadIndex","landscapeSpread","portraitSpread","isShowCover","getSettings","showCover","createSpread","getSpread","getOrientation","getSpreadIndexByPage","pageNum","spread","getPageCount","getPages","getPage","nextBy","current","prevBy","getFlippingPage","getBottomPage","showNext","showSpread","showPrev","getCurrentPageIndex","spreadIndex","getCurrentSpreadIndex","setCurrentSpreadIndex","newIndex","setLeftPage","setRightPage","updatePageIndex","ImagePageCollection","imagesHref","Helper","GetDistanceBetweenTwoPoint","point1","point2","pow","GetSegmentLength","segment","GetAngleBetweenTwoLine","line1","line2","A1","A2","B1","B2","acos","PointInRect","pos","GetRotatedPoint","transformedPoint","startPoint","cos","sin","LimitPointToCircle","radius","limitedPoint","GetIntersectBetweenTwoSegment","rectBorder","one","two","GetIntersectBeetwenTwoLine","C1","C2","det1","det2","isFinite","GetCordsFromTwoPoint","pointOne","pointTwo","sizeX","sizeY","lengthLine","getCord","c1","c2","index","HTMLPage","copiedElement","temporaryCopy","classList","parentElement","commonStyle","style","zIndex","drawHard","drawSoft","newStyle","cssText","polygon","isSafari","startZIndex","getElement","HTMLPageCollection","items","pagesElement","pageElement","dataset","FlipCalculation","corner","topIntersectPoint","sideIntersectPoint","bottomIntersectPoint","calc","localPos","calcAngleAndPosition","calculateIntersectPoint","getFlippingClipArea","clipBottom","topLeft","bottomLeft","getBottomClipArea","getAngle","getPosition","getActiveCorner","topRight","getFlippingProgress","getCorner","getBottomPagePosition","getShadowStartPoint","getShadowAngle","getSegmentToShadowLine","updateAngleAndGeometry","checkPositionAtCenterLine","calculateAngle","getPageRect","da","getRectFromBasePoint","points","getRotatedPoint","bottomRight","boundRect","checkedPos","centerOne","centerTwo","tmp","rad","checkPointOne","checkPointTwo","bottomPoint","Flip","flippingPage","bottomPage","fold","globalPos","setState","do","convertToPage","flip","disableFlipByClick","isPointOnCorners","finishAnimation","getBoundsRect","topMargins","yStart","yDest","animateFlippingTo","reset","bookPos","convertToBook","getDirectionByPoint","flipCorner","checkDirection","getPageCollection","nextPage","prevPage","setDirection","progress","setPageRect","setBottomPage","setFlippingPage","setShadowData","flipToPage","flipNext","flipPrev","stopMove","showCorner","checkState","fixedCornerSize","isTurned","needReset","frames","duration","getAnimationDuration","startAnimation","turnToPrevPage","turnToNextPage","clearShadow","getCalculation","getState","newState","updateState","touchPos","defaultTime","flippingTime","states","operatingDistance","Render","setting","leftPage","rightPage","animation","pageRect","boundsRect","timer","safari","regex","RegExp","frameIndex","round","startedAt","durationFrame","onAnimateEnd","drawFrame","loop","ngxZone","runOutsideAngular","calculateBoundsRect","updateOrientation","blockWidth","getBlockWidth","getBlockHeight","ratio","minWidth","usePortrait","drawShadow","maxShadowOpacity","opacity","getUI","getDistElement","offsetWidth","offsetHeight","convertRectToGlobal","CanvasRender","inCanvas","reload","drawBookShadow","drawOuterShadow","drawInnerShadow","shadowSize","shadowPos","outerGradient","createLinearGradient","addColorStop","isw","innerGradient","UI","inBlock","touchPoint","swipeTimeout","onResize","onMouseDown","checkTarget","getMousePos","clientX","clientY","startUserTouch","preventDefault","onTouchStart","changedTouches","point","time","mobileScrollSupport","onMouseUp","userStop","onMouseMove","userMove","onTouchMove","cancelable","onTouchEnd","isSwipe","dx","distY","swipeDistance","getRender","insertAdjacentHTML","wrapper","k","minHeight","autoSize","display","useMouseEvents","removeHandlers","distElement","getWrapper","setOrientationStyle","paddingBottom","setHandlers","passive","getBoundingClientRect","targer","clickEventForward","tagName","HTMLUI","item","updateItems","CanvasUI","resizeCanvas","cs","getComputedStyle","getPropertyValue","getCanvas","EventObject","events","callback","trigger","HTMLRender","outerShadow","innerShadow","hardShadow","hardInnerShadow","createShadows","testShadow","drawHardInnerShadow","innerShadowSize","drawHardOuterShadow","shadowTranslate","shadowDirection","drawLeftPage","drawRightPage","drawBottomPage","lastAngle","Settings","_default","startPage","showPageCorners","userSetting","assign","styleInject","css","ref","insertAt","head","getElementsByTagName","firstChild","insertBefore","styleSheet","css_248z","PageFlip","isUserTouch","isUserMove","block","ui","loadFromImages","flipController","mode","loadFromHTML","updateFromImages","updateFromHtml","turnToPage","newPage","newOrientation","getFlipController","mousePosition","isTouch","binarySearchFirstItem","scrollIntoView","getCharacterType","getNormalizeWithNFKC","FindState","FOUND","NOT_FOUND","WRAPPED","PENDING","FIND_TIMEOUT","MATCH_SCROLL_OFFSET_TOP","MATCH_SCROLL_OFFSET_LEFT","CHARACTERS_TO_NORMALIZE","DIACRITICS_EXCEPTION","DIACRITICS_EXCEPTION_STR","DIACRITICS_REG_EXP","SPECIAL_CHARS_REG_EXP","NOT_DIACRITIC_FROM_END_REG_EXP","NOT_DIACRITIC_FROM_START_REG_EXP","SYLLABLES_REG_EXP","SYLLABLES_LENGTHS","FIRST_CHAR_SYLLABLES_REG_EXP","NFKC_CHARS_TO_NORMALIZE","noSyllablesRegExp","withSyllablesRegExp","syllablePositions","normalizationRegex","toNormalizeWithNFKC","CJK","HKDiacritics","regexp","rawDiacriticsPositions","normalized","positions","rawDiacriticsIndex","syllableIndex","shiftOrigin","eol","hasDiacritics","p5","p6","p7","p8","replacement","jj","hasTrailingDashEOL","endsWith","newCharLen","getOriginalIndex","diffs","end","oldStart","oldEnd","oldLen","PDFFindController","updateMatchesCountOnProgress","visitedPagesCount","pageViewMode","_linkService","_pageViewMode","onIsPageVisible","onFind","onFindBarClose","highlightMatches","_highlightMatches","pageMatches","_pageMatches","pageMatchesLength","_pageMatchesLength","selected","_selected","setDocument","_pdfDocument","_firstPageCapability","shouldDirtyMatch","_dirtyMatch","updateUIState","hasMatches","some","matches","emptyQuery","query","reportAsFound","extractText","findbarClosed","pendingTimeout","_findTimeout","nextMatch","highlightAll","updateAllPages","scrollMatchIntoView","selectedLeft","matchIndex","_scrollMatches","matchIdx","pageIdx","spot","_offset","wrapped","_extractTextPromises","_pageContents","_pageDiffs","_hasDiacritics","_matchesCountTotal","_pagesToSearch","_pendingFindMatches","_resumePageIdx","_rawQuery","_normalizedQuery","q","newQuery","prevQuery","newType","prevType","pagesCount","isEntireWord","startIdx","limit","calculateRegExpMatch","entireWord","pageContent","matchesLength","matchPos","matchLen","convertToRegExpString","matchDiacritics","isUnicode","trailingSpaces","calculateMatch","caseSensitive","sort","reverse","isUnicodePart","queryPart","flags","updatePage","nextPageMatch","pageMatchesCount","updateUIResultsCount","textOptions","disableNormalization","extractTextCapability","getTextContent","textItem","hasEOL","previous","findPrevious","offset","numPageMatches","updateMatch","advanceOffsetPage","matchesReady","numMatches","found","previousPage","requestMatchesCount","total","matchesCount","rawQuery","CharacterType","SPACE","ALPHA_LETTER","PUNCT","HAN_LETTER","KATAKANA_LETTER","HIRAGANA_LETTER","HALFWIDTH_KATAKANA_LETTER","THAI_LETTER","isAlphabeticalScript","isAscii","isAsciiAlpha","isAsciiDigit","isAsciiSpace","isHan","isKatakana","isHiragana","isHalfwidthKatakana","isThai","NormalizeWithNFKC","isValidRotation","parseQueryString","HASH_CHANGE_TIMEOUT","POSITION_UPDATED_THRESHOLD","UPDATE_VIEWAREA_TIMEOUT","getCurrentHash","location","hash","PDFHistory","_initialized","_fingerprint","_boundEvents","_isPagesLoaded","initialize","fingerprint","resetHistory","updateUrl","reInitialized","_updateUrl","_bindEvents","history","_popStateInProgress","_blockHashChange","_currentHash","_numPositionUpdates","_uid","_maxUid","_destination","_position","_isValidState","rotation","_parseCurrentHash","_pushOrReplaceState","destination","_updateInternalState","uid","_initialRotation","_initialBookmark","_pageHide","_unbindEvents","_updateViewareaTimeout","namedDest","explicitDest","_isValidPage","forceReplace","isDestHashesEqual","isDestArraysEqual","pushPage","pushCurrentPosition","_tryPushCurrentPosition","back","forward","popStateInProgress","initialBookmark","initialRotation","shouldReplace","newUrl","replaceState","pushState","temporary","checkReload","perfEntry","performance","getEntriesByType","removeTemporary","checkNameddest","substring","nameddest","_updateViewarea","pdfOpenParams","_popState","newHash","hashChanged","goToDestination","setHash","updateViewarea","popState","pageHide","destHash","pushHash","firstDest","secondDest","isEntryEqual","isNaN","DEFAULT_LINK_REL","LinkTarget","SELF","BLANK","PARENT","TOP","addLinkAttributes","link","rel","enabled","title","onclick","targetStr","PDFLinkService","pagesRefCache","externalLinkEnabled","_ignoreDestinationZoom","pdfViewer","pdfHistory","setViewer","setHistory","currentPageNumber","pagesRotation","goToDestinationHelper","rawDest","destRef","_cachedPageNumber","getPageIndex","cachePageRef","scrollPageIntoView","destArray","getDestination","goToPage","pageLabelToPageNumber","pageFlip","ensureAdjecentPagesAreLoaded","evenPage","evenTargetPage","newWindow","getDestinationHash","getAnchorUrl","anchor","phrase","zoomArgs","zoomArg","zoomArgNumber","allowNegativeOffset","isValidExplicitDestination","executeNamedAction","action","executeSetOCGState","optionalContentConfig","optionalContentConfigPromise","operator","setVisibility","group","getGroup","visible","pageRef","refStr","gen","num","destLength","zoom","allowNull","param","SimpleLinkService","PixelsPerInch","RenderingCancelledException","setLayerDimensions","approximateFraction","DEFAULT_SCALE","OutputScale","RenderingStates","roundToDivide","TextLayerMode","StructTreeLayerBuilder","TextAccessibilityManager","TextHighlighter","TextLayerBuilder","XfaLayerBuilder","MAX_CANVAS_PIXELS","DEFAULT_LAYER_PROPERTIES","annotationEditorUIManager","findController","PDFPageView","hasRestrictedScaling","layerProperties","loadingId","previousRotation","renderError","renderingState","INITIAL","useThumbnailCanvas","directDrawing","initialOptionalContent","regularAnnotations","viewportMap","container","defaultViewport","renderingId","pageLabel","scale","pdfPageRotate","_optionalContentConfigPromise","pageColors","renderingQueue","renderTask","_isStandalone","hasViewer","_container","textLayer","zoomLayer","xfaLayer","structTreeLayer","setDimensions","setProperty","PDF_TO_CSS_UNITS","hasInitialVisibility","PAUSED","RUNNING","FINISHED","setPdfPage","foreground","background","filterFactory","addHighlightHCMFilter","totalRotation","getViewport","cleanup","_textHighlighter","renderAnnotationLayer","renderAnnotationEditorLayer","renderXfaLayer","textDivs","buildXfaTextContentItems","renderTextLayer","renderingDone","readableStream","streamTextContent","includeMarkedContent","setTextContentSource","numTextDivs","renderStructTreeLayer","tree","getStructTree","treeDom","setTextMapping","enable","_resetZoomLayer","removeFromDOM","zoomLayerCanvas","keepZoomLayer","keepAnnotationLayer","keepAnnotationEditorLayer","keepXfaLayer","keepTextLayer","cancelRendering","zoomLayerNode","annotationLayerNode","annotationEditorLayerNode","xfaLayerNode","textLayerNode","node","drawingDelay","onlyCssZoom","outputScale","postponeDrawing","cancelExtraDelay","cssTransform","redrawAnnotationLayer","redrawAnnotationEditorLayer","redrawXfaLayer","redrawTextLayer","hideTextLayer","timestamp","parentNode","disable","originalViewport","relativeRotation","absRotation","scaleX","scaleY","getPagePoint","convertToPdfPoint","finishRenderTask","separateAnnots","canvasWrapper","isPureXfa","highlighter","ENABLE_PERMISSIONS","onAppend","textLayerDiv","renderContinueCallback","cont","showCanvas","isHighestPriority","hasHCM","isLastShow","alpha","invScale","pixelsInViewport","maxScale","sfx","sfy","divisor","determineMaxDimensions","newScale","scaled","renderContext","canvasContext","onContinue","resultPromise","setPageLabel","checklist","thumbnailCanvas","CLEANUP_TIMEOUT","PDFRenderingQueue","pdfThumbnailViewer","onIdle","highestPriorityPage","idleTimeout","printing","isThumbnailViewEnabled","setThumbnailViewer","view","renderHighestPriority","currentlyVisiblePages","forceRendering","getHighestPriority","views","scrolledDown","preRenderExtra","visibleViews","numVisible","isViewFinished","firstId","lastId","visibleIds","holeId","holeView","preRenderIndex","preRenderView","renderView","finally","PDFScriptingManager","PDFScriptingManagerComponents","externalServices","detail","createScripting","apiPageLayoutToViewerModes","closeCapability","destroyCapability","ready","scripting","willPrintCapability","destroyScripting","objects","calculationOrder","docActions","getFieldObjects","getCalculationOrderIds","getJSActions","initScripting","_internalEvents","updateFromSandbox","dispatchPageClose","dispatchPageOpen","_pageOpenPending","appInfo","docInfo","actions","dispatchWillSave","dispatchDidSave","dispatchWillPrint","dispatchDidPrint","destroyPromise","_visitedPages","isChangingPresentationMode","siblings","command","modes","spreadMode","pagesPromise","currentScaleValue","increaseScale","decreaseScale","focus","elementId","CustomEvent","setValue","visitedPages","pageView","getPageView","actionsPromise","race","ScrollMode","SpreadMode","PDFViewer","PDFSinglePageViewer","_resetView","_scrollMode","PAGE","_spreadMode","scrollMode","_updateScrollMode","_updateSpreadMode","ProgressBar","pdfjsVersion","pdfjsBuild","AnnotationEditorUIManager","version","DEFAULT_SCALE_DELTA","DEFAULT_SCALE_VALUE","docStyle","getVisibleElements","isPortraitOrientation","isValidScrollMode","isValidSpreadMode","MAX_AUTO_SCALE","MAX_SCALE","MIN_SCALE","removeNullCharacters","SCROLLBAR_PADDING","UNKNOWN_SCALE","VERTICAL_PADDING","watchScroll","DEFAULT_CACHE_SIZE","PagesCountLimit","FORCE_SCROLL_MODE_PAGE","FORCE_LAZY_PAGE_INIT","PAUSE_EAGER_PAGE_INIT","isValidAnnotationEditorMode","PDFPageViewBuffer","destroyFirstView","resize","newSize","idsToKeep","firstView","altTextManager","containerTopLeft","copyCallbackBound","getAllTextInProgress","hiddenCopyElement","interruptCopyCondition","previousContainerHeight","resizeObserver","ResizeObserver","resizeObserverCallback","scrollModePageState","onVisibilityChange","scaleTimeoutId","viewerVersion","viewer","firstElementChild","offsetParent","_getVisiblePages","_scriptingManager","scriptingManager","defaultRenderingQueue","scroll","_scrollUpdate","presentationModeState","UNKNOWN","_onBeforeDraw","_onAfterDraw","updateContainerHeightCss","_pages","getCachedPageViews","pageViewsReady","_pagesCapability","every","_currentPageNumber","_setCurrentPageNumber","hidePagesDependingOnpageViewMode","page1","htmlParentElement","clientWidth","overflow","marginLeft","marginRight","clientHeight","resetCurrentPageView","pv","ensurePdfPageLoaded","_pageLabels","addPageToRenderQueue","isLoading","advances","advance","loader","adjacentPagesLoader","isAlreadyRendering","pausedRendering","find","needsToBeRendered","currentPageLabel","currentScale","_currentScale","setScale","noScroll","_currentScaleValue","_pagesRotation","refresh","firstPagePromise","onePageRendered","_onePageRenderedCapability","_layerProperties","initializePermissions","permissions","onePageRenderedOrForceFetch","visibilityState","visibilityChangePromise","getAllText","texts","copyCallback","selection","getSelection","focusNode","anchorNode","containsNode","stopPropagation","savedCursor","interruptCopy","ev","clipboard","writeText","_cancelRendering","getOptionalContentConfig","permissionsPromise","getPermissions","firstPdfPage","before","updateMode","viewerElement","useOnlyCssZoom","firstPageView","ensurePageViewVisible","loadingParams","getPagesLeft","Language","setPageLabels","labels","bufferSize","PDFViewerApplicationOptions","_location","VERTICAL","_previousScrollMode","previousPageNumber","scrollDown","pageIndexSet","parity","dummyPage","scrollPagePosIntoView","pageSpot","targetPageSpot","percent","viewerHeight","visibleWindowHeight","viewerWidth","offsetLeft","clientLeft","right","scrollLeft","HORIZONTAL","isSameScale","setScaleUpdatePages","newValue","preset","previousScale","previousScaleValue","presetValue","previousPresetValue","pageWidthScaleFactor","currentPage","hPadding","vPadding","pageWidthScale","pageHeightScale","horizontalScale","widthScale","heightScale","changeOrientation","boundingRect","convertToViewportPoint","_updateLocation","firstPage","normalizedScaleValue","currentPageView","scrollTop","intLeft","intTop","visiblePages","numVisiblePages","newCacheSize","isSimpleLayout","currentId","stillFullyVisible","containsElement","_isContainerRtl","CHANGING","isHorizontalScrollbarEnabled","scrollWidth","isVerticalScrollbarEnabled","scrollHeight","horizontal","rtl","scrollEl","sortByVisibility","getScrollAhead","down","scrollAhead","hasEqualPageSizes","getPagesOverview","initialOrientation","toggle","_getPageAdvance","pageLayout","widthPercent","yArray","currentIndex","expectedId","scaleFactor","steps","toFixed","minScale","borderBoxSize","blockSize","offsetTop","editId","isFromKeyboard","annotationEditorParams","updateParams","noUpdate","updateArgs","getSerializedAnnotations","rawAnnotations","serialize","addEditorAnnotation","addSerializedEditor","removeEditorAnnotations","removeEditors","destroyBookMode","stopRendering","pdfjsLib","pdfjsLibPromise","build","DOMSVGFactory","DrawLayer","getDocument","getFilenameFromUrl","getXfaPageViewport","GlobalWorkerOptions","isDataScheme","noContextMenu","Outliner","PDFDataRangeTransport","PDFDateString","PDFWorker","updateTextLayer","XfaLayer","PDF_ROLE_TO_HTML_ROLE","Document","DocumentFragment","Part","Sect","Div","Aside","NonStruct","P","H","Title","FENote","Sub","Lbl","Span","Em","Strong","Link","Annot","Form","Ruby","RB","RT","RP","Warichu","WT","L","LI","LBody","Table","TR","TH","TD","THead","TBody","TFoot","Caption","Figure","Formula","Artifact","HEADING_PATTERN","structTree","walk","structElement","htmlElement","alt","role","children","kid","textChildren","textNodes","waitingElements","compareElementPositions","e1","e2","top1","bot1","mid1","top2","bot2","mid2","centerX1","centerX2","nodeIndex","getElementById","addIdToAriaOwns","isRemovable","addPointerInTextLayer","removePointerInTextLayer","owns","child","parent","moveElementInDOM","contentElement","hasChildNodes","elementToCompare","after","_onUpdateTextLayerMatches","textContentItemsStr","divs","_updateMatches","_convertMatches","iIndex","mm","begin","divIdx","_renderMatches","isSelectedPage","selectedMatchIdx","prevEnd","infinity","appendTextToDiv","fromOffset","toOffset","Node","span","i0","i1","lastDivIdx","lastOffset","isSelected","highlightSuffix","n0","n1","clearedUntilDivIdx","textContentSource","textDivProperties","textLayerRenderTask","finishRendering","endOfContent","bindMouse","devicePixelRatio","mustRotate","mustRescale","adjustTop","divBounds","pageY","clipboardData","setData","SidebarView","THUMBS","OUTLINE","ATTACHMENTS","LAYERS","ODD","EVEN","CursorTool","SELECT","HAND","ZOOM","AutoPrintRegExp","pixelRatio","scrollMatches","infiniteScroll","offsetY","clientTop","offsetX","scrollTo","scrollX","isDivInViewport","bottom","innerHeight","innerWidth","viewAreaElement","debounceScroll","rAF","viewAreaElementScrolled","currentX","lastX","currentY","lastY","_eventHandler","URLSearchParams","InvisibleCharactersRegExp","replaceInvisible","condition","minIndex","maxIndex","currentItem","xinv","x_","getPageSizeInches","userUnit","backtrackBeforeAllVisibleElements","elt","pageTop","isElementBottomAfterViewTop","elementBottom","isElementNextAfterViewHorizontally","elementLeft","elementRight","numViews","firstVisibleElementInd","lastEdge","currentWidth","currentHeight","viewWidth","viewHeight","viewRight","viewBottom","hiddenHeight","hiddenWidth","fractionHeight","fractionWidth","at","pc","normalizeWheelEventDirection","delta","hypot","deltaX","deltaY","atan2","normalizeWheelEventDelta","deltaMode","MOUSE_PIXELS_PER_LINE","MOUSE_LINES_PER_PAGE","WheelEvent","DOM_DELTA_PIXEL","DOM_DELTA_LINE","animationStarted","clamp","disableAutoFetchTimeout","bar","setWidth","scrollbarWidth","setDisableAutoFetch","getActiveOrFocusedElement","curRoot","curActiveOrFocused","activeElement","shadowRoot","layout","apiPageModeToSidebarView","toggleCheckedBtn","button","toggleExpandedBtn","xfaHtml","getXfa"],"sourceRoot":""}